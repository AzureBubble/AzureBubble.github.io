<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>FomalhautğŸ¥</title>
  
  
  <link href="https://azzurebubble.github.io/atom.xml" rel="self"/>
  
  <link href="https://azzurebubble.github.io/"/>
  <updated>2024-09-15T07:19:57.606Z</updated>
  <id>https://azzurebubble.github.io/</id>
  
  <author>
    <name>Rock</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”IClippable</title>
    <link href="https://azzurebubble.github.io/posts/27cfff35.html"/>
    <id>https://azzurebubble.github.io/posts/27cfff35.html</id>
    <published>2024-09-15T07:10:45.000Z</published>
    <updated>2024-09-15T07:19:57.606Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>IClippableï¼šMaskableGraphicç»§æ‰¿æ­¤æ¥å£</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>IClipper</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å¯ä»¥ç”¨æ¥æ¥æ”¶è£å‰ªå›è°ƒä½œä¸ºç”»å¸ƒæ›´æ–°å¾ªç¯çš„ä¸€éƒ¨åˆ†</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IClipper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆ é™¤/å‰ªè¾‘å­å…ƒç´ çš„å‡½æ•°</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åœ¨Canvasæ›´æ–°å¾ªç¯çš„å¸ƒå±€ä¹‹åå’Œå›¾å½¢æ›´æ–°ä¹‹å‰è°ƒç”¨ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">PerformClipping</span>()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>IClippableæ¥å£</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span>   Interface for elements that can be clipped if they are under an IClipper</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IClippable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å®ç°æ­¤æ¥å£çš„æ¸¸æˆç‰©ä½“</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    GameObject gameObject &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> é‡æ–°è®¡ç®—å¾…è£å‰ªå¯¹è±¡ï¼ˆMaskUtilitiesçš„Notify2DMaskStateChangedè°ƒç”¨ï¼‰</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">RecalculateClipping</span>()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å®ç°æ­¤æ¥å£çš„æ¸¸æˆç‰©ä½“çš„ RectTransform</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    RectTransform rectTransform &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è£å‰ªå’Œå‰”é™¤ç»™å®šçš„çŸ©å½¢ï¼ˆRectMask2Dçš„PerformClippingè°ƒç”¨ï¼‰</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;clipRect&quot;&gt;</span>è¦å‰ªåˆ‡çš„çŸ©å½¢<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;validRect&quot;&gt;</span>Rectæ˜¯å¦æœ‰æ•ˆ?å¦‚æœä¸æ˜¯ï¼Œåˆ™çŸ©å½¢çš„å¤§å°ä¸º0<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Cull</span>(<span class="params">Rect clipRect, <span class="built_in">bool</span> validRect</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è®¾ç½®è£å‰ªçŸ©å½¢ï¼ˆRectMask2Dçš„PerformClippingè°ƒç”¨ï¼‰</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>ç”¨äºå‰ªåˆ‡çš„çŸ©å½¢<span class="doctag">&lt;&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;validRect&quot;&gt;</span>rectæ˜¯å¦æœ‰æ•ˆ<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">SetClipRect</span>(<span class="params">Rect <span class="keyword">value</span>, <span class="built_in">bool</span> validRect</span>)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è®¾ç½®æ¸å˜åº¦ï¼ˆRectMask2Dçš„PerformClippingè°ƒç”¨ï¼‰</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">SetClipSoftness</span>(<span class="params">Vector2 clipSoftness</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è£å‰ªæ¥å£(è¢«è£å‰ªè€…)</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”IMaskable</title>
    <link href="https://azzurebubble.github.io/posts/e480027.html"/>
    <id>https://azzurebubble.github.io/posts/e480027.html</id>
    <published>2024-09-15T07:10:34.000Z</published>
    <updated>2024-09-15T07:19:57.611Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>IMaskableï¼šå¯ä»¥åœ¨å­ç±»ä¸­å®ç°RecalculateMaskingæ–¹æ³•å»é‡æ–°è®¡ç®—é®ç½©</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>IMaskableæ¥å£</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span>   è¿™ä¸ªå…ƒç´ å¯ä»¥è¢«é®ç½©</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IMaskable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> é‡æ–°è®¡ç®—æ‰€æœ‰å­å…ƒç´ çš„é®ç½©.</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä½¿ç”¨è¿™ä¸ªæ¥æ›´æ–°å†…éƒ¨çŠ¶æ€(é‡æ–°åˆ›å»ºæè´¨ç­‰)</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">RecalculateMasking</span>()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é®ç½©æ¥å£(è¢«é®ç½©è€…)</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”MaskableGraphic</title>
    <link href="https://azzurebubble.github.io/posts/6507ee44.html"/>
    <id>https://azzurebubble.github.io/posts/6507ee44.html</id>
    <published>2024-09-15T07:07:49.000Z</published>
    <updated>2024-09-15T07:22:47.417Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>MaskableGraphicï¼šæ˜¯å¯è¢«é®ç½©çš„å›¾åƒï¼Œä¸¥è°¨çš„è¯´åº”è¯¥æ˜¯å¯è¢«é®ç½©å’Œå¯è¢«è£å‰ªçš„å›¾åƒï¼Œå¯å®ƒç»§æ‰¿è‡ªGraphicç±»å’ŒIClippableã€IMaskableã€IMaterialModifieræ¥å£ï¼Œåœ¨Graphicçš„åŸºç¡€ä¸Šå®ç°äº†è£å‰ªå’Œé®ç½©åŠŸèƒ½ï¼ŒImageã€RawImageã€Textéƒ½ç»§æ‰¿è‡ªMaskableGraphicç±»</p></blockquote><p><a href="https://azurebubble.github.io/posts/ee37f782.html"><strong>UGUIæºç è§£æâ€”â€”Graphic</strong></a></p><p><a href="https://azurebubble.github.io/posts/6390c557.html"><strong>UGUIæºç è§£æâ€”â€”IMaterialModifier</strong></a></p><p><a href="https://azurebubble.github.io/posts/e480027.html"><strong>UGUIæºç è§£æâ€”â€”IMaskable</strong></a></p><p><a href="https://azurebubble.github.io/posts/27cfff35.html"><strong>UGUIæºç è§£æâ€”â€”IClippable</strong></a></p><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><p>&gt;</p>]]></content>
    
    
    <summary type="html">ç»§æ‰¿è‡ª Graphicï¼Œå®ç°äº†è£å‰ªå’Œé®ç½©åŠŸèƒ½ã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”IMaterialModifier</title>
    <link href="https://azzurebubble.github.io/posts/6390c557.html"/>
    <id>https://azzurebubble.github.io/posts/6390c557.html</id>
    <published>2024-08-18T14:27:03.000Z</published>
    <updated>2024-08-18T14:30:13.166Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>IMaterialModifierï¼šæ˜¯æè´¨å¤„ç†çš„æ¥å£ï¼Œå¯ä»¥åœ¨å­ç±»ä¸­å®ç°GetModifiedMaterialæ–¹æ³•å»ä¿®æ”¹æ¸²æŸ“çš„æè´¨ã€‚<br>Maskå®ç°äº†æ­¤æ¥å£</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>GetModifiedMaterialï¼š</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Material <span class="title">GetModifiedMaterial</span>(<span class="params">Material baseMaterial</span>)</span>;</span><br></pre></td></tr></table></figure><blockquote><p>Canvasæ¯å¸§æ›´æ–°æ—¶ä¼šå°†materialForRenderingèµ‹ç»™canvasRendererè¿›è¡Œæ¸²æŸ“</p></blockquote>]]></content>
    
    
    <summary type="html">æè´¨å¤„ç†çš„æ¥å£ï¼Œå¯ä»¥åœ¨å­ç±»ä¸­å®ç°GetModifiedMaterialæ–¹æ³•å»ä¿®æ”¹æ¸²æŸ“çš„æè´¨ã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”VertexHelper</title>
    <link href="https://azzurebubble.github.io/posts/93fc2cc0.html"/>
    <id>https://azzurebubble.github.io/posts/93fc2cc0.html</id>
    <published>2024-08-18T14:18:07.000Z</published>
    <updated>2024-09-15T07:06:04.988Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>VertexHelperï¼šæ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿåˆ›å»ºç½‘æ ¼<br>æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªUIæƒ³è¦æ˜¾ç¤ºå‡ºæ¥å°±éœ€è¦å¯¹åº”çš„Meshç½‘æ ¼ä¿¡æ¯ï¼Œè€Œç”ŸæˆMeshçš„ç½‘æ ¼ä¿¡æ¯å°±ä¿å­˜åœ¨äº†VertexHelperä¸­ï¼Œå®é™…ä¸Šæˆ‘ä»¬å¯ä»¥ç›´æ¥æ“ä½œMeshç±»æ·»åŠ é¡¶ç‚¹ç­‰æ•°æ®ï¼Œå¯ä»¥ç†è§£ä¸ºVertexHelperæ˜¯UGUIä¸Meshä¹‹é—´çš„ä¸€åº§æ¡¥æ¢ã€‚</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>å­—æ®µ</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> List&lt;Vector3&gt; m_Positions; <span class="comment">// é¡¶ç‚¹ä½ç½®</span></span><br><span class="line"><span class="keyword">private</span> List&lt;Color32&gt; m_Colors; <span class="comment">// é¡¶ç‚¹é¢œè‰²</span></span><br><span class="line"><span class="keyword">private</span> List&lt;Vector2&gt; m_Uv0S; <span class="comment">// ç¬¬ä¸€ä¸ªé¡¶ç‚¹çš„UVåæ ‡</span></span><br><span class="line"><span class="keyword">private</span> List&lt;Vector2&gt; m_Uv1S; <span class="comment">// ç¬¬äºŒä¸ªé¡¶ç‚¹çš„UVåæ ‡</span></span><br><span class="line"><span class="keyword">private</span> List&lt;Vector2&gt; m_Uv2S; <span class="comment">// ç¬¬ä¸‰ä¸ªé¡¶ç‚¹çš„UVåæ ‡</span></span><br><span class="line"><span class="keyword">private</span> List&lt;Vector2&gt; m_Uv3S; <span class="comment">// ç¬¬å››ä¸ªé¡¶ç‚¹çš„UVåæ ‡</span></span><br><span class="line"><span class="keyword">private</span> List&lt;Vector3&gt; m_Normals; <span class="comment">// æ³•çº¿å‘é‡</span></span><br><span class="line"><span class="keyword">private</span> List&lt;Vector4&gt; m_Tangents; <span class="comment">// åˆ‡çº¿å‘é‡</span></span><br><span class="line"><span class="keyword">private</span> List&lt;<span class="built_in">int</span>&gt; m_Indices; <span class="comment">// ä¸‰è§’é¢é¡¶ç‚¹ç´¢å¼•</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å±æ€§</span></span><br><span class="line"><span class="comment">// å½“å‰é¡¶ç‚¹æ•°</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">int</span> currentVertCount</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_Positions != <span class="literal">null</span> ? m_Positions.Count : <span class="number">0</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å½“å‰é¡¶ç‚¹ç´¢å¼•ï¼ˆä¸ºäº†ç»˜åˆ¶ä¸‰è§’å½¢ï¼ŒåŒä¸€ä¸ªé¡¶ç‚¹å¯èƒ½ä¼šä½¿ç”¨å¤šæ¬¡ï¼Œè¿™é‡Œä¼šç»Ÿè®¡ä½¿ç”¨å¤šæ¬¡çš„æƒ…å†µï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">int</span> currentIndexCount</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_Indices != <span class="literal">null</span> ? m_Indices.Count : <span class="number">0</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é™æ€é»˜è®¤åˆ‡çº¿å‘é‡ X\Y\Z\W</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Vector4 s_DefaultTangent = <span class="keyword">new</span> Vector4(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line"><span class="comment">// é™æ€é»˜è®¤æ³•çº¿å‘é‡ å‘å</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Vector3 s_DefaultNormal = Vector3.back;</span><br><span class="line"><span class="comment">// è®°å½•é¡¶ç‚¹æ•°æ®åˆ—è¡¨æ˜¯å¦å·²åˆå§‹åŒ–</span></span><br><span class="line"><span class="keyword">private</span> <span class="built_in">bool</span> m_ListsInitalized = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure><blockquote><p>æ„é€ å‡½æ•°ï¼šå°† Mesh å¯¹è±¡ m ä¸­çš„å„ä¸ªé¡¶ç‚¹å±æ€§(å¦‚ä½ç½®ã€é¢œè‰²ã€UVåæ ‡ã€æ³•çº¿ã€åˆ‡çº¿å’Œç´¢å¼•)æå–åˆ° VertexHelper å®ä¾‹çš„ç›¸åº”åˆ—è¡¨ä¸­ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">VertexHelper</span>(<span class="params">Mesh m</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æ•°æ®åˆ—è¡¨</span></span><br><span class="line">    InitializeListIfRequired();</span><br><span class="line"><span class="comment">// å°† Mesh å¯¹è±¡ m ä¸­çš„å„ä¸ªé¡¶ç‚¹å±æ€§(å¦‚ä½ç½®ã€é¢œè‰²ã€UVåæ ‡ã€æ³•çº¿ã€åˆ‡çº¿å’Œç´¢å¼•)æå–åˆ° VertexHelper å®ä¾‹çš„ç›¸åº”åˆ—è¡¨ä¸­ã€‚</span></span><br><span class="line">    m_Positions.AddRange(m.vertices);</span><br><span class="line">    m_Colors.AddRange(m.colors32);</span><br><span class="line">    m_Uv0S.AddRange(m.uv);</span><br><span class="line">    m_Uv1S.AddRange(m.uv2);</span><br><span class="line">    m_Uv2S.AddRange(m.uv3);</span><br><span class="line">    m_Uv3S.AddRange(m.uv4);</span><br><span class="line">    m_Normals.AddRange(m.normals);</span><br><span class="line">    m_Tangents.AddRange(m.tangents);</span><br><span class="line">    m_Indices.AddRange(m.GetIndices(<span class="number">0</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>InitializeListIfRequiredï¼šé€šè¿‡å¯¹è±¡æ± åˆå§‹åŒ–æ‰€æœ‰çš„æ•°æ®åˆ—è¡¨</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">InitializeListIfRequired</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!m_ListsInitalized)</span><br><span class="line">    &#123;</span><br><span class="line">        m_Positions = ListPool&lt;Vector3&gt;.Get();</span><br><span class="line">        m_Colors = ListPool&lt;Color32&gt;.Get();</span><br><span class="line">        m_Uv0S = ListPool&lt;Vector2&gt;.Get();</span><br><span class="line">        m_Uv1S = ListPool&lt;Vector2&gt;.Get();</span><br><span class="line">        m_Uv2S = ListPool&lt;Vector2&gt;.Get();</span><br><span class="line">        m_Uv3S = ListPool&lt;Vector2&gt;.Get();</span><br><span class="line">        m_Normals = ListPool&lt;Vector3&gt;.Get();</span><br><span class="line">        m_Tangents = ListPool&lt;Vector4&gt;.Get();</span><br><span class="line">        m_Indices = ListPool&lt;<span class="built_in">int</span>&gt;.Get();</span><br><span class="line">        m_ListsInitalized = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Disposeï¼šé‡Šæ”¾å†…å­˜</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Dispose</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_ListsInitalized)</span><br><span class="line">    &#123;</span><br><span class="line">        ListPool&lt;Vector3&gt;.Release(m_Positions);</span><br><span class="line">        ListPool&lt;Color32&gt;.Release(m_Colors);</span><br><span class="line">        ListPool&lt;Vector2&gt;.Release(m_Uv0S);</span><br><span class="line">        ListPool&lt;Vector2&gt;.Release(m_Uv1S);</span><br><span class="line">        ListPool&lt;Vector2&gt;.Release(m_Uv2S);</span><br><span class="line">        ListPool&lt;Vector2&gt;.Release(m_Uv3S);</span><br><span class="line">        ListPool&lt;Vector3&gt;.Release(m_Normals);</span><br><span class="line">        ListPool&lt;Vector4&gt;.Release(m_Tangents);</span><br><span class="line">        ListPool&lt;<span class="built_in">int</span>&gt;.Release(m_Indices);</span><br><span class="line"></span><br><span class="line">        m_Positions = <span class="literal">null</span>;</span><br><span class="line">        m_Colors = <span class="literal">null</span>;</span><br><span class="line">        m_Uv0S = <span class="literal">null</span>;</span><br><span class="line">        m_Uv1S = <span class="literal">null</span>;</span><br><span class="line">        m_Uv2S = <span class="literal">null</span>;</span><br><span class="line">        m_Uv3S = <span class="literal">null</span>;</span><br><span class="line">        m_Normals = <span class="literal">null</span>;</span><br><span class="line">        m_Tangents = <span class="literal">null</span>;</span><br><span class="line">        m_Indices = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        m_ListsInitalized = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Clearï¼šå¦‚æœåˆå§‹åŒ–è¿‡ï¼Œåˆ™æ¸…ç©ºç¼“å­˜</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Clear</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_ListsInitalized)</span><br><span class="line">    &#123;</span><br><span class="line">        m_Positions.Clear();</span><br><span class="line">        m_Colors.Clear();</span><br><span class="line">        m_Uv0S.Clear();</span><br><span class="line">        m_Uv1S.Clear();</span><br><span class="line">        m_Uv2S.Clear();</span><br><span class="line">        m_Uv3S.Clear();</span><br><span class="line">        m_Normals.Clear();</span><br><span class="line">        m_Tangents.Clear();</span><br><span class="line">        m_Indices.Clear();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetUIVertexï¼šå°†æŸä¸ªé¡¶ç‚¹æ•°æ®èµ‹å€¼ç»™æŒ‡å®šç´¢å¼•çš„é¡¶ç‚¹æ•°æ®</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetUIVertex</span>(<span class="params">UIVertex vertex, <span class="built_in">int</span> i</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    InitializeListIfRequired();</span><br><span class="line"></span><br><span class="line">    m_Positions[i] = vertex.position;</span><br><span class="line">    m_Colors[i] = vertex.color;</span><br><span class="line">    m_Uv0S[i] = vertex.uv0;</span><br><span class="line">    m_Uv1S[i] = vertex.uv1;</span><br><span class="line">    m_Uv2S[i] = vertex.uv2;</span><br><span class="line">    m_Uv3S[i] = vertex.uv3;</span><br><span class="line">    m_Normals[i] = vertex.normal;</span><br><span class="line">    m_Tangents[i] = vertex.tangent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>FillMeshï¼šå°†å½“å‰VertexHelperä¸­çš„æ•°æ®å¡«å……åˆ°è¾“å…¥çš„Meshä¸Šï¼Œæ³¨æ„é¡¶ç‚¹æ•°ä¸èƒ½è¶…è¿‡65000</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">FillMesh</span>(<span class="params">Mesh mesh</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    InitializeListIfRequired();</span><br><span class="line"></span><br><span class="line">    mesh.Clear();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (m_Positions.Count &gt;= <span class="number">65000</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;Mesh can not have more than 65000 vertices&quot;</span>);</span><br><span class="line"></span><br><span class="line">    mesh.SetVertices(m_Positions);</span><br><span class="line">    mesh.SetColors(m_Colors);</span><br><span class="line">    mesh.SetUVs(<span class="number">0</span>, m_Uv0S);</span><br><span class="line">    mesh.SetUVs(<span class="number">1</span>, m_Uv1S);</span><br><span class="line">    mesh.SetUVs(<span class="number">2</span>, m_Uv2S);</span><br><span class="line">    mesh.SetUVs(<span class="number">3</span>, m_Uv3S);</span><br><span class="line">    mesh.SetNormals(m_Normals);</span><br><span class="line">    mesh.SetTangents(m_Tangents);</span><br><span class="line">    mesh.SetTriangles(m_Indices, <span class="number">0</span>);</span><br><span class="line">    mesh.RecalculateBounds();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>AddVertï¼šæ·»åŠ é¡¶ç‚¹</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddVert</span>(<span class="params">Vector3 position, Color32 color, Vector2 uv0, Vector2 uv1, Vector2 uv2, Vector2 uv3, Vector3 normal, Vector4 tangent</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    InitializeListIfRequired();</span><br><span class="line"></span><br><span class="line">    m_Positions.Add(position);</span><br><span class="line">    m_Colors.Add(color);</span><br><span class="line">    m_Uv0S.Add(uv0);</span><br><span class="line">    m_Uv1S.Add(uv1);</span><br><span class="line">    m_Uv2S.Add(uv2);</span><br><span class="line">    m_Uv3S.Add(uv3);</span><br><span class="line">    m_Normals.Add(normal);</span><br><span class="line">    m_Tangents.Add(tangent);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddVert</span>(<span class="params">Vector3 position, Color32 color, Vector2 uv0, Vector2 uv1, Vector3 normal, Vector4 tangent</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    AddVert(position, color, uv0, uv1, Vector2.zero, Vector2.zero, normal, tangent);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddVert</span>(<span class="params">Vector3 position, Color32 color, Vector2 uv0</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    AddVert(position, color, uv0, Vector2.zero, s_DefaultNormal, s_DefaultTangent);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddVert</span>(<span class="params">UIVertex v</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    AddVert(v.position, v.color, v.uv0, v.uv1, v.normal, v.tangent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>AddTriangleï¼šæ·»åŠ ä¸‰è§’å½¢ï¼ŒæŒ‰ç…§é¡¶ç‚¹ç´¢å¼•é¡ºåºè¿›è¡Œç»˜åˆ¶ï¼ˆCanvasRenderå’ŒMeshRenderä¸åŒåœ¨äºä¸‰è§’å½¢ç´¢å¼•é¡ºåºä¸è®ºæ­£åCanvasRenderéƒ½èƒ½å¤Ÿç»˜åˆ¶å‡ºæ¥ï¼‰</p><h3 id="1-CanvasRenderer"><a href="#1-CanvasRenderer" class="headerlink" title="1. CanvasRenderer:"></a><strong>1. CanvasRenderer:</strong></h3><ul><li><strong>CanvasRenderer</strong> æ˜¯ Unity UI ç³»ç»Ÿä¸­çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºç»˜åˆ¶ UI å…ƒç´ ï¼ˆå¦‚æŒ‰é’®ã€å›¾åƒç­‰ï¼‰ã€‚</li><li><strong>ç»˜åˆ¶æ–¹å¼</strong>: <code>CanvasRenderer</code> ä¸ä¾èµ–äºä¸‰è§’å½¢çš„ç´¢å¼•é¡ºåºï¼ˆå³æ­£å‘æˆ–åå‘ï¼‰ã€‚å®ƒå¯ä»¥æ­£ç¡®ç»˜åˆ¶ä¸‰è§’å½¢ï¼Œå³ä½¿å®ƒä»¬çš„é¡¶ç‚¹ç´¢å¼•é¡ºåºæ˜¯åå‘çš„ï¼ˆé€†æ—¶é’ˆæˆ–é¡ºæ—¶é’ˆï¼‰ã€‚</li><li><strong>åŸå› </strong>: åœ¨ Canvas ç³»ç»Ÿä¸­ï¼Œé¡¶ç‚¹çš„ç´¢å¼•é¡ºåºé€šå¸¸ä¸ä¼šå½±å“ç»˜åˆ¶ç»“æœï¼Œå› ä¸º CanvasRenderer ä¸»è¦å…³æ³¨çš„æ˜¯ UI ç»„ä»¶çš„æ¸²æŸ“ï¼Œè€Œä¸æ˜¯åº•å±‚çš„å‡ ä½•å›¾å½¢å¤„ç†ã€‚Canvas çš„æ¸²æŸ“é€»è¾‘å¤„ç†çš„æ˜¯å·²ç»è½¬æ¢æˆå±å¹•åæ ‡ç³»çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯æ·±åº¦æˆ–é¢æœå‘ã€‚</li></ul><h3 id="2-MeshRenderer"><a href="#2-MeshRenderer" class="headerlink" title="2. MeshRenderer:"></a><strong>2. MeshRenderer:</strong></h3><ul><li><strong>MeshRenderer</strong> æ˜¯ç”¨äºæ¸²æŸ“ 3D ç½‘æ ¼çš„ç»„ä»¶ã€‚</li><li><strong>ç»˜åˆ¶æ–¹å¼</strong>: <code>MeshRenderer</code> å¯¹ä¸‰è§’å½¢çš„ç´¢å¼•é¡ºåºæœ‰ä¸¥æ ¼çš„è¦æ±‚ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæœŸæœ›ä¸‰è§’å½¢çš„é¡¶ç‚¹æŒ‰é¡ºæ—¶é’ˆï¼ˆæˆ–é€†æ—¶é’ˆï¼‰é¡ºåºæ’åˆ—ï¼Œä»¥ç¡®å®šä¸‰è§’å½¢çš„æ­£é¢ï¼ˆå‰é¢ï¼‰ã€‚å¦‚æœä¸‰è§’å½¢çš„é¡¶ç‚¹ç´¢å¼•é¡ºåºä¸ç¬¦åˆé¢„æœŸï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸‰è§’å½¢çš„é¢æœå‘ä¸æ­£ç¡®ï¼Œæˆ–è€…ä¸‰è§’å½¢ä¸ä¼šè¢«æ¸²æŸ“ã€‚</li><li><strong>åŸå› </strong>: åœ¨ 3D å›¾å½¢æ¸²æŸ“ä¸­ï¼Œé¢æœå‘å†³å®šäº†å“ªäº›é¢æ˜¯å¯è§çš„ï¼Œå“ªäº›é¢æ˜¯éšè—çš„ï¼ˆèƒŒé¢å‰”é™¤ï¼‰ã€‚æ­£ç¡®çš„ç´¢å¼•é¡ºåºå¯¹äºæ­£ç¡®çš„æ·±åº¦æµ‹è¯•å’Œè§†è§‰æ¸²æŸ“æ˜¯è‡³å…³é‡è¦çš„ã€‚</li></ul></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddTriangle</span>(<span class="params"><span class="built_in">int</span> idx0, <span class="built_in">int</span> idx1, <span class="built_in">int</span> idx2</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    InitializeListIfRequired();</span><br><span class="line"><span class="comment">// ä¸‰è§’é¡¶ç‚¹çš„ç´¢å¼•</span></span><br><span class="line">    m_Indices.Add(idx0);</span><br><span class="line">    m_Indices.Add(idx1);</span><br><span class="line">    m_Indices.Add(idx2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>AddUIVertexQuadï¼šæ ¹æ®ä¼ å…¥çš„é¡¶ç‚¹æ•°æ®æ•°ç»„(verts)ï¼Œä»å½“å‰ç´¢å¼•å¤„æ·»åŠ ä¸€ä¸ªé•¿æ–¹å½¢ï¼Œé¡¶ç‚¹æ•°æ®æ•°ç»„(verts)ä¸­ä¸è®ºæœ‰å‡ ä¸ªæ•°æ®ä¹Ÿåªèƒ½æ·»åŠ å››ä¸ªé¡¶ç‚¹æ•°æ®</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddUIVertexQuad</span>(<span class="params">UIVertex[] verts</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> startIndex = currentVertCount;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        AddVert(verts[i].position, verts[i].color, verts[i].uv0, verts[i].uv1, verts[i].normal, verts[i].tangent);</span><br><span class="line"></span><br><span class="line">    AddTriangle(startIndex, startIndex + <span class="number">1</span>, startIndex + <span class="number">2</span>);</span><br><span class="line">    AddTriangle(startIndex + <span class="number">2</span>, startIndex + <span class="number">3</span>, startIndex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>AddUIVertexStreamï¼šå°†ä¼ å…¥çš„é¡¶ç‚¹æ•°æ®åˆ—è¡¨(verts)è¦†ç›–æ‰å½“å‰VertexHelperä¸­çš„é¡¶ç‚¹æ•°æ®ï¼Œä¸ä¼šè¦†ç›–m_Indices<br>å°†ä¼ å…¥çš„é¡¶ç‚¹ç´¢å¼•åˆ—è¡¨(indices)æ·»åŠ åˆ°å½“å‰VertexHelperçš„m_Indicesåˆ—è¡¨ä¸­</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddUIVertexStream</span>(<span class="params">List&lt;UIVertex&gt; verts, List&lt;<span class="built_in">int</span>&gt; indices</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    InitializeListIfRequired();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (verts != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        CanvasRenderer.AddUIVertexStream(verts, m_Positions, m_Colors, m_Uv0S, m_Uv1S, m_Uv2S, m_Uv3S, m_Normals, m_Tangents);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (indices != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        m_Indices.AddRange(indices);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>AddUIVertexTriangleStreamï¼šå°†ä¼ å…¥çš„é¡¶ç‚¹æ•°æ®åˆ—è¡¨(verts)è¦†ç›–æ·»åŠ åˆ°å½“å‰VertexHelperä¸­ï¼Œä¼šè¦†ç›–æ‰ä¹‹å‰VertexHelperä¸­çš„æ‰€æœ‰æ•°æ®åŒ…æ‹¬m_Indicesåˆ—è¡¨ï¼Œä¼ å…¥çš„é¡¶ç‚¹æ•°æ®åˆ—è¡¨(verts)æœ‰å‡ ä¸ªæ•°æ®ï¼Œæœ€ç»ˆVertexHelperä¸­çš„é¡¶ç‚¹åˆ—è¡¨å’Œé¡¶ç‚¹ç´¢å¼•åˆ—è¡¨å°±æœ‰å‡ ä¸ªæ•°æ®ï¼Œä¼ å…¥çš„é¡¶ç‚¹æ•°æ®åˆ—è¡¨(verts)çš„é•¿åº¦å¿…é¡»æ˜¯ä¸‰çš„å€æ•°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddUIVertexTriangleStream</span>(<span class="params">List&lt;UIVertex&gt; verts</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (verts == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    InitializeListIfRequired();</span><br><span class="line"></span><br><span class="line">    CanvasRenderer.SplitUIVertexStreams(verts, m_Positions, m_Colors, m_Uv0S, m_Uv1S, m_Uv2S, m_Uv3S, m_Normals, m_Tangents, m_Indices);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetUIVertexStreamï¼šè·å–å½“å‰VertexHelperä¸­çš„æ‰€æœ‰é¡¶ç‚¹æ•°æ®<br>å°†å½“å‰VertexHelperä¸­çš„æ‰€æœ‰é¡¶ç‚¹æ•°æ®å¡«å……åˆ°ä¼ å…¥çš„é¡¶ç‚¹æ•°æ®åˆ—è¡¨ä¸­(stream)ï¼Œä¼šæ ¹æ®m_Indicesé¡¶ç‚¹ç´¢å¼•åˆ—è¡¨çš„æ•°é‡åˆ›å»ºé¡¶ç‚¹æ•°æ®ï¼Œä¾‹å¦‚ä¸€ä¸ªé•¿æ–¹å½¢éœ€è¦4ä¸ªé¡¶ç‚¹ï¼Œ6ä¸ªé¡¶ç‚¹ç´¢å¼•ï¼Œä½¿ç”¨æ­¤æ–¹æ³•å¾—åˆ°çš„åˆ—è¡¨å…ƒç´ æ•°é‡æ˜¯6</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GetUIVertexStream</span>(<span class="params">List&lt;UIVertex&gt; stream</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (stream == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    InitializeListIfRequired();</span><br><span class="line"></span><br><span class="line">    CanvasRenderer.CreateUIVertexStream(stream, m_Positions, m_Colors, m_Uv0S, m_Uv1S, m_Uv2S, m_Uv3S, m_Normals, m_Tangents, m_Indices);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>PopulateUIVertexï¼šè¿”å›æŒ‡å®šç´¢å¼•çš„é¡¶ç‚¹æ•°æ®</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PopulateUIVertex</span>(<span class="params"><span class="keyword">ref</span> UIVertex vertex, <span class="built_in">int</span> i</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    InitializeListIfRequired();</span><br><span class="line"></span><br><span class="line">    vertex.position = m_Positions[i];</span><br><span class="line">    vertex.color = m_Colors[i];</span><br><span class="line">    vertex.uv0 = m_Uv0S[i];</span><br><span class="line">    vertex.uv1 = m_Uv1S[i];</span><br><span class="line">    vertex.uv2 = m_Uv2S[i];</span><br><span class="line">    vertex.uv3 = m_Uv3S[i];</span><br><span class="line">    vertex.normal = m_Normals[i];</span><br><span class="line">    vertex.tangent = m_Tangents[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ç½‘æ ¼æ•°æ®çš„å·¥å…·ç±»ã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”CoroutineTween</title>
    <link href="https://azzurebubble.github.io/posts/59942898.html"/>
    <id>https://azzurebubble.github.io/posts/59942898.html</id>
    <published>2024-08-18T14:17:14.000Z</published>
    <updated>2024-08-18T14:30:39.020Z</updated>
    
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”SetPropertyUtility</title>
    <link href="https://azzurebubble.github.io/posts/ef6aa33a.html"/>
    <id>https://azzurebubble.github.io/posts/ef6aa33a.html</id>
    <published>2024-08-18T09:00:04.000Z</published>
    <updated>2024-08-18T09:05:37.556Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>SetPropertyUtilityï¼šè®¾ç½®UIå…ƒç´ å±æ€§çš„é™æ€å·¥å…·ç±»ã€‚</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>SetColor:ä¿®æ”¹é¢œè‰²å€¼ï¼Œå¦‚æœæ–°ä¼ å…¥çš„é¢œè‰²çš„RGBAå’Œå°±é¢œè‰²ç›¸åŒåˆ™ä¸è¿›è¡Œä¿®æ”¹</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">SetColor</span>(<span class="params"><span class="keyword">ref</span> Color currentValue, Color newValue</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (currentValue.r == newValue.r &amp;&amp; currentValue.g == newValue.g &amp;&amp; currentValue.b == newValue.b &amp;&amp; currentValue.a == newValue.a)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    currentValue = newValue;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetStruct:æ¯”è¾ƒä¸¤ä¸ªç»“æ„ä½“çš„å€¼ï¼Œå¦‚æœä¸ºä¸ä¸€æ ·æ‰è¿›è¡Œæ›´æ–°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">SetStruct</span>&lt;<span class="title">T</span>&gt;(<span class="params"><span class="keyword">ref</span> T currentValue, T newValue</span>) <span class="keyword">where</span> T : <span class="keyword">struct</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (EqualityComparer&lt;T&gt;.Default.Equals(currentValue, newValue))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    currentValue = newValue;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetClass:æ¯”è¾ƒä¸¤ä¸ªç±»çš„å€¼ï¼Œå¦‚æœä¸ä¸€æ ·ä¸”éƒ½ä¸ä¸ºç©ºæ‰è¿›è¡Œæ›´æ–°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">SetClass</span>&lt;<span class="title">T</span>&gt;(<span class="params"><span class="keyword">ref</span> T currentValue, T newValue</span>) <span class="keyword">where</span> T : <span class="keyword">class</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ((currentValue == <span class="literal">null</span> &amp;&amp; newValue == <span class="literal">null</span>) || (currentValue != <span class="literal">null</span> &amp;&amp; currentValue.Equals(newValue)))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    currentValue = newValue;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è®¾ç½®UIå…ƒç´ å±æ€§çš„é™æ€å·¥å…·ç±»ã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”Graphic</title>
    <link href="https://azzurebubble.github.io/posts/ee37f782.html"/>
    <id>https://azzurebubble.github.io/posts/ee37f782.html</id>
    <published>2024-08-18T08:08:16.000Z</published>
    <updated>2024-08-18T14:22:54.047Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Graphicï¼šæ˜¯UGUIçš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£å›¾å¯¹è±¡çš„æ˜¾ç¤ºå’Œæ›´æ–°ï¼Œæ˜¯MaskableGraphicçš„åŸºç±»ï¼Œè€ŒMaskableGraphicæ˜¯Textã€RawImageã€Imageçš„åŸºç±»ã€‚Graphicæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ„å‘³ç€ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œä½†æ˜¯å®ƒæä¾›äº†å¾ˆå¤šå¯é‡å†™çš„æ–¹æ³•å¯è¢«ç»§æ‰¿å¹¶é‡å†™ã€‚</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>ç±»å¤´ï¼šç‰¹æ€§ï¼ŒGraphicæ˜¯ç»§æ‰¿è‡ªUIBehaviourå’ŒICanvasElementï¼ŒUIBehaviouræ˜¯æ‰€æœ‰UGUIç»„ä»¶çš„æœ€åŸºç±»ï¼Œè´Ÿè´£æ¥æ”¶UnityEditorçš„äº‹ä»¶ã€‚ICanvasElementè´Ÿè´£æ¥æ”¶Canvasé‡æ–°æ¸²æŸ“çš„äº‹ä»¶ã€‚</p></blockquote><p><a href="https://azurebubble.github.io/posts/45311df6.html"><strong>UGUIæºç è§£æâ€”â€”UIBehaviour</strong></a></p><p><a href="https://azurebubble.github.io/posts/6dcd3730.html"><strong>UGUIæºç è§£æâ€”â€”CanvasUpdateRegistry</strong></a></p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸å…è®¸ä¸€ä¸ªå¯¹è±¡æ·»åŠ å¤šä¸ªç›¸åŒçš„ç»„ä»¶</span></span><br><span class="line">[<span class="meta">DisallowMultipleComponent</span>]</span><br><span class="line"><span class="comment">// ä¾èµ–äºCanvasRendererç”»å¸ƒæ¸²æŸ“ç»„ä»¶</span></span><br><span class="line">[<span class="meta">RequireComponent(typeof(CanvasRenderer))</span>]</span><br><span class="line"><span class="comment">// ä¾èµ–äºRectTransformç»„ä»¶</span></span><br><span class="line">[<span class="meta">RequireComponent(typeof(RectTransform))</span>]</span><br><span class="line"><span class="comment">// ç¼–è¾‘å™¨æ¨¡å¼ä¸‹å¯ä»¥è¿è¡Œ</span></span><br><span class="line">[<span class="meta">ExecuteAlways</span>]</span><br></pre></td></tr></table></figure><blockquote><p>å­—æ®µ</p></blockquote><p><a href="https://azurebubble.github.io/posts/ef6aa33a.html"><strong>UGUIæºç è§£æâ€”â€”SetPropertyUtility</strong></a></p><blockquote><p>SetPropertyUtilityï¼šè®¾ç½®UIå…ƒç´ å±æ€§çš„é™æ€å·¥å…·ç±»ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é™æ€çš„æè´¨å’Œçº¹ç†å­—æ®µï¼Œç”¨äºå­˜å‚¨é»˜è®¤çš„UIå…ƒç´ æè´¨å’Œçº¹ç†ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šUIå…ƒç´ çš„æè´¨å’Œçº¹ç†ï¼Œå°†ä¼šç”¨è¿™ä¸¤ä¸ªå­—æ®µä½œä¸ºé»˜è®¤è¾“å…¥</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">protected</span> Material s_DefaultUI = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">public</span> Material defaultGraphicMaterial</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (s_DefaultUI == <span class="literal">null</span>)</span><br><span class="line">            s_DefaultUI = Canvas.GetDefaultCanvasMaterial();</span><br><span class="line">        <span class="keyword">return</span> s_DefaultUI;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> Material defaultMaterial</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span> &#123; <span class="keyword">return</span> defaultGraphicMaterial; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">protected</span> Texture2D s_WhiteTexture = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> Texture mainTexture</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> s_WhiteTexture;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‡ç¤ºè¿™ä¸ªå­—æ®µå†åºåˆ—åŒ–æ—¶æ›¾ç»ç”¨è¿‡ä¸åŒçš„åç§°(&quot;m_Mat&quot;)</span></span><br><span class="line">[<span class="meta">FormerlySerializedAs(<span class="string">&quot;m_Mat&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> Material m_Material;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> Material material</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰ï¼Œåˆ™ç›´æ¥è¿”å›é»˜è®¤æè´¨</span></span><br><span class="line">        <span class="keyword">return</span> (m_Material != <span class="literal">null</span>) ? m_Material : defaultMaterial;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">set</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (m_Material == <span class="keyword">value</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        m_Material = <span class="keyword">value</span>;</span><br><span class="line">        <span class="comment">// è„æ ‡è®°</span></span><br><span class="line">        SetMaterialDirty();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é»˜è®¤é¢œè‰²æ˜¯ç™½è‰²</span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">private</span> Color m_Color = Color.white;</span><br><span class="line"><span class="comment">// å¦‚æœé¢œè‰²å‘ç”Ÿäº†å˜åŒ–ï¼Œåˆ™æ ‡è®°é‡æ–°æ¸²æŸ“é¡¶ç‚¹æ•°æ®</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> Color color &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_Color; &#125; <span class="keyword">set</span> &#123; <span class="keyword">if</span> (SetPropertyUtility.SetColor(<span class="keyword">ref</span> m_Color, <span class="keyword">value</span>)) SetVerticesDirty(); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ‡è®°æ˜¯å¦è·³è¿‡å¸ƒå±€æ›´æ–°å’Œæè´¨æ›´æ–°</span></span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">protected</span> <span class="built_in">bool</span> m_SkipLayoutUpdate;</span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">protected</span> <span class="built_in">bool</span> m_SkipMaterialUpdate;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ‡è®°è¿™ä¸ªå›¾å½¢å¯¹è±¡æ˜¯å¦èƒ½æ¥æ”¶åˆ°é¼ æ ‡å°„çº¿çš„ä¿¡å·</span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">private</span> <span class="built_in">bool</span> m_RaycastTarget = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">bool</span> raycastTarget &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_RaycastTarget; &#125; <span class="keyword">set</span> &#123; m_RaycastTarget = <span class="keyword">value</span>; &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RectTransformæ˜¯å¿…å¤‡çš„ç»„ä»¶ï¼Œä¸èƒ½è¢«é”€æ¯ï¼Œåªéœ€è¦æ£€æµ‹å®ƒæ˜¯å¦ä¸ºç©ºå¼•ç”¨å³å¯</span></span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">private</span> RectTransform m_RectTransform;</span><br><span class="line"><span class="keyword">public</span> RectTransform rectTransform</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ReferenceEquals(m_RectTransform, <span class="literal">null</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            m_RectTransform = GetComponent&lt;RectTransform&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> m_RectTransform;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CanvasRendereræ˜¯å¿…å¤‡çš„ç»„ä»¶ï¼Œä¸èƒ½è¢«é”€æ¯ï¼Œåªéœ€è¦æ£€æµ‹å®ƒæ˜¯å¦ä¸ºç©ºå¼•ç”¨å³å¯</span></span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">private</span> CanvasRenderer m_CanvasRenderer;</span><br><span class="line"><span class="keyword">public</span> CanvasRenderer canvasRenderer</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ReferenceEquals(m_CanvasRenderer, <span class="literal">null</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            m_CanvasRenderer = GetComponent&lt;CanvasRenderer&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> m_CanvasRenderer;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å›¾å½¢æ¸²æŸ“åˆ°çš„ç”»å¸ƒå¼•ç”¨ï¼Œå–æœ€æ¥è¿‘çš„Canvas</span></span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">private</span> Canvas m_Canvas;</span><br><span class="line"><span class="keyword">public</span> Canvas canvas</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (m_Canvas == <span class="literal">null</span>)</span><br><span class="line">            CacheCanvas();</span><br><span class="line">        <span class="keyword">return</span> m_Canvas;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¡¶ç‚¹å’Œæè´¨è„æ ‡è®°</span></span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">private</span> <span class="built_in">bool</span> m_VertsDirty;</span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">private</span> <span class="built_in">bool</span> m_MaterialDirty;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¸ƒå±€è®¾ç½®ä¸ºè„æ—¶å€™çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">protected</span> UnityAction m_OnDirtyLayoutCallback;</span><br><span class="line"><span class="comment">// é¡¶ç‚¹è®¾ç½®ä¸ºè„æ—¶å€™çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">protected</span> UnityAction m_OnDirtyVertsCallback;</span><br><span class="line"><span class="comment">// æè´¨è®¾ç½®ä¸ºè„æ—¶å€™çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">protected</span> UnityAction m_OnDirtyMaterialCallback;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é™æ€ç½‘æ ¼å­—æ®µ</span></span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">protected</span> <span class="keyword">static</span> Mesh s_Mesh;</span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">static</span> Mesh workerMesh</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (s_Mesh == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            s_Mesh = <span class="keyword">new</span> Mesh();</span><br><span class="line">            s_Mesh.name = <span class="string">&quot;Shared UI Mesh&quot;</span>;</span><br><span class="line">            <span class="comment">// ä½¿å…¶åœ¨ Unity ç¼–è¾‘å™¨ä¸­ä¸å¯è§ï¼Œå¹¶ä¸”åœ¨ä¿å­˜åœºæ™¯æ—¶ä¸ä¼šè¢«åºåˆ—åŒ–ï¼Œç¡®ä¿å®ƒä¸ä¼šåœ¨åœºæ™¯ä¿å­˜æ—¶ä¿å­˜ï¼Œä¹Ÿä¸ä¼šåœ¨ Hierarchy é¢æ¿ä¸­æ˜¾ç¤º</span></span><br><span class="line">            s_Mesh.hideFlags = HideFlags.HideAndDontSave;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s_Mesh;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…±äº«å¸®åŠ©ç±»å®ä¾‹ï¼Œé¿å…é‡å¤åˆ›å»º</span></span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> VertexHelper s_VertexHelper = <span class="keyword">new</span> VertexHelper();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç½‘æ ¼ç¼“å­˜</span></span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">protected</span> Mesh m_CachedMesh;</span><br><span class="line"><span class="comment">// UVåæ ‡ç¼“å­˜</span></span><br><span class="line">[<span class="meta">NonSerialized</span>] <span class="keyword">protected</span> Vector2[] m_CachedUvs;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‡å®šé¢œè‰²å˜åŒ–çš„æ’å€¼å¯¹è±¡</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> TweenRunner&lt;ColorTween&gt; m_ColorTweenRunner;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¯å¦ä½¿ç”¨æ—§ç‰ˆçš„ç½‘æ ¼ç”Ÿæˆæ–¹å¼</span></span><br><span class="line"><span class="keyword">protected</span> <span class="built_in">bool</span> useLegacyMeshGeneration &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ƒè¡¨ç¤ºå›¾å½¢çš„ç»å¯¹æ·±åº¦ï¼Œå€¼ä»æœ€ä½åˆ°æœ€é«˜ï¼Œç”¨äºç¡®å®šå›¾å½¢çš„ç»˜åˆ¶é¡ºåºå’Œäº‹ä»¶å¤„ç†é¡ºåºã€‚</span></span><br><span class="line"><span class="comment">// å…·æœ‰è¾ƒé«˜æ·±åº¦çš„å›¾å½¢ä¼šåœ¨è¾ƒä½æ·±åº¦çš„å›¾å½¢ä¹‹ä¸Šç»˜åˆ¶ï¼Œå¹¶ä¸”æ¥æ”¶äº‹ä»¶çš„ä¼˜å…ˆçº§è¾ƒé«˜ã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">int</span> depth &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> canvasRenderer.absoluteDepth; &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­å®é™…å‘é€åˆ° CanvasRenderer çš„æè´¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> Material materialForRendering</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> components = ListPool&lt;Component&gt;.Get();</span><br><span class="line">        GetComponents(<span class="keyword">typeof</span>(IMaterialModifier), components);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> currentMat = material;</span><br><span class="line">        <span class="comment">// éå†æ‰€æœ‰ IMaterialModifier ç»„ä»¶ï¼Œé€ä¸ªåº”ç”¨æè´¨ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; components.Count; i++)</span><br><span class="line">            currentMat = (components[i] <span class="keyword">as</span> IMaterialModifier).GetModifiedMaterial(currentMat);</span><br><span class="line">        ListPool&lt;Component&gt;.Release(components);</span><br><span class="line">        <span class="keyword">return</span> currentMat;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ„é€ å‡½æ•°ï¼šåˆ›å»ºä¸€ä¸ªé¢œè‰²å˜åŒ–çš„æ’å€¼å¯¹è±¡ï¼Œå¹¶å°†å½“å‰å®ä¾‹ä¼ é€’ã€‚æŒ‡å®šå›¾å½¢ç»„ä»¶åœ¨åˆå§‹åŒ–æ—¶ä½¿ç”¨æ—§ç‰ˆç½‘æ ¼ç”Ÿæˆæ–¹å¼ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="title">Graphic</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_ColorTweenRunner == <span class="literal">null</span>)</span><br><span class="line">        m_ColorTweenRunner = <span class="keyword">new</span> TweenRunner&lt;ColorTween&gt;();</span><br><span class="line">    m_ColorTweenRunner.Init(<span class="keyword">this</span>);</span><br><span class="line">    useLegacyMeshGeneration = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetAllDirty:è®¾ç½®æ‰€æœ‰çš„å›¾å½¢å±æ€§éœ€è¦è¿›è¡Œé‡å»ºï¼Œå¦‚å¸ƒå±€ï¼Œé¡¶ç‚¹ï¼Œæè´¨ç­‰</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SetAllDirty</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­å¯¹è±¡çš„å¸ƒå±€æ˜¯å¦éœ€è¦é‡å»º</span></span><br><span class="line">    <span class="keyword">if</span> (m_SkipLayoutUpdate)</span><br><span class="line">    &#123;</span><br><span class="line">        m_SkipLayoutUpdate = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        SetLayoutDirty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ¤æ–­å¯¹è±¡çš„æè´¨æ˜¯å¦éœ€è¦æ›´æ–°</span></span><br><span class="line">    <span class="keyword">if</span> (m_SkipMaterialUpdate)</span><br><span class="line">    &#123;</span><br><span class="line">        m_SkipMaterialUpdate = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        SetMaterialDirty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ‡è®°é¡¶ç‚¹éœ€è¦æ›´æ–°</span></span><br><span class="line">    SetVerticesDirty();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetLayoutDirty:å°†å¸ƒå±€è®¾ç½®ä¸ºè„ï¼Œéœ€è¦è¿›è¡Œå¸ƒå±€é‡å»º</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SetLayoutDirty</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!IsActive())</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ‡è®°å½“å‰rectTransforméœ€è¦è¿›è¡Œå¸ƒå±€é‡å»º</span></span><br><span class="line">    LayoutRebuilder.MarkLayoutForRebuild(rectTransform);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¸ƒå±€è„æ ‡è®°åçš„å›è°ƒ</span></span><br><span class="line">    <span class="keyword">if</span> (m_OnDirtyLayoutCallback != <span class="literal">null</span>)</span><br><span class="line">        m_OnDirtyLayoutCallback();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetVerticesDirty:å°†é¡¶ç‚¹è®¾ç½®ä¸ºè„ï¼Œéœ€è¦è¿›è¡Œå¸ƒå±€é‡å»º</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SetVerticesDirty</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!IsActive())</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ‡è®°å½“å‰å›¾å½¢å…ƒç´ å°†åœ¨Canvasæ›´æ–°æ—¶è¢«é‡æ–°è®¡ç®—</span></span><br><span class="line">    m_VertsDirty = <span class="literal">true</span>;</span><br><span class="line">    CanvasUpdateRegistry.RegisterCanvasElementForGraphicRebuild(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é¡¶ç‚¹è„æ ‡è®°åçš„å›è°ƒ</span></span><br><span class="line">    <span class="keyword">if</span> (m_OnDirtyVertsCallback != <span class="literal">null</span>)</span><br><span class="line">        m_OnDirtyVertsCallback();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetMaterialDirty:å°†æè´¨è®¾ç½®ä¸ºè„ï¼Œéœ€è¦è¿›è¡Œå¸ƒå±€é‡å»º</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SetMaterialDirty</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!IsActive())</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    m_MaterialDirty = <span class="literal">true</span>;</span><br><span class="line">    CanvasUpdateRegistry.RegisterCanvasElementForGraphicRebuild(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æè´¨è„æ ‡è®°åçš„å›è°ƒ</span></span><br><span class="line">    <span class="keyword">if</span> (m_OnDirtyMaterialCallback != <span class="literal">null</span>)</span><br><span class="line">        m_OnDirtyMaterialCallback();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnRectTransformDimensionsChange:å½“RectTransformå°ºå¯¸å‘ç”Ÿå˜åŒ–çš„æ—¶å€™è°ƒç”¨</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnRectTransformDimensionsChange</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (gameObject.activeInHierarchy)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é˜²æ­¢åŒé‡æ±¡æŸ“â€¦</span></span><br><span class="line">        <span class="comment">// å¦‚æœæ­£åœ¨å¸ƒå±€é‡å»ºï¼Œåˆ™åªå¯¹é¡¶ç‚¹è¿›è¡Œè„æ ‡è®°</span></span><br><span class="line">        <span class="keyword">if</span> (CanvasUpdateRegistry.IsRebuildingLayout())</span><br><span class="line">            SetVerticesDirty();</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å¦åˆ™å¸ƒå±€ä¹Ÿéœ€è¦è®¾ç½®ä¸ºéœ€è¦é‡å»ºï¼Œç¡®ä¿UIå…ƒç´ çš„å¸ƒå±€å’Œæ¸²æŸ“æ˜¯æœ€æ–°çš„</span></span><br><span class="line">            SetVerticesDirty();</span><br><span class="line">            SetLayoutDirty();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnBeforeTransformParentChanged:çˆ¶å¯¹è±¡å˜æ›´å‰è°ƒç”¨</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnBeforeTransformParentChanged</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä»å›¾åƒé‡å»ºé˜Ÿåˆ—ä¸­æ³¨é”€å½“å‰å¯¹è±¡æ³¨å†Œ</span></span><br><span class="line">    GraphicRegistry.UnregisterGraphicForCanvas(canvas, <span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">// æ ‡è®°å½“å‰rectTransforméœ€è¦è¿›è¡Œå¸ƒå±€é‡å»ºï¼Œç¡®ä¿çˆ¶å¯¹è±¡å‘ç”Ÿå˜åŒ–åï¼Œå¸ƒå±€ç³»ç»Ÿèƒ½å¤Ÿé‡æ–°è®¡ç®—å¹¶æ›´æ–°å¯¹è±¡çš„å¸ƒå±€</span></span><br><span class="line">    LayoutRebuilder.MarkLayoutForRebuild(rectTransform);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnTransformParentChanged:çˆ¶å¯¹è±¡å‘ç”Ÿå˜åŒ–çš„æ—¶å€™è°ƒç”¨</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnTransformParentChanged</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">base</span>.OnTransformParentChanged();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å› ä¸ºçˆ¶å¯¹è±¡çš„å˜åŒ–æ„å‘³ç€å½“å‰çš„ç”»å¸ƒ (canvas) å¯èƒ½ä¸å†é€‚ç”¨ï¼Œå› æ­¤éœ€è¦æ¸…ç©ºç¼“å­˜çš„ç”»å¸ƒå¼•ç”¨ã€‚</span></span><br><span class="line">    m_Canvas = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!IsActive())</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡æ–°ç¼“å­˜å½“å‰å¯¹è±¡çš„ç”»å¸ƒ (canvas)ã€‚è¿™ä¸€æ­¥æ˜¯ä¸ºäº†åœ¨çˆ¶å¯¹è±¡å˜åŒ–åï¼Œé‡æ–°è·å–å¹¶ç¼“å­˜æ­£ç¡®çš„ç”»å¸ƒå¼•ç”¨ã€‚</span></span><br><span class="line">    CacheCanvas();</span><br><span class="line">    <span class="comment">// å°†å½“å‰å¯¹è±¡æ³¨å†Œåˆ° GraphicRegistry ä¸­</span></span><br><span class="line">    GraphicRegistry.RegisterGraphicForCanvas(canvas, <span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">// å¯¹å½“å‰å¯¹è±¡çš„æ‰€æœ‰å±æ€§è¿›è¡Œè„æ ‡è®°</span></span><br><span class="line">    SetAllDirty();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CacheCanvas:ç¼“å­˜å½“å‰å¯¹è±¡çš„ç¬¬ä¸€ä¸ªCanvasçˆ¶å¯¹è±¡</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">CacheCanvas</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å–å¯¹è±¡æ± </span></span><br><span class="line">    <span class="keyword">var</span> list = ListPool&lt;Canvas&gt;.Get();</span><br><span class="line">    <span class="comment">// æŸ¥æ‰¾çˆ¶å¯¹è±¡ä¸­çš„æ‰€æœ‰Canvasç»„ä»¶</span></span><br><span class="line">    gameObject.GetComponentsInParent(<span class="literal">false</span>, list);</span><br><span class="line">    <span class="keyword">if</span> (list.Count &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¿€æ´»çš„ç”»å¸ƒ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; list.Count; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (list[i].isActiveAndEnabled)</span><br><span class="line">            &#123;</span><br><span class="line">                m_Canvas = list[i];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        m_Canvas = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾å¯¹è±¡æ± </span></span><br><span class="line">    ListPool&lt;Canvas&gt;.Release(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnEnable:å°†å›¾å½¢å’Œç”»å¸ƒè®¾ç½®ä¸ºè„æ ‡è®°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">base</span>.OnEnable();</span><br><span class="line">            CacheCanvas();</span><br><span class="line">            <span class="comment">// å½“å‰å›¾å½¢ç»„ä»¶æ³¨å†Œåˆ°æŒ‡å®šçš„ Canvas å¯¹è±¡ä¸Šã€‚è¿™æ ·åšå¯ä»¥ç¡®ä¿åœ¨ç»˜åˆ¶æˆ–æ›´æ–°æ—¶ï¼Œå›¾å½¢ç»„ä»¶è¢«æ­£ç¡®åœ°ç®¡ç†å’Œå¤„ç†ã€‚</span></span><br><span class="line">            GraphicRegistry.RegisterGraphicForCanvas(canvas, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> UNITY_EDITOR</span></span><br><span class="line">    <span class="comment">// åœ¨ç¼–è¾‘å™¨æ¨¡å¼ä¸‹è·Ÿè¸ªå’Œç®¡ç†å›¾å½¢é‡å»º</span></span><br><span class="line">            GraphicRebuildTracker.TrackGraphic(<span class="keyword">this</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ç™½è‰²çº¹ç†</span></span><br><span class="line">            <span class="keyword">if</span> (s_WhiteTexture == <span class="literal">null</span>)</span><br><span class="line">                s_WhiteTexture = Texture2D.whiteTexture;</span><br><span class="line"></span><br><span class="line">            SetAllDirty();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnDisable:æ¸…ç©ºå¼•ç”¨</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnDisable</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> UNITY_EDITOR</span></span><br><span class="line">    <span class="comment">// å–æ¶ˆè·Ÿè¸ª</span></span><br><span class="line">            GraphicRebuildTracker.UnTrackGraphic(<span class="keyword">this</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="comment">// æ³¨é”€Canvaså’Œå½“å‰å¯¹è±¡çš„å›¾å½¢é‡å»º</span></span><br><span class="line">            GraphicRegistry.UnregisterGraphicForCanvas(canvas, <span class="keyword">this</span>);</span><br><span class="line">            <span class="comment">// æ³¨é”€ç”»å¸ƒå…ƒç´ é‡å»º</span></span><br><span class="line">            CanvasUpdateRegistry.UnRegisterCanvasElementForRebuild(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (canvasRenderer != <span class="literal">null</span>)</span><br><span class="line">                <span class="comment">// æ¸…ç©º</span></span><br><span class="line">                canvasRenderer.Clear();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ ‡è®°å½“å‰rectTransforméœ€è¦è¿›è¡Œå¸ƒå±€é‡å»º</span></span><br><span class="line">            LayoutRebuilder.MarkLayoutForRebuild(rectTransform);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">base</span>.OnDisable();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnDestroy:æ¸…ç©ºç½‘æ ¼å¼•ç”¨</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnDestroy</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_CachedMesh)</span><br><span class="line">        Destroy(m_CachedMesh);</span><br><span class="line">    m_CachedMesh = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">base</span>.OnDestroy();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnCanvasHierarchyChanged:Canvasçš„å±‚çº§å‘ç”Ÿå˜åŒ–çš„æ—¶å€™è°ƒç”¨</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnCanvasHierarchyChanged</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç¼“å­˜å½“å‰çš„Canvas</span></span><br><span class="line">    Canvas currentCanvas = m_Canvas;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¸…ç©ºm_Canvaså¼•ç”¨</span></span><br><span class="line">    m_Canvas = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!IsActive())</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªçˆ¶å¯¹è±¡ä¸­çš„Canvas</span></span><br><span class="line">    CacheCanvas();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ–°çš„Canvaså’Œç¼“å­˜çš„Canvasä¸ä¸€æ ·</span></span><br><span class="line">    <span class="keyword">if</span> (currentCanvas != m_Canvas)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ³¨é”€æ—§çš„Canvas</span></span><br><span class="line">        GraphicRegistry.UnregisterGraphicForCanvas(currentCanvas, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åªæœ‰å½“æˆ‘ä»¬æ¿€æ´»å¹¶å¯ç”¨OnCanvasHierarchyChangedæ—¶æ‰èƒ½æ³¨å†Œ</span></span><br><span class="line"><span class="comment">// åœ¨å¯¹è±¡é”€æ¯è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸æƒ³æ³¨å†Œè‡ªå·±ï¼Œç„¶åå˜æˆnullã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (IsActive())</span><br><span class="line">            <span class="comment">// æ³¨å†Œæ–°çš„Canvas</span></span><br><span class="line">            GraphicRegistry.RegisterGraphicForCanvas(canvas, <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnCullingChanged:å¤„ç† Canvas å…ƒç´ åœ¨è¢«å‰”é™¤çŠ¶æ€å˜åŒ–æ—¶çš„é€»è¾‘</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">OnCullingChanged</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥æ˜¯å¦å‰”é™¤å’Œå±æ€§è„æ ‡å¿—</span></span><br><span class="line">    <span class="keyword">if</span> (!canvasRenderer.cull &amp;&amp; (m_VertsDirty || m_MaterialDirty))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å°†å½“å‰Canvas å…ƒç´ æ³¨å†Œåˆ°å›¾å½¢é‡å»ºé˜Ÿåˆ—ä¸­ã€‚</span></span><br><span class="line">        CanvasUpdateRegistry.RegisterCanvasElementForGraphicRebuild(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Rebuild:æ ¹æ® <code>CanvasUpdate</code> ç±»å‹é‡æ–°æ„å»ºå›¾å½¢ç»„ä»¶ï¼Œç¡®ä¿åœ¨ç»˜åˆ¶ä¹‹å‰ï¼Œç»„ä»¶çš„å‡ ä½•ä½“å’Œæè´¨éƒ½æ˜¯æœ€æ–°çš„ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Rebuild</span>(<span class="params">CanvasUpdate update</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (canvasRenderer == <span class="literal">null</span> || canvasRenderer.cull)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (update)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> CanvasUpdate.PreRender:</span><br><span class="line">            <span class="keyword">if</span> (m_VertsDirty)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// æ›´æ–°é¡¶ç‚¹å‡ ä½•ä½“</span></span><br><span class="line">                UpdateGeometry();</span><br><span class="line">                m_VertsDirty = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (m_MaterialDirty)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// æ›´æ–°æè´¨</span></span><br><span class="line">                UpdateMaterial();</span><br><span class="line">                m_MaterialDirty = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>LayoutComplete:å¸ƒå±€é‡å»ºå®Œæˆäº‹ä»¶</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">LayoutComplete</span>()</span>&#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GraphicUpdateComplete:å›¾å½¢é‡å»ºå®Œæˆäº‹ä»¶</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">GraphicUpdateComplete</span>()</span>&#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>UpdateMaterial:æ›´æ–°UIçš„æè´¨å’Œçº¹ç†</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">UpdateMaterial</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!IsActive())</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®æ¸²æŸ“å™¨æ‰€ç”¨çš„æè´¨æ•°é‡ä¸º 1 </span></span><br><span class="line">    canvasRenderer.materialCount = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// æŒ‡å®šmaterialForRenderingåº”ç”¨åˆ°æ¸²æŸ“å™¨ä¸Š</span></span><br><span class="line">    canvasRenderer.SetMaterial(materialForRendering, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// å°†çº¹ç†å¼•ç”¨åˆ°å½“å‰æè´¨ä¸Š</span></span><br><span class="line">    canvasRenderer.SetTexture(mainTexture);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>UpdateGeometry:æ›´æ–° UI å…ƒç´ çš„å‡ ä½•ä½“ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">UpdateGeometry</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ˜¯å¦ä½¿ç”¨æ—§ç½‘æ ¼ç”Ÿæˆæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">if</span> (useLegacyMeshGeneration)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ä¼ ç»Ÿçš„æ–¹æ³•æ¥ç”Ÿæˆæˆ–æ›´æ–° UI å…ƒç´ çš„ç½‘æ ¼ã€‚</span></span><br><span class="line">        DoLegacyMeshGeneration();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨æ–°çš„æ–¹æ³•æ¥ç”Ÿæˆæˆ–æ›´æ–° UI å…ƒç´ çš„ç½‘æ ¼ã€‚</span></span><br><span class="line">        DoMeshGeneration();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>DoMeshGeneration:æ–°çš„ç”Ÿæˆæˆ–æ›´æ–° UI å…ƒç´ çš„ç½‘æ ¼æ–¹æ³•</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DoMeshGeneration</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (rectTransform != <span class="literal">null</span> &amp;&amp; rectTransform.rect.width &gt;= <span class="number">0</span> &amp;&amp; rectTransform.rect.height &gt;= <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// è°ƒç”¨ OnPopulateMesh æ–¹æ³•å°†é¡¶ç‚¹æ•°æ®å¡«å……åˆ° s_VertexHelper ä¸­</span></span><br><span class="line">        OnPopulateMesh(s_VertexHelper);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">// æ¸…é™¤é¡¶ç‚¹å¸®åŠ©å™¨ï¼Œä½¿æ— æ•ˆå›¾å½¢ä¸ç»˜åˆ¶ã€‚</span></span><br><span class="line">        s_VertexHelper.Clear();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–æ‰€æœ‰å®ç°äº† IMeshModifier æ¥å£çš„ç»„ä»¶</span></span><br><span class="line">    <span class="keyword">var</span> components = ListPool&lt;Component&gt;.Get();</span><br><span class="line">    GetComponents(<span class="keyword">typeof</span>(IMeshModifier), components);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éå†æ‰€æœ‰è·å–åˆ°çš„ IMeshModifier ç»„ä»¶ï¼Œå¹¶è°ƒç”¨å®ƒä»¬çš„ ModifyMesh æ–¹æ³•æ¥ä¿®æ”¹ s_VertexHelper ä¸­çš„ç½‘æ ¼æ•°æ®</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; components.Count; i++)</span><br><span class="line">        ((IMeshModifier)components[i]).ModifyMesh(s_VertexHelper);</span><br><span class="line"></span><br><span class="line">    ListPool&lt;Component&gt;.Release(components);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¡«å…… workerMesh</span></span><br><span class="line">    s_VertexHelper.FillMesh(workerMesh);</span><br><span class="line">    <span class="comment">// å°†è¿™ä¸ªç½‘æ ¼è®¾ç½®åˆ° canvasRenderer ä¸­ï¼Œä»¥ä¾¿è¿›è¡Œæ¸²æŸ“</span></span><br><span class="line">    canvasRenderer.SetMesh(workerMesh);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>DoLegacyMeshGeneration:æ—§çš„ç”Ÿæˆæˆ–æ›´æ–° UI å…ƒç´ çš„ç½‘æ ¼æ–¹æ³•</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DoLegacyMeshGeneration</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (rectTransform != <span class="literal">null</span> &amp;&amp; rectTransform.rect.width &gt;= <span class="number">0</span> &amp;&amp; rectTransform.rect.height &gt;= <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span> disable 618</span></span><br><span class="line">    <span class="comment">// å¡«å…… workerMesh</span></span><br><span class="line">                OnPopulateMesh(workerMesh);</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span> restore 618</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// æ¸…é™¤ç½‘æ ¼æ•°æ®</span></span><br><span class="line">                workerMesh.Clear();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è·å–æ‰€æœ‰ IMeshModifier ç»„ä»¶</span></span><br><span class="line">            <span class="keyword">var</span> components = ListPool&lt;Component&gt;.Get();</span><br><span class="line">            GetComponents(<span class="keyword">typeof</span>(IMeshModifier), components);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; components.Count; i++)</span><br><span class="line">            &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span> disable 618</span></span><br><span class="line">                ((IMeshModifier)components[i]).ModifyMesh(workerMesh);</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span> restore 618</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ListPool&lt;Component&gt;.Release(components);</span><br><span class="line">            canvasRenderer.SetMesh(workerMesh);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnPopulateMesh:UIå…ƒç´ éœ€è¦ç”Ÿæˆé¡¶ç‚¹æ—¶çš„å›è°ƒå‡½æ•°ã€‚å¡«å……é¡¶ç‚¹ç¼“å†²åŒºæ•°æ®ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">OnPopulateMesh</span>(<span class="params">Mesh m</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    OnPopulateMesh(s_VertexHelper);</span><br><span class="line">    s_VertexHelper.FillMesh(m);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnPopulateMesh:UIå…ƒç´ éœ€è¦ç”Ÿæˆé¡¶ç‚¹æ—¶çš„å›è°ƒå‡½æ•°ã€‚å¡«å……é¡¶ç‚¹ç¼“å†²åŒºæ•°æ®ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">OnPopulateMesh</span>(<span class="params">VertexHelper vh</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è·å– UI å…ƒç´ è°ƒæ•´åçš„çŸ©å½¢åŒºåŸŸï¼Œä»¥ç¡®ä¿åƒç´ å¯¹é½</span></span><br><span class="line">    <span class="keyword">var</span> r = GetPixelAdjustedRect();</span><br><span class="line">    <span class="comment">// åŒ…å«çŸ©å½¢çš„å·¦ä¸‹è§’å’Œå³ä¸Šè§’çš„åæ ‡</span></span><br><span class="line">    <span class="keyword">var</span> v = <span class="keyword">new</span> Vector4(r.x, r.y, r.x + r.width, r.y + r.height);</span><br><span class="line"></span><br><span class="line">    Color32 color32 = color;</span><br><span class="line">    vh.Clear();</span><br><span class="line">    <span class="comment">// æ·»åŠ å·¦ä¸‹è§’çš„é¡¶ç‚¹</span></span><br><span class="line">    vh.AddVert(<span class="keyword">new</span> Vector3(v.x, v.y), color32, <span class="keyword">new</span> Vector2(<span class="number">0f</span>, <span class="number">0f</span>));</span><br><span class="line">    <span class="comment">// æ·»åŠ å·¦ä¸Šè§’çš„é¡¶ç‚¹</span></span><br><span class="line">    vh.AddVert(<span class="keyword">new</span> Vector3(v.x, v.w), color32, <span class="keyword">new</span> Vector2(<span class="number">0f</span>, <span class="number">1f</span>));</span><br><span class="line">    <span class="comment">// æ·»åŠ å³ä¸Šè§’çš„é¡¶ç‚¹</span></span><br><span class="line">    vh.AddVert(<span class="keyword">new</span> Vector3(v.z, v.w), color32, <span class="keyword">new</span> Vector2(<span class="number">1f</span>, <span class="number">1f</span>));</span><br><span class="line">    <span class="comment">// æ·»åŠ å³ä¸‹è§’çš„é¡¶ç‚¹</span></span><br><span class="line">    vh.AddVert(<span class="keyword">new</span> Vector3(v.z, v.y), color32, <span class="keyword">new</span> Vector2(<span class="number">1f</span>, <span class="number">0f</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªä¸‰è§’å½¢ç”±é¡¶ç‚¹ 0ã€1 å’Œ 2 ç»„æˆ</span></span><br><span class="line">    vh.AddTriangle(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="comment">// ç¬¬äºŒä¸ªä¸‰è§’å½¢ç”±é¡¶ç‚¹ 2ã€3 å’Œ 0 ç»„æˆ</span></span><br><span class="line">    vh.AddTriangle(<span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetPixelAdjustedRectï¼šè¿”å›æœ€æ¥è¿‘å›¾å½¢RectTransformçš„åƒç´ å®Œç¾çŸ©å½¢ã€‚</p><p>æ³¨æ„:åªæœ‰å½“å›¾å½¢æ ¹ç”»å¸ƒåœ¨å±å¹•ç©ºé—´æ—¶æ‰å‡†ç¡®ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Rect <span class="title">GetPixelAdjustedRect</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥ canvas æ˜¯å¦å­˜åœ¨ã€canvas çš„æ¸²æŸ“æ¨¡å¼æ˜¯å¦ä¸º WorldSpaceã€canvas çš„ scaleFactor æ˜¯å¦ä¸º 0ã€æˆ– canvas çš„ pixelPerfect å±æ€§æ˜¯å¦ä¸º false</span></span><br><span class="line">    <span class="keyword">if</span> (!canvas || canvas.renderMode == RenderMode.WorldSpace || canvas.scaleFactor == <span class="number">0.0f</span> || !canvas.pixelPerfect)</span><br><span class="line">        <span class="comment">// å¦‚æœæ¡ä»¶æˆç«‹ï¼Œåˆ™è¿”å› rectTransform çš„åŸå§‹çŸ©å½¢</span></span><br><span class="line">        <span class="keyword">return</span> rectTransform.rect;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">// å¦åˆ™ï¼Œä½¿ç”¨ PixelAdjustRect æ–¹æ³•è·å–è°ƒæ•´åçš„çŸ©å½¢</span></span><br><span class="line">        <span class="keyword">return</span> RectTransformUtility.PixelAdjustRect(rectTransform, canvas);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnDidApplyAnimationPropertiesï¼šåŠ¨ç”»å±æ€§å‘ç”Ÿæ”¹å˜æ—¶è°ƒç”¨</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnDidApplyAnimationProperties</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    SetAllDirty();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetNativeSizeï¼šä½¿å›¾å½¢å…·æœ‰å…¶å†…å®¹çš„åŸå§‹å¤§å°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SetNativeSize</span>()</span> &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Raycastï¼šç”¨äº UI ç»„ä»¶çš„ç‚¹å‡»æ£€æµ‹</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sp&quot;&gt;</span>å°„çº¿çš„èµ·å§‹ç‚¹ï¼Œé€šå¸¸æ˜¯å±å¹•åæ ‡<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventCamera&quot;&gt;</span>è¿›è¡Œå°„çº¿æ£€æµ‹çš„ç›¸æœº<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">bool</span> <span class="title">Raycast</span>(<span class="params">Vector2 sp, Camera eventCamera</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å½“å‰å¯¹è±¡æ˜¯å¦è¢«æ¿€æ´»å¹¶å¯ç”¨</span></span><br><span class="line">    <span class="keyword">if</span> (!isActiveAndEnabled)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> t = transform;</span><br><span class="line">    <span class="keyword">var</span> components = ListPool&lt;Component&gt;.Get();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜¯å¦å¿½ç•¥çˆ¶çº§çš„ CanvasGroup</span></span><br><span class="line">    <span class="built_in">bool</span> ignoreParentGroups = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// æ§åˆ¶æ˜¯å¦ç»§ç»­éå†çˆ¶å¯¹è±¡</span></span><br><span class="line">    <span class="built_in">bool</span> continueTraversal = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¾ªç¯éå†å½“å‰å¯¹è±¡åŠå…¶æ‰€æœ‰çˆ¶å¯¹è±¡ï¼Œç›´åˆ°æ²¡æœ‰æ›´å¤šçš„çˆ¶å¯¹è±¡ä¸ºæ­¢</span></span><br><span class="line">    <span class="keyword">while</span> (t != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        t.GetComponents(components);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; components.Count; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ£€æŸ¥ç»„ä»¶æ˜¯å¦ä¸º Canvas ç±»å‹</span></span><br><span class="line">            <span class="keyword">var</span> canvas = components[i] <span class="keyword">as</span> Canvas;</span><br><span class="line">            <span class="comment">// å¦‚æœè¦†ç›–çˆ¶çº§çš„SortingLayer</span></span><br><span class="line">            <span class="keyword">if</span> (canvas != <span class="literal">null</span> &amp;&amp; canvas.overrideSorting)</span><br><span class="line">                <span class="comment">// åœæ­¢éå†çˆ¶çº§</span></span><br><span class="line">                continueTraversal = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ç¡®å®šå°„çº¿æ˜¯å¦æœ‰æ•ˆçš„æ¥å£</span></span><br><span class="line">            <span class="keyword">var</span> filter = components[i] <span class="keyword">as</span> ICanvasRaycastFilter;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (filter == <span class="literal">null</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å‡è®¾å°„çº¿æœ‰æ•ˆ</span></span><br><span class="line">            <span class="keyword">var</span> raycastValid = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ£€æŸ¥ç»„ä»¶æ˜¯å¦ä¸º CanvasGroup ç±»å‹</span></span><br><span class="line">            <span class="keyword">var</span> <span class="keyword">group</span> = components[i] <span class="keyword">as</span> CanvasGroup;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">group</span> != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å½“å‰ç»„ä»¶ä¸å¿½ç•¥çˆ¶çº§ å¹¶ä¸”è·å–åˆ°çš„groupä¹Ÿä¸å¿½ç•¥çˆ¶çº§</span></span><br><span class="line">                <span class="keyword">if</span> (ignoreParentGroups == <span class="literal">false</span> &amp;&amp; <span class="keyword">group</span>.ignoreParentGroups)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// å¿½ç•¥çˆ¶çº§</span></span><br><span class="line">                    ignoreParentGroups = <span class="literal">true</span>;</span><br><span class="line">                    <span class="comment">// æ£€æŸ¥å°„çº¿åœ¨å½“å‰ä½ç½®æ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">                    raycastValid = filter.IsRaycastLocationValid(sp, eventCamera);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (!ignoreParentGroups) <span class="comment">// å½“å‰ç»„ä»¶ä¸å¿½ç•¥çˆ¶çº§</span></span><br><span class="line">                    <span class="comment">// æ£€æŸ¥å°„çº¿åœ¨å½“å‰ä½ç½®æ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">                    raycastValid = filter.IsRaycastLocationValid(sp, eventCamera);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç»„ä»¶ä¸æ˜¯ CanvasGroup ç±»å‹</span></span><br><span class="line">                <span class="comment">// æ£€æŸ¥å°„çº¿åœ¨å½“å‰ä½ç½®æ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">                raycastValid = filter.IsRaycastLocationValid(sp, eventCamera);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!raycastValid)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// æ— æ•ˆå°„çº¿</span></span><br><span class="line">                ListPool&lt;Component&gt;.Release(components);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ˜¯å¦ç»§ç»­éå†çˆ¶çº§</span></span><br><span class="line">        t = continueTraversal ? t.parent : <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æœ‰æ•ˆå°„çº¿</span></span><br><span class="line">    ListPool&lt;Component&gt;.Release(components);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>PixelAdjustPointï¼šå°†ç»™å®šåƒç´ ç‚¹è°ƒæ•´ä¸ºåƒç´ å®Œç¾ã€‚</p><p>æ³¨æ„:åªæœ‰å½“å›¾å½¢æ ¹ç”»å¸ƒåœ¨å±å¹•ç©ºé—´æ—¶æ‰å‡†ç¡®ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Vector2 <span class="title">PixelAdjustPoint</span>(<span class="params">Vector2 point</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!canvas || canvas.renderMode == RenderMode.WorldSpace || canvas.scaleFactor == <span class="number">0.0f</span> || !canvas.pixelPerfect)</span><br><span class="line">        <span class="keyword">return</span> point;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> RectTransformUtility.PixelAdjustPoint(point, transform, canvas);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CrossFadeColorï¼šä½¿ç”¨RGBæ¨¡å¼å®ç°é¢œè‰²æ¸å˜æ•ˆæœçš„æ–¹æ³•</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">&lt;param name=&quot;targetColor&quot;&gt;</span>ç›®æ ‡é¢œè‰²ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">&lt;param name=&quot;duration&quot;&gt;</span>æ¸å˜æŒç»­æ—¶é—´ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">&lt;param name=&quot;ignoreTimeScale&quot;&gt;</span>æ˜¯å¦å¿½ç•¥Time.scale<span class="doctag">&lt; / param &gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">&lt;param name=&quot;useAlpha&quot;&gt;</span>æ˜¯å¦ä¹Ÿåº”è¯¥è¡¥é—´alphaé€šé“<span class="doctag">&lt; / param &gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">CrossFadeColor</span>(<span class="params">Color targetColor, <span class="built_in">float</span> duration, <span class="built_in">bool</span> ignoreTimeScale, <span class="built_in">bool</span> useAlpha</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    CrossFadeColor(targetColor, duration, ignoreTimeScale, useAlpha, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CrossFadeColorï¼šå°†é¢œè‰²æ¸å˜åˆ°ç›®æ ‡é¢œè‰²</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">&lt;param name=&quot;targetColor&quot;&gt;</span>ç›®æ ‡é¢œè‰²ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">&lt;param name=&quot;duration&quot;&gt;</span>æ¸å˜æŒç»­æ—¶é—´ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">&lt;param name=&quot;ignoreTimeScale&quot;&gt;</span>æ˜¯å¦å¿½ç•¥Time.scale<span class="doctag">&lt; / param &gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">&lt;param name=&quot;useAlpha&quot;&gt;</span>æ˜¯å¦ä¹Ÿåº”è¯¥è¡¥é—´alphaé€šé“<span class="doctag">&lt; / param &gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;useRGB&quot;&gt;</span>æ˜¯å¦ä½¿ç”¨é¢œè‰²è¿˜æ˜¯alphaæ¥è¡¥é—´<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">CrossFadeColor</span>(<span class="params">Color targetColor, <span class="built_in">float</span> duration, <span class="built_in">bool</span> ignoreTimeScale, <span class="built_in">bool</span> useAlpha, <span class="built_in">bool</span> useRGB</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ—¢ä¸ä½¿ç”¨alphaä¹Ÿä¸ä½¿ç”¨RGBæ¥è¡¥é—´ æ²¡æœ‰æŒ‡å®šæ¸å˜æ¨¡å¼</span></span><br><span class="line">    <span class="keyword">if</span> (canvasRenderer == <span class="literal">null</span> || (!useRGB &amp;&amp; !useAlpha))</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å½“å‰é¢œè‰²</span></span><br><span class="line">    Color currentColor = canvasRenderer.GetColor();</span><br><span class="line">    <span class="comment">// å¦‚æœå·²ç»æ˜¯ç›®æ ‡é¢œè‰² åˆ™ä¸è¿›è¡Œæ¸å˜</span></span><br><span class="line">    <span class="keyword">if</span> (currentColor.Equals(targetColor))</span><br><span class="line">    &#123;</span><br><span class="line">        m_ColorTweenRunner.StopTween();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†³å®šæ¸å˜æ¨¡å¼</span></span><br><span class="line">    ColorTween.ColorTweenMode mode = (useRGB &amp;&amp; useAlpha ?</span><br><span class="line">        ColorTween.ColorTweenMode.All :</span><br><span class="line">        (useRGB ? ColorTween.ColorTweenMode.RGB : ColorTween.ColorTweenMode.Alpha));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ª ColorTween å®ä¾‹ï¼Œå¹¶åˆå§‹åŒ–å…¶å±æ€§</span></span><br><span class="line">    <span class="keyword">var</span> colorTween = <span class="keyword">new</span> ColorTween &#123;duration = duration, startColor = canvasRenderer.GetColor(), targetColor = targetColor&#125;;</span><br><span class="line">    <span class="comment">// æ·»åŠ é¢œè‰²å˜åŒ–æ—¶çš„å›è°ƒï¼Œè°ƒç”¨canvasRenderer.SetColoræ¥æ›´æ–°é¢œè‰²</span></span><br><span class="line">    colorTween.AddOnChangedCallback(canvasRenderer.SetColor);</span><br><span class="line">    <span class="comment">// è®¾ç½®æ˜¯å¦å¿½ç•¥æ—¶é—´ç¼©æ”¾</span></span><br><span class="line">    colorTween.ignoreTimeScale = ignoreTimeScale;</span><br><span class="line">    <span class="comment">// è®¾ç½®æ¸å˜æ¨¡å¼</span></span><br><span class="line">    colorTween.tweenMode = mode;</span><br><span class="line">    <span class="comment">// å¯åŠ¨é¢œè‰²æ¸å˜</span></span><br><span class="line">    m_ColorTweenRunner.StartTween(colorTween);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CreateColorFromAlphaï¼šæ ¹æ®æŒ‡å®šçš„é€æ˜åº¦ï¼ˆ<code>alpha</code>ï¼‰åˆ›å»ºä¸€ä¸ªå¸¦æœ‰è¯¥é€æ˜åº¦çš„é»‘è‰²é¢œè‰²å¯¹è±¡</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">private</span> Color <span class="title">CreateColorFromAlpha</span>(<span class="params"><span class="built_in">float</span> alpha</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> alphaColor = Color.black;</span><br><span class="line">    alphaColor.a = alpha;</span><br><span class="line">    <span class="keyword">return</span> alphaColor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CrossFadeAlphaï¼šä½¿ç”¨Alphaæ¨¡å¼å®ç°é¢œè‰²æ¸å˜æ•ˆæœçš„æ–¹æ³•</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">&lt;param name=&quot;alpha&quot;&gt;</span>ç›®æ ‡alphaã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">&lt;param name=&quot;duration&quot;&gt;</span>æ¸å˜çš„æŒç»­æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">&lt;param name=&quot;ignoreTimeScale&quot;&gt;</span>æ˜¯å¦åº”è¯¥å¿½ç•¥æ—¶é—´ç¼©æ”¾<span class="doctag">&lt; / param &gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">CrossFadeAlpha</span>(<span class="params"><span class="built_in">float</span> alpha, <span class="built_in">float</span> duration, <span class="built_in">bool</span> ignoreTimeScale</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    CrossFadeColor(CreateColorFromAlpha(alpha), duration, ignoreTimeScale, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ·»åŠ äº‹ä»¶ç›‘å¬æ–¹æ³•</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ å¸ƒå±€é‡å»ºè„æ ‡è®°åå›è°ƒ</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RegisterDirtyLayoutCallback</span>(<span class="params">UnityAction action</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    m_OnDirtyLayoutCallback += action;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç§»é™¤å¸ƒå±€é‡å»ºè„æ ‡è®°åå›è°ƒ</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UnregisterDirtyLayoutCallback</span>(<span class="params">UnityAction action</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    m_OnDirtyLayoutCallback -= action;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ é¡¶ç‚¹é‡å»ºè„æ ‡è®°åå›è°ƒ</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RegisterDirtyVerticesCallback</span>(<span class="params">UnityAction action</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    m_OnDirtyVertsCallback += action;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç§»é™¤é¡¶ç‚¹é‡å»ºè„æ ‡è®°åå›è°ƒ</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UnregisterDirtyVerticesCallback</span>(<span class="params">UnityAction action</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    m_OnDirtyVertsCallback -= action;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ æè´¨æ›´æ–°è„æ ‡è®°åå›è°ƒ</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RegisterDirtyMaterialCallback</span>(<span class="params">UnityAction action</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    m_OnDirtyMaterialCallback += action;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç§»é™¤æè´¨æ›´æ–°è„æ ‡è®°åå›è°ƒ</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UnregisterDirtyMaterialCallback</span>(<span class="params">UnityAction action</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    m_OnDirtyMaterialCallback -= action;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Unityç¼–è¾‘å™¨ä¸­çš„æ–¹æ³•"><a href="#Unityç¼–è¾‘å™¨ä¸­çš„æ–¹æ³•" class="headerlink" title="Unityç¼–è¾‘å™¨ä¸­çš„æ–¹æ³•"></a>Unityç¼–è¾‘å™¨ä¸­çš„æ–¹æ³•</h4><blockquote><p>OnRebuildRequestedï¼šä¸»è¦å¤„ç†åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹å½“éœ€è¦é‡æ–°æ„å»º UI å›¾å½¢æ—¶çš„è¡Œä¸ºã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> UNITY_EDITOR</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¦‚æœéœ€è¦é‡å»ºå›¾å½¢ï¼ŒUnityä¼šå‘å‡ºä»…ç¼–è¾‘å™¨çš„å›è°ƒã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å½“èµ„äº§è¢«é‡æ–°å¯¼å…¥æ—¶å½“å‰å‘é€ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">OnRebuildRequested</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å½“è¯·æ±‚é‡å»ºæ—¶ï¼Œæˆ‘ä»¬éœ€è¦é‡å»ºæ‰€æœ‰å›¾å½¢</span></span><br><span class="line">            <span class="comment">// å’Œç›¸å…³ç»„ä»¶â€¦æ­£ç¡®çš„åšæ³•æ˜¯é€šè¿‡</span></span><br><span class="line">            <span class="comment">// è°ƒç”¨OnValidateâ€¦å› ä¸ºMBæ²¡æœ‰å…¬å…±åŸºç±»</span></span><br><span class="line">            <span class="comment">// æˆ‘ä»¬é€šè¿‡åå°„æ¥å®Œæˆã€‚å®ƒåˆè„åˆä¸‘â€¦â€¦ç¼–è¾‘å™¨ã€‚</span></span><br><span class="line">            <span class="keyword">var</span> mbs = gameObject.GetComponents&lt;MonoBehaviour&gt;();</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> mb <span class="keyword">in</span> mbs)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (mb == <span class="literal">null</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">var</span> methodInfo = mb.GetType().GetMethod(<span class="string">&quot;OnValidate&quot;</span>, BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);</span><br><span class="line">                <span class="keyword">if</span> (methodInfo != <span class="literal">null</span>)</span><br><span class="line">                    methodInfo.Invoke(mb, <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Reset</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            SetAllDirty();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><blockquote><p>OnValidateï¼šç¼–è¾‘å™¨æ¨¡å¼ä¸‹ï¼Œè„šæœ¬çš„å±æ€§åœ¨ Inspector ä¸­è¢«æ›´æ”¹æ—¶è‡ªåŠ¨è°ƒç”¨</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> UNITY_EDITOR</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnValidate</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">base</span>.OnValidate();</span><br><span class="line">    <span class="comment">// å¯¹æ‰€æœ‰å±æ€§è®¾ç½®ä¸ºè„æ ‡è®°</span></span><br><span class="line">            SetAllDirty();</span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è´Ÿè´£å›¾åƒçš„æ›´æ–°ä¸æ˜¾ç¤ºã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”LayoutElement</title>
    <link href="https://azzurebubble.github.io/posts/9b0fb5b4.html"/>
    <id>https://azzurebubble.github.io/posts/9b0fb5b4.html</id>
    <published>2024-08-07T14:24:14.000Z</published>
    <updated>2024-08-12T15:17:30.075Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>LayoutElementï¼šç»§æ‰¿äº†ILayoutElementå’ŒILayoutIgnoreræ¥å£ï¼Œä½œä¸ºå¸ƒå±€å…ƒç´ ç»„ä»¶<br>æŒ‚è½½äº†Layout Elementç»„ä»¶çš„å¯¹è±¡ï¼Œå¸ƒå±€å¹¶ä¸ä¼šç”Ÿæ•ˆï¼Œå®ƒæ˜¯å—åˆ°å®ç°äº†å¸ƒå±€ç»„çš„æ§åˆ¶(HorizontalLayoutGroupã€VerticalLayoutGroupã€GridLayoutGroup)</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>ç»§æ‰¿è‡ªILayoutElementçš„å±æ€§</p></blockquote><p><a href="https://azurebubble.github.io/posts/2f5dfff6.html"><strong>UGUIæºç è§£æâ€”â€”ILayoutElement</strong></a></p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸ªRectTransformæ˜¯å¦è¢«å¸ƒå±€ç³»ç»Ÿå¿½ç•¥</span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">private</span> <span class="built_in">bool</span> m_IgnoreLayout = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">bool</span> ignoreLayout &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_IgnoreLayout; &#125; <span class="keyword">set</span> &#123; <span class="keyword">if</span> (SetPropertyUtility.SetStruct(<span class="keyword">ref</span> m_IgnoreLayout, <span class="keyword">value</span>)) SetDirty(); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SetPropertyUtility.SetStruct(); çš„ä½œç”¨æ˜¯å®‰å…¨çš„è®¾ç½®ä¸€ä¸ªç»“æ„ä½“çš„å€¼ï¼Œåªæœ‰æ£€æµ‹åˆ°å€¼çœŸæ­£å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æ‰ä¼šè¿”å›Trueï¼Œé¿å…äº†ä¸è¦çš„æ€§èƒ½å¼€é”€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ€å°å®½åº¦ï¼Œåªè¦è®¾ç½®äº†å€¼ï¼Œä¸ç®¡å¸ƒå±€ç»„ä»¶æ€ä¹ˆè®¾ç½®ï¼Œæœ€å°å®½åº¦ä¸èƒ½å°äºè¿™ä¸ªå€¼</span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">private</span> <span class="built_in">float</span> m_MinWidth = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">float</span> minWidth &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_MinWidth; &#125; <span class="keyword">set</span> &#123; <span class="keyword">if</span> (SetPropertyUtility.SetStruct(<span class="keyword">ref</span> m_MinWidth, <span class="keyword">value</span>)) SetDirty(); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ€å°é«˜åº¦ï¼Œåªè¦è®¾ç½®äº†å€¼ï¼Œä¸ç®¡å¸ƒå±€ç»„ä»¶æ€ä¹ˆè®¾ç½®ï¼Œæœ€å°é«˜åº¦ä¸èƒ½å°äºè¿™ä¸ªå€¼</span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">private</span> <span class="built_in">float</span> m_MinHeight = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">float</span> minHeight &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_MinHeight; &#125; <span class="keyword">set</span> &#123; <span class="keyword">if</span> (SetPropertyUtility.SetStruct(<span class="keyword">ref</span> m_MinHeight, <span class="keyword">value</span>)) SetDirty(); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¦–é€‰å®½åº¦ï¼Œä¼šä¼˜å…ˆé€‰æ‹©è¿™ä¸ªå€¼ä½œä¸ºå¸ƒå±€è®¡ç®—å‚è€ƒ</span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">private</span> <span class="built_in">float</span> m_PreferredWidth = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">float</span> preferredWidth &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_PreferredWidth; &#125; <span class="keyword">set</span> &#123; <span class="keyword">if</span> (SetPropertyUtility.SetStruct(<span class="keyword">ref</span> m_PreferredWidth, <span class="keyword">value</span>)) SetDirty(); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¦–é€‰é«˜åº¦ï¼Œä¼šä¼˜å…ˆé€‰æ‹©è¿™ä¸ªå€¼ä½œä¸ºå¸ƒå±€è®¡ç®—å‚è€ƒ</span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">private</span> <span class="built_in">float</span> m_PreferredHeight = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">float</span> preferredHeight &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_PreferredHeight; &#125; <span class="keyword">set</span> &#123; <span class="keyword">if</span> (SetPropertyUtility.SetStruct(<span class="keyword">ref</span> m_PreferredHeight, <span class="keyword">value</span>)) SetDirty(); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¯ä¸€ä¸ªæ¯”ä¾‹å€¼ï¼Œå¦‚æœæœ‰é¢å¤–çš„ç©ºé—´ï¼Œä¼šåˆ©ç”¨è¿™ä¸ªæ¯”ä¾‹å€¼è·å–æœ€åçš„ç»“æœ</span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">private</span> <span class="built_in">float</span> m_FlexibleWidth = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">float</span> flexibleWidth &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_FlexibleWidth; &#125; <span class="keyword">set</span> &#123; <span class="keyword">if</span> (SetPropertyUtility.SetStruct(<span class="keyword">ref</span> m_FlexibleWidth, <span class="keyword">value</span>)) SetDirty(); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸€ä¸ªæ¯”ä¾‹å€¼ï¼Œå¦‚æœæœ‰é¢å¤–çš„ç©ºé—´ï¼Œä¼šåˆ©ç”¨è¿™ä¸ªæ¯”ä¾‹å€¼è·å–æœ€åçš„ç»“æœ</span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">private</span> <span class="built_in">float</span> m_FlexibleHeight = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">float</span> flexibleHeight &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_FlexibleHeight; &#125; <span class="keyword">set</span> &#123; <span class="keyword">if</span> (SetPropertyUtility.SetStruct(<span class="keyword">ref</span> m_FlexibleHeight, <span class="keyword">value</span>)) SetDirty(); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤å…ƒç´ çš„å¸ƒå±€ä¼˜å…ˆçº§</span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">private</span> <span class="built_in">int</span> m_LayoutPriority = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">int</span> layoutPriority &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_LayoutPriority; &#125; <span class="keyword">set</span> &#123; <span class="keyword">if</span> (SetPropertyUtility.SetStruct(<span class="keyword">ref</span> m_LayoutPriority, <span class="keyword">value</span>)) SetDirty(); &#125; &#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetDirty:å°†LayoutElementæ ‡è®°ä¸ºdirtyã€‚è¿™å°†ä½¿è‡ªåŠ¨å¸ƒå±€ç³»ç»Ÿåœ¨ä¸‹ä¸€æ¬¡å¸ƒå±€æ—¶å¤„ç†è¯¥å…ƒç´ ã€‚åªè¦æœ‰å¯èƒ½å½±å“å¸ƒå±€çš„æ›´æ”¹ï¼ŒLayoutElementå°±åº”è¯¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">SetDirty</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!IsActive())</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    LayoutRebuilder.MarkLayoutForRebuild(transform <span class="keyword">as</span> RectTransform);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ç»§æ‰¿äº†ILayoutElementå’ŒILayoutIgnoreræ¥å£ï¼Œä½œä¸ºå¸ƒå±€å…ƒç´ ç»„ä»¶ã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”LayoutUtility</title>
    <link href="https://azzurebubble.github.io/posts/a99e5cea.html"/>
    <id>https://azzurebubble.github.io/posts/a99e5cea.html</id>
    <published>2024-08-07T14:24:02.000Z</published>
    <updated>2024-08-12T15:41:37.086Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>LayoutUtilityï¼šå¸ƒå±€çš„å·¥å…·ç±»ï¼Œå¯ä»¥è·å–åˆ°å¯¹è±¡çš„minWidthã€preferredWidthã€flexibleWidthã€minHeightã€preferredHeightã€layoutPriorityçš„å±æ€§å€¼ã€‚ç”¨äºæŸ¥è¯¢å¸ƒå±€å…ƒç´ çš„æœ€å°ã€é¦–é€‰å’Œçµæ´»å¤§å°çš„å®ç”¨ç¨‹åºå‡½æ•°ã€‚</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>GetMinSize:è¿”å›å¸ƒå±€å…ƒç´ çš„æœ€å°å¤§å°ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¿”å›å¸ƒå±€å…ƒç´ çš„æœ€å°å¤§å°ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;rect&quot;&gt;</span>è¦æŸ¥è¯¢çš„å¸ƒå±€å…ƒç´ çš„RectTransform<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;axis&quot;&gt;</span>è¦æŸ¥è¯¢çš„è½´ã€‚å¯ä»¥æ˜¯0æˆ–1<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span>æ‰€æœ‰åœ¨GameObjectä¸Šå®ç°ILayoutElementçš„ç»„ä»¶éƒ½ä¼šè¢«æŸ¥è¯¢ã€‚ä½¿ç”¨å…·æœ‰æ­¤è®¾ç½®å€¼çš„å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„é‚£ä¸ªã€‚å¦‚æœå¤šä¸ªç»„ä»¶å…·æœ‰æ­¤è®¾ç½®å¹¶ä¸”å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ï¼Œåˆ™ä½¿ç”¨å…¶ä¸­çš„æœ€å¤§å€¼<span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">float</span> <span class="title">GetMinSize</span>(<span class="params">RectTransform rect, <span class="built_in">int</span> axis</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (axis == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> GetMinWidth(rect);</span><br><span class="line">    <span class="keyword">return</span> GetMinHeight(rect);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetPreferredSizeï¼šè¿”å›å¸ƒå±€å…ƒç´ çš„é¦–é€‰å¤§å°ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¿”å›å¸ƒå±€å…ƒç´ çš„çµæ´»å¤§å°</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æŸ¥è¯¢GameObjectä¸­å®ç°ILayoutElementçš„æ‰€æœ‰ç»„ä»¶ã€‚ä½¿ç”¨å…·æœ‰æ­¤è®¾ç½®å€¼çš„å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„é‚£ä¸ªã€‚å¦‚æœå¤šä¸ªç»„ä»¶å…·æœ‰æ­¤è®¾ç½®å¹¶ä¸”å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ï¼Œåˆ™ä½¿ç”¨å…¶ä¸­çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;rect&quot;&gt;</span>è¦æŸ¥è¯¢çš„å¸ƒå±€å…ƒç´ çš„RectTransform<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;axis&quot;&gt;</span>è¦æŸ¥è¯¢çš„è½´ã€‚å¯ä»¥æ˜¯0æˆ–1<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">float</span> <span class="title">GetPreferredSize</span>(<span class="params">RectTransform rect, <span class="built_in">int</span> axis</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (axis == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> GetPreferredWidth(rect);</span><br><span class="line">    <span class="keyword">return</span> GetPreferredHeight(rect);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetFlexibleSizeï¼šè¿”å›å¸ƒå±€å…ƒç´ çš„çµæ´»å¤§å°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¿”å›å¸ƒå±€å…ƒç´ çš„çµæ´»å¤§å°</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æŸ¥è¯¢GameObjectä¸­å®ç°ILayoutElementçš„æ‰€æœ‰ç»„ä»¶ã€‚ä½¿ç”¨å…·æœ‰æ­¤è®¾ç½®å€¼çš„å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„é‚£ä¸ªã€‚å¦‚æœå¤šä¸ªç»„ä»¶å…·æœ‰æ­¤è®¾ç½®å¹¶ä¸”å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ï¼Œåˆ™ä½¿ç”¨å…¶ä¸­çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;rect&quot;&gt;</span>è¦æŸ¥è¯¢çš„å¸ƒå±€å…ƒç´ çš„RectTransform<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;axis&quot;&gt;</span>è¦æŸ¥è¯¢çš„è½´ã€‚å¯ä»¥æ˜¯0æˆ–1<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">float</span> <span class="title">GetFlexibleSize</span>(<span class="params">RectTransform rect, <span class="built_in">int</span> axis</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">     <span class="keyword">if</span> (axis == <span class="number">0</span>)</span><br><span class="line">         <span class="keyword">return</span> GetFlexibleWidth(rect);</span><br><span class="line">     <span class="keyword">return</span> GetFlexibleHeight(rect);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetMinWidthï¼šè¿”å›å¸ƒå±€å…ƒç´ çš„æœ€å°å®½åº¦</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¿”å›å¸ƒå±€å…ƒç´ çš„æœ€å°å®½åº¦</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æŸ¥è¯¢GameObjectä¸­å®ç°ILayoutElementçš„æ‰€æœ‰ç»„ä»¶ã€‚ä½¿ç”¨å…·æœ‰æ­¤è®¾ç½®å€¼çš„å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„é‚£ä¸ªã€‚å¦‚æœå¤šä¸ªç»„ä»¶å…·æœ‰æ­¤è®¾ç½®å¹¶ä¸”å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ï¼Œåˆ™ä½¿ç”¨å…¶ä¸­çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;rect&quot;&gt;</span>è¦æŸ¥è¯¢çš„å¸ƒå±€å…ƒç´ çš„RectTransform<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">float</span> <span class="title">GetMinWidth</span>(<span class="params">RectTransform rect</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> GetLayoutProperty(rect, e =&gt; e.minWidth, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetPreferredWidth:è¿”å›å¸ƒå±€å…ƒç´ çš„é¦–é€‰å®½åº¦</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¿”å›å¸ƒå±€å…ƒç´ çš„é¦–é€‰å®½åº¦</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æŸ¥è¯¢GameObjectä¸­å®ç°ILayoutElementçš„æ‰€æœ‰ç»„ä»¶ã€‚ä½¿ç”¨å…·æœ‰æ­¤è®¾ç½®å€¼çš„å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„é‚£ä¸ªã€‚å¦‚æœå¤šä¸ªç»„ä»¶å…·æœ‰æ­¤è®¾ç½®å¹¶ä¸”å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ï¼Œåˆ™ä½¿ç”¨å…¶ä¸­çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;rect&quot;&gt;</span>è¦æŸ¥è¯¢çš„å¸ƒå±€å…ƒç´ çš„RectTransform<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">float</span> <span class="title">GetPreferredWidth</span>(<span class="params">RectTransform rect</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> Mathf.Max(GetLayoutProperty(rect, e =&gt; e.minWidth, <span class="number">0</span>), GetLayoutProperty(rect, e =&gt; e.preferredWidth, <span class="number">0</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetFlexibleWidth:è¿”å›å¸ƒå±€å…ƒç´ çš„çµæ´»å®½åº¦</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¿”å›å¸ƒå±€å…ƒç´ çš„çµæ´»å®½åº¦</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æŸ¥è¯¢GameObjectä¸­å®ç°ILayoutElementçš„æ‰€æœ‰ç»„ä»¶ã€‚ä½¿ç”¨å…·æœ‰æ­¤è®¾ç½®å€¼çš„å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„é‚£ä¸ªã€‚å¦‚æœå¤šä¸ªç»„ä»¶å…·æœ‰æ­¤è®¾ç½®å¹¶ä¸”å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ï¼Œåˆ™ä½¿ç”¨å…¶ä¸­çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;rect&quot;&gt;</span>è¦æŸ¥è¯¢çš„å¸ƒå±€å…ƒç´ çš„RectTransform<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">float</span> <span class="title">GetFlexibleWidth</span>(<span class="params">RectTransform rect</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> GetLayoutProperty(rect, e =&gt; e.flexibleWidth, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetMinHeight:è¿”å›å¸ƒå±€å…ƒç´ çš„æœ€å°é«˜åº¦</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¿”å›å¸ƒå±€å…ƒç´ çš„æœ€å°é«˜åº¦</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æŸ¥è¯¢GameObjectä¸­å®ç°ILayoutElementçš„æ‰€æœ‰ç»„ä»¶ã€‚ä½¿ç”¨å…·æœ‰æ­¤è®¾ç½®å€¼çš„å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„é‚£ä¸ªã€‚å¦‚æœå¤šä¸ªç»„ä»¶å…·æœ‰æ­¤è®¾ç½®å¹¶ä¸”å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ï¼Œåˆ™ä½¿ç”¨å…¶ä¸­çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;rect&quot;&gt;</span>è¦æŸ¥è¯¢çš„å¸ƒå±€å…ƒç´ çš„RectTransform<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">float</span> <span class="title">GetMinHeight</span>(<span class="params">RectTransform rect</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> GetLayoutProperty(rect, e =&gt; e.minHeight, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetPreferredHeight:è¿”å›å¸ƒå±€å…ƒç´ çš„é¦–é€‰é«˜åº¦</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¿”å›å¸ƒå±€å…ƒç´ çš„é¦–é€‰é«˜åº¦</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æŸ¥è¯¢GameObjectä¸­å®ç°ILayoutElementçš„æ‰€æœ‰ç»„ä»¶ã€‚ä½¿ç”¨å…·æœ‰æ­¤è®¾ç½®å€¼çš„å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„é‚£ä¸ªã€‚å¦‚æœå¤šä¸ªç»„ä»¶å…·æœ‰æ­¤è®¾ç½®å¹¶ä¸”å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ï¼Œåˆ™ä½¿ç”¨å…¶ä¸­çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;rect&quot;&gt;</span>è¦æŸ¥è¯¢çš„å¸ƒå±€å…ƒç´ çš„RectTransform<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">float</span> <span class="title">GetPreferredHeight</span>(<span class="params">RectTransform rect</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> Mathf.Max(GetLayoutProperty(rect, e =&gt; e.minHeight, <span class="number">0</span>), GetLayoutProperty(rect, e =&gt; e.preferredHeight, <span class="number">0</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetFlexibleHeight:è¿”å›å¸ƒå±€å…ƒç´ çš„çµæ´»é«˜åº¦</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¿”å›å¸ƒå±€å…ƒç´ çš„çµæ´»é«˜åº¦</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æŸ¥è¯¢GameObjectä¸­å®ç°ILayoutElementçš„æ‰€æœ‰ç»„ä»¶ã€‚ä½¿ç”¨å…·æœ‰æ­¤è®¾ç½®å€¼çš„å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„é‚£ä¸ªã€‚å¦‚æœå¤šä¸ªç»„ä»¶å…·æœ‰æ­¤è®¾ç½®å¹¶ä¸”å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ï¼Œåˆ™ä½¿ç”¨å…¶ä¸­çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;rect&quot;&gt;</span>è¦æŸ¥è¯¢çš„å¸ƒå±€å…ƒç´ çš„RectTransform<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">float</span> <span class="title">GetFlexibleHeight</span>(<span class="params">RectTransform rect</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> GetLayoutProperty(rect, e =&gt; e.flexibleHeight, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetLayoutProperty:è·å–å…·æœ‰ç»™å®šRectTransformçš„å¸ƒå±€å…ƒç´ çš„è®¡ç®—å¸ƒå±€å±æ€§</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è·å–å…·æœ‰ç»™å®šRectTransformçš„å¸ƒå±€å…ƒç´ çš„è®¡ç®—å¸ƒå±€å±æ€§</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;rect&quot;&gt;</span>å¸ƒå±€å…ƒç´ çš„RectTransformï¼Œç”¨äºè·å–ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;property&quot;&gt;</span>è¦è®¡ç®—çš„å±æ€§ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;defaultValue&quot;&gt;</span>å¦‚æœå¸ƒå±€å…ƒç´ ä¸Šæ²¡æœ‰ç»„ä»¶æä¾›ç»™å®šå±æ€§ï¼Œåˆ™ä½¿ç”¨çš„é»˜è®¤å€¼<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span> layoutå±æ€§çš„è®¡ç®—å€¼ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">float</span> <span class="title">GetLayoutProperty</span>(<span class="params">RectTransform rect, System.Func&lt;ILayoutElement, <span class="built_in">float</span>&gt; property, <span class="built_in">float</span> defaultValue</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    ILayoutElement dummy;</span><br><span class="line">    <span class="keyword">return</span> GetLayoutProperty(rect, property, defaultValue, <span class="keyword">out</span> dummy);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetLayoutProperty:éå†å¯¹è±¡èº«ä¸Šæ‰€æœ‰çš„ILayoutElementç±»å‹çš„ç»„ä»¶ï¼Œä½¿ç”¨ä¼˜å…ˆçº§æœ€é«˜ç»„ä»¶çš„å±æ€§å€¼ï¼Œè‹¥ç»„ä»¶ä¼˜å…ˆçº§ä¸€è‡´ï¼Œåˆ™å–æ•°å€¼æœ€å¤§çš„å±æ€§å€¼ï¼Œæ³¨æ„çš„æ˜¯å–å¾—Preferredå±æ€§æ—¶ä¼šæ¯”è¾ƒPreferredå’ŒMinçš„å¤§å°ï¼Œå–æ•°å€¼å¤§çš„</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è·å–å…·æœ‰ç»™å®šRectTransformçš„å¸ƒå±€å…ƒç´ çš„è®¡ç®—å¸ƒå±€å±æ€§</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;rect&quot;&gt;</span>å¸ƒå±€å…ƒç´ çš„RectTransformï¼Œç”¨äºè·å–ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;property&quot;&gt;</span>è¦è®¡ç®—çš„å±æ€§ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;defaultValue&quot;&gt;</span>å¦‚æœå¸ƒå±€å…ƒç´ ä¸Šæ²¡æœ‰ç»„ä»¶æä¾›ç»™å®šå±æ€§ï¼Œåˆ™ä½¿ç”¨çš„é»˜è®¤å€¼<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;source&quot;&gt;</span>å¯é€‰çš„outå‚æ•°ï¼Œç”¨äºè·å–æä¾›è®¡ç®—å€¼çš„ç»„ä»¶ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span> layoutå±æ€§çš„è®¡ç®—å€¼ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">float</span> GetLayoutPropertypublic <span class="keyword">static</span> <span class="built_in">float</span> <span class="title">GetLayoutProperty</span>(<span class="params">RectTransform rect, System.Func&lt;ILayoutElement, <span class="built_in">float</span>&gt; property, <span class="built_in">float</span> defaultValue, <span class="keyword">out</span> ILayoutElement source</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    source = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (rect == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">float</span> min = defaultValue;</span><br><span class="line">    <span class="built_in">int</span> maxPriority = System.Int32.MinValue;</span><br><span class="line">    <span class="keyword">var</span> components = ListPool&lt;Component&gt;.Get();</span><br><span class="line">    rect.GetComponents(<span class="keyword">typeof</span>(ILayoutElement), components);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; components.Count; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> layoutComp = components[i] <span class="keyword">as</span> ILayoutElement;</span><br><span class="line">        <span class="keyword">if</span> (layoutComp <span class="keyword">is</span> Behaviour &amp;&amp; !((Behaviour)layoutComp).isActiveAndEnabled)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">int</span> priority = layoutComp.layoutPriority;</span><br><span class="line">        <span class="comment">// å¦‚æœè¿™ä¸ªå¸ƒå±€ç»„ä»¶çš„ä¼˜å…ˆçº§ä½äºå…ˆå‰ä½¿ç”¨çš„ç»„ä»¶ï¼Œå¿½ç•¥å®ƒ</span></span><br><span class="line">        <span class="keyword">if</span> (priority &lt; maxPriority)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">float</span> prop = property(layoutComp);</span><br><span class="line">        <span class="comment">// å¦‚æœæ­¤å¸ƒå±€å±æ€§è®¾ç½®ä¸ºè´Ÿå€¼ï¼Œåˆ™æ„å‘³ç€åº”è¯¥å¿½ç•¥å®ƒ</span></span><br><span class="line">        <span class="keyword">if</span> (prop &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœè¿™ä¸ªå¸ƒå±€ç»„ä»¶çš„ä¼˜å…ˆçº§é«˜äºå‰é¢æ‰€æœ‰ç»„ä»¶ï¼Œ</span></span><br><span class="line">        <span class="comment">// ç”¨è¿™ä¸ªå€¼è¦†ç›–</span></span><br><span class="line">        <span class="keyword">if</span> (priority &gt; maxPriority)</span><br><span class="line">        &#123;</span><br><span class="line">            min = prop;</span><br><span class="line">            maxPriority = priority;</span><br><span class="line">            source = layoutComp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœå¸ƒå±€ç»„ä»¶ä¸ä¹‹å‰ä½¿ç”¨çš„ç»„ä»¶å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ï¼Œ</span></span><br><span class="line">        <span class="comment">// ä½¿ç”¨å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„æœ€å¤§å€¼</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (prop &gt; min)</span><br><span class="line">        &#123;</span><br><span class="line">            min = prop;</span><br><span class="line">            source = layoutComp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ListPool&lt;Component&gt;.Release(components);</span><br><span class="line">    <span class="keyword">return</span> min;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">å¸ƒå±€çš„å·¥å…·ç±»</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”ContentSizeFitter</title>
    <link href="https://azzurebubble.github.io/posts/50b8b756.html"/>
    <id>https://azzurebubble.github.io/posts/50b8b756.html</id>
    <published>2024-08-06T13:37:41.000Z</published>
    <updated>2024-08-07T14:26:33.623Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ContentSizeFitterï¼šå®ƒç”¨äºè‡ªé€‚åº”å¯¹è±¡å°ºå¯¸ï¼Œæ ¹æ®ILayoutElementæ¥å£çš„å­ç‰©ä½“è°ƒæ•´è‡ªèº«å¤§å°ã€‚åœ¨ä½¿ç”¨æ—¶è¦æ³¨æ„ï¼ŒæŒ‚è½½ContentSizeFitteråï¼Œå¤§å°å˜åŒ–å¯èƒ½éœ€è¦ä¸‹ä¸€å¸§ç”Ÿæ•ˆï¼Œå¯é€šè¿‡è°ƒç”¨SetLayoutHorizontalæˆ–ForceRebuildLayoutImmediateæ–¹æ³•å¼ºåˆ¶æ›´æ–°ã€‚</p><p>ContentSizeFitterä¸æ”¹å˜å­ç‰©ä½“çš„å¤§å°å’Œä½ç½®ï¼Œè€Œæ˜¯æ ¹æ®å­ç‰©ä½“(ILayoutElement)æ¥æ”¹å˜è‡ªèº«çš„å°ºå¯¸<br>ContentSizeFitteræ‰€<a href="https://so.csdn.net/so/search?q=æŒ‚è½½&amp;spm=1001.2101.3001.7020">æŒ‚è½½</a>çš„å¯¹è±¡ä¸Šå¿…é¡»æŒ‚è½½äº†å®ç°ILayoutElementæ¥å£çš„ç»„ä»¶</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>FitModeï¼šè‡ªé€‚åº”å°ºå¯¸é€‚åˆæ¨¡å¼ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> FitMode</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä¸åšä»»ä½•å¤§å°è°ƒæ•´</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    Unconstrained,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å°†å¤§å°è°ƒæ•´ä¸ºå†…å®¹çš„æœ€å°å¤§å°</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    MinSize,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å°†å¤§å°è°ƒæ•´ä¸ºå†…å®¹çš„é¦–é€‰å¤§å°</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    PreferredSize</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸€äº›å­—æ®µå‚æ•°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ç”¨äºå®½åº¦è‡ªé€‚åº”å°ºå¯¸é€‚åˆæ¨¡å¼ã€‚é»˜è®¤æ˜¯ä¸åšä»»ä½•è°ƒæ•´</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> FitMode m_HorizontalFit = FitMode.Unconstrained;</span><br><span class="line"><span class="keyword">public</span> FitMode horizontalFit &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_HorizontalFit; &#125; <span class="keyword">set</span> &#123; <span class="keyword">if</span> (SetPropertyUtility.SetStruct(<span class="keyword">ref</span> m_HorizontalFit, <span class="keyword">value</span>)) SetDirty(); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ç”¨äºé«˜åº¦è‡ªé€‚åº”å°ºå¯¸é€‚åˆæ¨¡å¼ã€‚é»˜è®¤æ˜¯ä¸åšä»»ä½•è°ƒæ•´</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> FitMode m_VerticalFit = FitMode.Unconstrained;</span><br><span class="line"><span class="keyword">public</span> FitMode verticalFit &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_VerticalFit; &#125; <span class="keyword">set</span> &#123; <span class="keyword">if</span> (SetPropertyUtility.SetStruct(<span class="keyword">ref</span> m_VerticalFit, <span class="keyword">value</span>)) SetDirty(); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–å½“å‰æŒ‚è½½ContentSizeFitterç»„ä»¶å¯¹è±¡çš„RectTransform</span></span><br><span class="line">[<span class="meta">System.NonSerialized</span>] <span class="keyword">private</span> RectTransform m_Rect;</span><br><span class="line"><span class="keyword">private</span> RectTransform rectTransform</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (m_Rect == <span class="literal">null</span>)</span><br><span class="line">            m_Rect = GetComponent&lt;RectTransform&gt;();</span><br><span class="line">        <span class="keyword">return</span> m_Rect;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç”Ÿå‘½å‘¨æœŸ</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">base</span>.OnEnable();</span><br><span class="line">    SetDirty();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnDisable</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">     <span class="comment">// æ¸…ç©ºè¿½è¸ªå™¨</span></span><br><span class="line">     m_Tracker.Clear();</span><br><span class="line">    <span class="comment">// å¼ºåˆ¶é‡æ„å¸ƒå±€</span></span><br><span class="line">     LayoutRebuilder.MarkLayoutForRebuild(rectTransform);</span><br><span class="line">     <span class="keyword">base</span>.OnDisable();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœå…³è”çš„ RectTransform å‘ç”Ÿæ”¹å˜åˆ™è°ƒç”¨è¿™ä¸ªå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnRectTransformDimensionsChange</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    SetDirty();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> UNITY_EDITOR</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnValidate</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        SetDirty();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><blockquote><p>SetDirtyï¼šå¼ºåˆ¶é‡å»ºå¸ƒå±€</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">SetDirty</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!IsActive())</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"><span class="comment">// å¦‚æœæ˜¯æ¿€æ´»çŠ¶æ€ å¼ºåˆ¶é‡æ„å¸ƒå±€</span></span><br><span class="line">    LayoutRebuilder.MarkLayoutForRebuild(rectTransform);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetLayoutHorizontalï¼šè®¡ç®—å¹¶å°†å¤§å°çš„æ°´å¹³åˆ†é‡åº”ç”¨äºRectTransform</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SetLayoutHorizontal</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    m_Tracker.Clear();</span><br><span class="line">    HandleSelfFittingAlongAxis(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetLayoutVerticalï¼šè®¡ç®—å¹¶å°†å¤§å°çš„å‚ç›´åˆ†é‡åº”ç”¨äºRectTransform</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SetLayoutVertical</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    HandleSelfFittingAlongAxis(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>HandleSelfFittingAlongAxisï¼šè®¾ç½®å¯¹è±¡çš„ä½ç½®å’Œå¤§å°ï¼Œå¯¹è±¡å±æ€§ç›´æ¥é€šè¿‡LayoutUtility.GetMinSizeä¸LayoutUtility.GetPreferredSizeè·å–ï¼Œè·å–æ—¶ä¼šä»å¯¹è±¡è‡ªèº«æŸ¥æ‰¾ILayoutElementï¼Œè·å–åˆ°minWidthä¸preferredWidthï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›é»˜è®¤å€¼0</p></blockquote><p><a href="https://azurebubble.github.io/posts/a99e5cea.html"><strong>UGUIæºç è§£æâ€”â€”LayoutUtility</strong></a></p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">HandleSelfFittingAlongAxis</span>(<span class="params"><span class="built_in">int</span> axis</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è·å–æ°´å¹³æˆ–è€…å‚ç›´æ–¹å‘çš„è‡ªé€‚åº”æ¨¡å¼</span></span><br><span class="line">     FitMode fitting = (axis == <span class="number">0</span> ? horizontalFit : verticalFit);</span><br><span class="line">     <span class="keyword">if</span> (fitting == FitMode.Unconstrained)</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="comment">// ä¿æŒå¯¹è·Ÿè¸ªå˜æ¢çš„å¼•ç”¨ï¼Œä½†ä¸è¦æ§åˆ¶å®ƒçš„å±æ€§</span></span><br><span class="line">         <span class="comment">// ä¸åšä»»ä½•å¤§å°è°ƒæ•´</span></span><br><span class="line">         m_Tracker.Add(<span class="keyword">this</span>, rectTransform, DrivenTransformProperties.None);</span><br><span class="line">         <span class="keyword">return</span>;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// å¦‚æœä¸æ˜¯ Unconstrained æ¨¡å¼ï¼Œåˆ™å…³è” rectTransform çš„ X è½´å’Œ Y è½´å˜åŒ–ï¼Œå¯¹rectTransformè¿›è¡Œè°ƒæ•´</span></span><br><span class="line">     m_Tracker.Add(<span class="keyword">this</span>, rectTransform, (axis == <span class="number">0</span> ? DrivenTransformProperties.SizeDeltaX : DrivenTransformProperties.SizeDeltaY));</span><br><span class="line"></span><br><span class="line">     <span class="comment">// è®¾ç½®å¤§å°ä¸ºæœ€å°æˆ–é¦–é€‰å¤§å°</span></span><br><span class="line">     <span class="keyword">if</span> (fitting == FitMode.MinSize)</span><br><span class="line">         rectTransform.SetSizeWithCurrentAnchors((RectTransform.Axis)axis, LayoutUtility.GetMinSize(m_Rect, axis));</span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">         rectTransform.SetSizeWithCurrentAnchors((RectTransform.Axis)axis, LayoutUtility.GetPreferredSize(m_Rect, axis));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šç»™å¯¹è±¡èº«ä¸ŠæŒ‚è½½ContentSizeFitterç»„ä»¶åè®¾ç½®PreferredSizeåç«‹å³è·å–rectTransform.sizeDelteæˆ–rectTransform.rect.sizeè¿˜æ˜¯ä¹‹å‰çš„å€¼ï¼Œä¸‹ä¸€å¸§åè·å–æ‰æ˜¯çœŸå®çš„sizeï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ‰§è¡Œä¸€æ¬¡æ›´æ–°æ–¹æ³•å†å»è·å–rect</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¬¬ä¸€ç§ SetLayoutHorizontal é‡Œä¼šå¯¹ m_Tracker è¿›è¡Œæ¸…ç©ºåå†æ‰§è¡Œ HandleSelfFittingAlongAxis</span></span><br><span class="line">GetComponent&lt;ContentSizeFitter&gt;().SetLayoutHorizontal();</span><br><span class="line"><span class="comment">//ç¬¬äºŒç§ å¼ºåˆ¶é‡å»º</span></span><br><span class="line">LayoutRebuilder.ForceRebuildLayoutImmediate(txt.rectTransform);</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ç»§æ‰¿äº†ILayoutElementå’ŒILayoutSelfControllerï¼Œæ˜¯è°ƒæ•´å¯¹è±¡è‡ªé€‚åº”çš„ç»„ä»¶ã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”GridLayoutGroup</title>
    <link href="https://azzurebubble.github.io/posts/5f14f802.html"/>
    <id>https://azzurebubble.github.io/posts/5f14f802.html</id>
    <published>2024-07-29T13:04:42.000Z</published>
    <updated>2024-08-06T13:36:40.327Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>GridLayoutGroupï¼šç»§æ‰¿è‡ªLayoutGroupï¼Œä¸ºç½‘æ ¼å¸ƒå±€ç»„ä»¶ï¼Œå®ƒåŒæ—¶å®ç°äº†æ°´å¹³å’Œç«–ç›´å¸ƒå±€ã€‚</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>æšä¸¾Cornerï¼šæ ‡è®°ç½‘æ ¼èµ·å§‹çš„ä½ç½®ï¼Œæœ‰å·¦ä¸Šè§’ã€å³ä¸Šè§’ã€å·¦ä¸‹è§’ã€å³ä¸‹è§’ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> Corner</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å·¦ä¸Šè§’</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    UpperLeft = <span class="number">0</span>,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å³ä¸Šè§’</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    UpperRight = <span class="number">1</span>,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å·¦ä¸‹è§’</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    LowerLeft = <span class="number">2</span>,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å³ä¸‹è§’</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    LowerRight = <span class="number">3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Axisï¼šæ ‡è®°å¼€å§‹æ’åˆ—çš„è½´æ–¹å‘ï¼Œæœ‰æ°´å¹³è½´å’Œå‚ç›´è½´ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> Axis</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ°´å¹³è½´</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    Horizontal = <span class="number">0</span>,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å‚ç›´è½´</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    Vertical = <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Constraintï¼šçº¦æŸè¡Œåˆ—çš„ä¸ªæ•°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> Constraint</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä¸é™åˆ¶è¡Œåˆ—å¤šå°‘ä¸ª</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    Flexible = <span class="number">0</span>,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> çº¦æŸè¡Œæ•°</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    FixedColumnCount = <span class="number">1</span>,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> çº¦æŸåˆ—æ•°</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    FixedRowCount = <span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸€äº›åºåˆ—åŒ–çš„å­—æ®µ</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å•å…ƒæ ¼èµ·å§‹è§’ Corner</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> Corner m_StartCorner = Corner.UpperLeft;</span><br><span class="line"><span class="keyword">public</span> Corner startCorner &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_StartCorner; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_StartCorner, <span class="keyword">value</span>); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å•å…ƒæ ¼æ²¿ç€å“ªä¸ªè½´å¼€å§‹æ”¾ç½®å¡«å……ï¼Œä¼˜å…ˆå¡«æ»¡ä¸€ä¸ªè½´æ‰è¿›è¡Œæ¢è½´</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> Axis m_StartAxis = Axis.Horizontal;</span><br><span class="line"><span class="keyword">public</span> Axis startAxis &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_StartAxis; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_StartAxis, <span class="keyword">value</span>); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å•å…ƒæ ¼å¤§å°</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> Vector2 m_CellSize = <span class="keyword">new</span> Vector2(<span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line"><span class="keyword">public</span> Vector2 cellSize &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_CellSize; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_CellSize, <span class="keyword">value</span>); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å•å…ƒæ ¼ä¸¤ä¸ªè½´å‘ä¸Šçš„é—´è·</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> Vector2 m_Spacing = Vector2.zero;</span><br><span class="line"><span class="keyword">public</span> Vector2 spacing &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_Spacing; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_Spacing, <span class="keyword">value</span>); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¡Œåˆ—çº¦æŸçš„è§„åˆ™ Constraint</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> Constraint m_Constraint = Constraint.Flexible;</span><br><span class="line"><span class="keyword">public</span> Constraint constraint &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_Constraint; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_Constraint, <span class="keyword">value</span>); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> çº¦æŸè½´ä¸Šé™åˆ¶æœ€å¤šå­˜åœ¨å¤šå°‘ä¸ªå•å…ƒæ ¼</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> <span class="built_in">int</span> m_ConstraintCount = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">int</span> constraintCount &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_ConstraintCount; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_ConstraintCount, Mathf.Max(<span class="number">1</span>, <span class="keyword">value</span>)); &#125; &#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnValidateï¼šå¼ºåˆ¶åˆ·æ–° constraintCount ç¡®ä¿å®ƒçš„å€¼åœ¨ç¼–è¾‘å™¨ä¸­èƒ½è¢«æ­£ç¡®åº”ç”¨å’ŒéªŒè¯ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> UNITY_EDITOR</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnValidate</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.OnValidate();</span><br><span class="line">        constraintCount = constraintCount;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p><a href="https://azurebubble.github.io/posts/51e1a8f9.html"><strong>UGUIæºç è§£æâ€”â€”LayoutGroup</strong></a></p><blockquote><p>CalculateLayoutInputHorizontalï¼šç”±å¸ƒå±€ç³»ç»Ÿè°ƒç”¨ï¼Œè®¡ç®—æ°´å¹³å¸ƒå±€çš„å¤§å°ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">CalculateLayoutInputHorizontal</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">base</span>.CalculateLayoutInputHorizontal();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®çº¦æŸç±»å‹ è®¡ç®—åˆ—æ•°</span></span><br><span class="line">    <span class="built_in">int</span> minColumns = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">int</span> preferredColumns = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (m_Constraint == Constraint.FixedColumnCount)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœçº¦æŸç±»å‹æ˜¯å›ºå®šåˆ—æ•°ï¼Œåˆ™æœ€å°åˆ—æ•°å’Œé¦–é€‰åˆ—æ•°éƒ½è®¾ç½®ä¸º m_ConstraintCount</span></span><br><span class="line">        minColumns = preferredColumns = m_ConstraintCount;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (m_Constraint == Constraint.FixedRowCount)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœçº¦æŸç±»å‹æ˜¯å›ºå®šè¡Œæ•°ï¼Œåˆ™æ ¹æ®å­å¯¹è±¡çš„æ•°é‡å’Œè¡Œæ•°çº¦æŸè®¡ç®—æœ€å°åˆ—æ•°å’Œé¦–é€‰åˆ—æ•°</span></span><br><span class="line">        minColumns = preferredColumns = Mathf.CeilToInt(rectChildren.Count / (<span class="built_in">float</span>)m_ConstraintCount - <span class="number">0.001f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰çº¦æŸï¼Œåˆ™æœ€å°åˆ—æ•°ä¸º1ï¼Œé¦–é€‰åˆ—æ•°ä¸ºå¹³æ–¹æ ¹ä¸‹çš„å­å¯¹è±¡æ•°é‡å‘ä¸Šå–æ•´</span></span><br><span class="line">        minColumns = <span class="number">1</span>;</span><br><span class="line">        preferredColumns = Mathf.CeilToInt(Mathf.Sqrt(rectChildren.Count));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// padding.horizontalï¼šè¡¨ç¤ºæ°´å¹³æ–¹å‘ä¸Šçš„å†…è¾¹è·ã€‚</span></span><br><span class="line">    <span class="comment">// (cellSize.x + spacing.x) * minColumns - spacing.x è¡¨ç¤ºæ ¹æ®åˆ—æ•°è®¡ç®—å‡ºçš„æœ€å°å®½åº¦ï¼Œè€ƒè™‘äº†æ¯ä¸ªå•å…ƒæ ¼çš„å¤§å°å’Œé—´è·ã€‚</span></span><br><span class="line">    <span class="comment">// (cellSize.x + spacing.x) * preferredColumns - spacing.x è¡¨ç¤ºæ ¹æ®åˆ—æ•°è®¡ç®—å‡ºçš„é¦–é€‰å®½åº¦ï¼ŒåŒæ ·è€ƒè™‘äº†æ¯ä¸ªå•å…ƒæ ¼çš„å¤§å°å’Œé—´è·ã€‚</span></span><br><span class="line">    SetLayoutInputForAxis(</span><br><span class="line">        padding.horizontal + (cellSize.x + spacing.x) * minColumns - spacing.x,</span><br><span class="line">        padding.horizontal + (cellSize.x + spacing.x) * preferredColumns - spacing.x,</span><br><span class="line">        <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CalculateLayoutInputVerticalï¼šç”±å¸ƒå±€ç³»ç»Ÿè°ƒç”¨ï¼Œè®¡ç®—å‚ç›´å¸ƒå±€çš„å¤§å°ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">CalculateLayoutInputVertical</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è®¡ç®—æœ€å°è¡Œæ•°</span></span><br><span class="line">    <span class="built_in">int</span> minRows = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (m_Constraint == Constraint.FixedColumnCount)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœçº¦æŸç±»å‹æ˜¯å›ºå®šåˆ—æ•°ï¼Œåˆ™æ ¹æ®å­å¯¹è±¡æ•°é‡å’Œåˆ—æ•°çº¦æŸè®¡ç®—æœ€å°è¡Œæ•°</span></span><br><span class="line">        minRows = Mathf.CeilToInt(rectChildren.Count / (<span class="built_in">float</span>)m_ConstraintCount - <span class="number">0.001f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (m_Constraint == Constraint.FixedRowCount)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœçº¦æŸç±»å‹æ˜¯å›ºå®šè¡Œæ•°ï¼Œåˆ™æœ€å°è¡Œæ•°ç›´æ¥è®¾ç½®ä¸º m_ConstraintCount</span></span><br><span class="line">        minRows = m_ConstraintCount;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰çº¦æŸï¼Œåˆ™æ ¹æ®å®¹å™¨å®½åº¦è®¡ç®—å¯ä»¥å®¹çº³çš„åˆ—æ•°ï¼Œå†æ ¹æ®å­å¯¹è±¡æ•°é‡è®¡ç®—æœ€å°è¡Œæ•°</span></span><br><span class="line">        <span class="built_in">float</span> width = rectTransform.rect.width;</span><br><span class="line">        <span class="built_in">int</span> cellCountX = Mathf.Max(<span class="number">1</span>, Mathf.FloorToInt((width - padding.horizontal + spacing.x + <span class="number">0.001f</span>) / (cellSize.x + spacing.x)));</span><br><span class="line">        minRows = Mathf.CeilToInt(rectChildren.Count / (<span class="built_in">float</span>)cellCountX);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// padding.verticalï¼šè¡¨ç¤ºå‚ç›´æ–¹å‘ä¸Šçš„å†…è¾¹è·ã€‚</span></span><br><span class="line">    <span class="comment">// (cellSize.y + spacing.y) * minRows - spacing.y è¡¨ç¤ºæ ¹æ®è¡Œæ•°è®¡ç®—å‡ºçš„å‚ç›´æ–¹å‘ä¸Šçš„æœ€å°é«˜åº¦ï¼Œè€ƒè™‘äº†æ¯ä¸ªå•å…ƒæ ¼çš„å¤§å°å’Œé—´è·ã€‚</span></span><br><span class="line">    <span class="built_in">float</span> minSpace = padding.vertical + (cellSize.y + spacing.y) * minRows - spacing.y;</span><br><span class="line">    SetLayoutInputForAxis(minSpace, minSpace, <span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>SetLayoutVerticalï¼šè¿™ä¸ªæ–¹æ³•é€šå¸¸ç”¨äºåœ¨æ°´å¹³æ–¹å‘ä¸Šè®¾ç½®å¸ƒå±€ï¼Œä»¥ç¡®ä¿å¸ƒå±€ç»„ä»¶å†…çš„å­å¯¹è±¡æŒ‰ç…§è§„å®šçš„æ–¹å¼è¿›è¡Œæ’åˆ—å’Œè°ƒæ•´ä½ç½®ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">SetLayoutVertical</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    SetCellsAlongAxis(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">SetCellsAlongAxis</span>(<span class="params"><span class="built_in">int</span> axis</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//é€šå¸¸æƒ…å†µä¸‹ï¼Œå¸ƒå±€æ§åˆ¶å™¨åº”è¯¥åªåœ¨è°ƒç”¨æ°´å¹³è½´æ—¶è®¾ç½®æ°´å¹³å€¼</span></span><br><span class="line"><span class="comment">//å½“å¯¹å‚ç›´è½´è°ƒç”¨æ—¶ï¼Œåªè°ƒç”¨å‚ç›´å€¼ã€‚</span></span><br><span class="line"><span class="comment">//ç„¶è€Œï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨å‚ç›´è½´æ—¶è®¾ç½®äº†æ°´å¹³å’Œå‚ç›´ä½ç½®ã€‚</span></span><br><span class="line"><span class="comment">//å› ä¸ºæˆ‘ä»¬åªè®¾ç½®æ°´å¹³ä½ç½®è€Œä¸è®¾ç½®å¤§å°ï¼Œæ‰€ä»¥å®ƒåº”è¯¥ä¸ä¼šå½±å“å­å…ƒç´ çš„å¸ƒå±€ã€‚</span></span><br><span class="line"><span class="comment">//å› æ­¤ä¸åº”è¯¥æ‰“ç ´æ‰€æœ‰æ°´å¹³å¸ƒå±€å¿…é¡»åœ¨æ‰€æœ‰å‚ç›´å¸ƒå±€ä¹‹å‰è®¡ç®—çš„è§„åˆ™ã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (axis == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä»…åœ¨è°ƒç”¨æ°´å¹³è½´æ—¶è®¾ç½®å¤§å°ï¼Œè€Œä¸æ˜¯ä½ç½®ã€‚</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; rectChildren.Count; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            RectTransform rect = rectChildren[i];</span><br><span class="line"></span><br><span class="line">            m_Tracker.Add(<span class="keyword">this</span>, rect,</span><br><span class="line">                DrivenTransformProperties.Anchors |</span><br><span class="line">                DrivenTransformProperties.AnchoredPosition |</span><br><span class="line">                DrivenTransformProperties.SizeDelta);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è®¾ç½®æ‰€æœ‰å­å…ƒç´ çš„é”šç‚¹ä¸ºå·¦ä¸Šè§’(0,1) å¹¶ä¸”è®¾ç½®ä»–ä»¬çš„å¤§å°ä¸ºcellSize</span></span><br><span class="line">            rect.anchorMin = Vector2.up;</span><br><span class="line">            rect.anchorMax = Vector2.up;</span><br><span class="line">            rect.sizeDelta = cellSize;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœå‚ç›´è½´çš„å¸ƒå±€</span></span><br><span class="line">    <span class="built_in">float</span> width = rectTransform.rect.size.x; <span class="comment">// å®¹å™¨çš„å®½åº¦</span></span><br><span class="line">    <span class="built_in">float</span> height = rectTransform.rect.size.y; <span class="comment">// å®¹å™¨çš„é«˜åº¦</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">int</span> cellCountX = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">int</span> cellCountY = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (m_Constraint == Constraint.FixedColumnCount)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœé™åˆ¶äº†åˆ—æ•°</span></span><br><span class="line">        <span class="comment">// è®¾ç½® X è½´çš„æ ¼å­æ•°é‡ä¸ºé¢„å®šä¹‰æ•°é‡</span></span><br><span class="line">        cellCountX = m_ConstraintCount;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœå­å…ƒç´ çš„æ•°é‡å¤§äºé¢„å®šä¹‰çš„ X è½´æ ¼å­æ•° åˆ™è®¡ç®— Y è½´è¡Œæ•°</span></span><br><span class="line">        <span class="keyword">if</span> (rectChildren.Count &gt; cellCountX)</span><br><span class="line">            <span class="comment">// å¦‚æœæœ‰ä½™æ•° åˆ™ å†åŠ  1</span></span><br><span class="line">            cellCountY = rectChildren.Count / cellCountX + (rectChildren.Count % cellCountX &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (m_Constraint == Constraint.FixedRowCount)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœé™åˆ¶äº†è¡Œæ•°</span></span><br><span class="line">        cellCountY = m_ConstraintCount;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœå­å…ƒç´ æ•°é‡å¤§äºé™åˆ¶è¡Œæ•° åˆ™è®¡ç®—åˆ—æ•°</span></span><br><span class="line">        <span class="keyword">if</span> (rectChildren.Count &gt; cellCountY)</span><br><span class="line">            cellCountX = rectChildren.Count / cellCountY + (rectChildren.Count % cellCountY &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰é™åˆ¶</span></span><br><span class="line">        <span class="comment">// å¦‚æœå•å…ƒæ ¼å¤§å°+é—´è·å°äºç­‰äº0ï¼Œè¡¨ç¤ºæ°´å¹³æ–¹å‘æ²¡æœ‰å…ƒç´ æ•°é‡é™åˆ¶ï¼Œåº”å°½å¯èƒ½å®¹çº³å¤šçš„å…ƒç´ </span></span><br><span class="line">        <span class="keyword">if</span> (cellSize.x + spacing.x &lt;= <span class="number">0</span>)</span><br><span class="line">            cellCountX = <span class="built_in">int</span>.MaxValue;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="comment">// å¦åˆ™ï¼Œè®¡ç®—æ°´å¹³æ–¹å‘ä¸Šå¯ä»¥å®¹çº³çš„å•å…ƒæ ¼æ•°é‡ã€‚ä½¿ç”¨ Mathf.FloorToInt å‡½æ•°è®¡ç®— (width - padding.horizontal + spacing.x + 0.001f) / (cellSize.x + spacing.x)ï¼Œè¿™ä¸ªè¡¨è¾¾å¼è®¡ç®—å®¹å™¨å®½åº¦å‡å»æ°´å¹³å¡«å……ã€åŠ ä¸Šé—´è·å’Œå¾®å°è°ƒæ•´åèƒ½å®¹çº³å¤šå°‘ä¸ªå•å…ƒæ ¼çš„æ•´æ•°éƒ¨åˆ†ã€‚</span></span><br><span class="line">            cellCountX = Mathf.Max(<span class="number">1</span>, Mathf.FloorToInt((width - padding.horizontal + spacing.x + <span class="number">0.001f</span>) / (cellSize.x + spacing.x)));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åŒä¸Š</span></span><br><span class="line">        <span class="keyword">if</span> (cellSize.y + spacing.y &lt;= <span class="number">0</span>)</span><br><span class="line">            cellCountY = <span class="built_in">int</span>.MaxValue;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            cellCountY = Mathf.Max(<span class="number">1</span>, Mathf.FloorToInt((height - padding.vertical + spacing.y + <span class="number">0.001f</span>) / (cellSize.y + spacing.y)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—èµ·å§‹è§’çš„åæ ‡</span></span><br><span class="line">    <span class="built_in">int</span> cornerX = (<span class="built_in">int</span>)startCorner % <span class="number">2</span>; <span class="comment">// (0/1)</span></span><br><span class="line">    <span class="built_in">int</span> cornerY = (<span class="built_in">int</span>)startCorner / <span class="number">2</span>; <span class="comment">// (0/1)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—ä¸»è½´ä¸Šçš„å•å…ƒæ ¼æ•°é‡</span></span><br><span class="line">    <span class="built_in">int</span> cellsPerMainAxis, actualCellCountX, actualCellCountY;</span><br><span class="line">    <span class="keyword">if</span> (startAxis == Axis.Horizontal)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä¸»è½´æœ€å¤§æ•°é‡</span></span><br><span class="line">        cellsPerMainAxis = cellCountX;</span><br><span class="line">        <span class="comment">// æ¨ªè½´æœ€å¤§æ•°é‡</span></span><br><span class="line">        actualCellCountX = Mathf.Clamp(cellCountX, <span class="number">1</span>, rectChildren.Count);</span><br><span class="line">        <span class="comment">// ç«–è½´æœ€å¤§æ•°é‡</span></span><br><span class="line">        actualCellCountY = Mathf.Clamp(cellCountY, <span class="number">1</span>, Mathf.CeilToInt(rectChildren.Count / (<span class="built_in">float</span>)cellsPerMainAxis));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// åŒä¸Š è®¡ç®—å‚ç›´å¸ƒå±€</span></span><br><span class="line">        cellsPerMainAxis = cellCountY;</span><br><span class="line">        actualCellCountY = Mathf.Clamp(cellCountY, <span class="number">1</span>, rectChildren.Count);</span><br><span class="line">        actualCellCountX = Mathf.Clamp(cellCountX, <span class="number">1</span>, Mathf.CeilToInt(rectChildren.Count / (<span class="built_in">float</span>)cellsPerMainAxis));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—å®¹å™¨æ‰€éœ€çš„ç©ºé—´å¤§å°</span></span><br><span class="line">    Vector2 requiredSpace = <span class="keyword">new</span> Vector2(</span><br><span class="line">        actualCellCountX * cellSize.x + (actualCellCountX - <span class="number">1</span>) * spacing.x,</span><br><span class="line">        actualCellCountY * cellSize.y + (actualCellCountY - <span class="number">1</span>) * spacing.y</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">// è®¡ç®—èµ·å§‹åç§»é‡</span></span><br><span class="line">    Vector2 startOffset = <span class="keyword">new</span> Vector2(</span><br><span class="line">        GetStartOffset(<span class="number">0</span>, requiredSpace.x),</span><br><span class="line">        GetStartOffset(<span class="number">1</span>, requiredSpace.y)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®å­å…ƒç´ çš„ä½ç½®</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; rectChildren.Count; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> positionX;</span><br><span class="line">        <span class="built_in">int</span> positionY;</span><br><span class="line">        <span class="keyword">if</span> (startAxis == Axis.Horizontal)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å‡è®¾æ°´å¹³è½´é™åˆ¶æœ€å¤šä¸¤ä¸ªå…ƒç´ </span></span><br><span class="line">            <span class="comment">// X ï¼š 0 % 2 = 0  1 % 2 = 1 2 % 2 = 0 3 % 2 = 1 .....</span></span><br><span class="line">            <span class="comment">// Y ï¼š 0 / 2 = 0  1 / 2 = 0 2 / 2 = 1 3 / 2 = 1 ..... </span></span><br><span class="line">            positionX = i % cellsPerMainAxis;</span><br><span class="line">            positionY = i / cellsPerMainAxis;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å‚ç›´è½´ åŒä¸Š</span></span><br><span class="line">            positionX = i / cellsPerMainAxis;</span><br><span class="line">            positionY = i % cellsPerMainAxis;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ ¹æ®èµ·å§‹è§’çš„ä½ç½® è®¡ç®—å…ƒç´ çš„ä½ç½® å‡è®¾æ˜¯ä¸€ä¸ªå››è¡Œä¸‰åˆ—çš„å¸ƒå±€</span></span><br><span class="line">        <span class="comment">// ä¾‹å¦‚å¦‚æœèµ·å§‹è§’ä¸ºå·¦ä¸Šè§’(0,0)ï¼Œåˆ™ç¬¬ä¸€ä¸ªå…ƒç´ åæ ‡ä¸º(0,0)</span></span><br><span class="line">        <span class="comment">// å¦‚æœèµ·å§‹è§’ä¸ºå³ä¸Šè§’(1,0)ï¼Œåˆ™ç¬¬ä¸€ä¸ªå…ƒç´ åæ ‡ä¸º(2,0) ä»¥æ­¤ç±»æ¨</span></span><br><span class="line">        <span class="keyword">if</span> (cornerX == <span class="number">1</span>)</span><br><span class="line">            positionX = actualCellCountX - <span class="number">1</span> - positionX;</span><br><span class="line">        <span class="keyword">if</span> (cornerY == <span class="number">1</span>)</span><br><span class="line">            positionY = actualCellCountY - <span class="number">1</span> - positionY;</span><br><span class="line"></span><br><span class="line">        SetChildAlongAxis(rectChildren[i], <span class="number">0</span>, startOffset.x + (cellSize[<span class="number">0</span>] + spacing[<span class="number">0</span>]) * positionX, cellSize[<span class="number">0</span>]);</span><br><span class="line">        SetChildAlongAxis(rectChildren[i], <span class="number">1</span>, startOffset.y + (cellSize[<span class="number">1</span>] + spacing[<span class="number">1</span>]) * positionY, cellSize[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ç»§æ‰¿è‡ªLayoutGroupï¼Œä¸ºç½‘æ ¼å¸ƒå±€ç»„ä»¶ï¼Œå®ƒåŒæ—¶å®ç°äº†æ°´å¹³å’Œç«–ç›´å¸ƒå±€ã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”VerticalLayoutGroup</title>
    <link href="https://azzurebubble.github.io/posts/61697f5e.html"/>
    <id>https://azzurebubble.github.io/posts/61697f5e.html</id>
    <published>2024-07-29T13:04:25.000Z</published>
    <updated>2024-07-29T13:17:36.576Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>VerticalLayoutGroupï¼šç»§æ‰¿è‡ªHorizontalOrVerticalLayoutGroupï¼ŒHorizontalOrVerticalLayoutGroupç»§æ‰¿è‡ªLayoutGroupï¼Œæ˜¯å‚ç›´å¸ƒå±€ç»„ä»¶ã€‚ä¼šå—åˆ°LayoutElementç»„ä»¶çš„å½±å“ã€‚</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><p><a href="https://azurebubble.github.io/posts/51e1a8f9.html"><strong>UGUIæºç è§£æâ€”â€”LayoutGroup</strong></a></p><blockquote><p>CalculateLayoutInputHorizontalï¼šç”±å¸ƒå±€ç³»ç»Ÿè°ƒç”¨ã€‚ä¹Ÿè¯·å‚è§ILayoutElementã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ç°äº†è®¡ç®—å¹¶è®¾ç½®m_TotalMinSizeã€m_TotalPreferredSizeã€m_TotalFlexibleSizeå±æ€§å€¼ï¼Œè°ƒç”¨äº†åŸºç±»LayoutGroupä¸­çš„SetLayoutInputForAxisæ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">CalculateLayoutInputHorizontal</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">base</span>.CalculateLayoutInputHorizontal();</span><br><span class="line">    CalcAlongAxis(<span class="number">0</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CalculateLayoutInputVerticalï¼š</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">CalculateLayoutInputVertical</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    CalcAlongAxis(<span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetLayoutHorizontalï¼šå®ç°äº†è®¾ç½®å­ç‰©ä½“çš„ä½ç½®å’Œå¤§å°ï¼Œè°ƒç”¨äº†åŸºç±»LayoutGroupä¸­çš„SetChildAlongAxisWithScaleæˆ–SetChildAlongAxisæ–¹æ³•</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">SetLayoutHorizontal</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    SetChildrenAlongAxis(<span class="number">0</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetLayoutHorizontalï¼šå®ç°äº†è®¾ç½®å­ç‰©ä½“çš„ä½ç½®å’Œå¤§å°ï¼Œè°ƒç”¨äº†åŸºç±»LayoutGroupä¸­çš„SetChildAlongAxisWithScaleæˆ–SetChildAlongAxisæ–¹æ³•</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">SetLayoutVertical</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    SetChildrenAlongAxis(<span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ç»§æ‰¿è‡ªHorizontalOrVerticalLayoutGroupï¼ŒHorizontalOrVerticalLayoutGroupç»§æ‰¿è‡ªLayoutGroupï¼Œæ˜¯å‚ç›´å¸ƒå±€ç»„ä»¶ã€‚ä¼šå—åˆ°LayoutElementç»„ä»¶çš„å½±å“ã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”HorizontalLayoutGroup</title>
    <link href="https://azzurebubble.github.io/posts/2fff82bf.html"/>
    <id>https://azzurebubble.github.io/posts/2fff82bf.html</id>
    <published>2024-07-29T13:04:11.000Z</published>
    <updated>2024-07-29T13:15:15.090Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>HorizontalLayoutGroupï¼šç»§æ‰¿è‡ªHorizontalOrVerticalLayoutGroupï¼ŒHorizontalOrVerticalLayoutGroupç»§æ‰¿è‡ªLayoutGroupï¼Œæ˜¯æ°´å¹³å¸ƒå±€ç»„ä»¶ã€‚ä¼šå—åˆ°LayoutElementç»„ä»¶çš„å½±å“ã€‚</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><p><a href="https://azurebubble.github.io/posts/51e1a8f9.html"><strong>UGUIæºç è§£æâ€”â€”LayoutGroup</strong></a></p><blockquote><p>CalculateLayoutInputHorizontalï¼šç”±å¸ƒå±€ç³»ç»Ÿè°ƒç”¨ã€‚ä¹Ÿè¯·å‚è§ILayoutElementã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ç°äº†è®¡ç®—å¹¶è®¾ç½®m_TotalMinSizeã€m_TotalPreferredSizeã€m_TotalFlexibleSizeå±æ€§å€¼ï¼Œè°ƒç”¨äº†åŸºç±»LayoutGroupä¸­çš„SetLayoutInputForAxisæ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">CalculateLayoutInputHorizontal</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">base</span>.CalculateLayoutInputHorizontal();</span><br><span class="line">    CalcAlongAxis(<span class="number">0</span>, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CalculateLayoutInputVerticalï¼š</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">CalculateLayoutInputVertical</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    CalcAlongAxis(<span class="number">1</span>, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetLayoutHorizontalï¼šå®ç°äº†è®¾ç½®å­ç‰©ä½“çš„ä½ç½®å’Œå¤§å°ï¼Œè°ƒç”¨äº†åŸºç±»LayoutGroupä¸­çš„SetChildAlongAxisWithScaleæˆ–SetChildAlongAxisæ–¹æ³•</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">SetLayoutHorizontal</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    SetChildrenAlongAxis(<span class="number">0</span>, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetLayoutHorizontalï¼šå®ç°äº†è®¾ç½®å­ç‰©ä½“çš„ä½ç½®å’Œå¤§å°ï¼Œè°ƒç”¨äº†åŸºç±»LayoutGroupä¸­çš„SetChildAlongAxisWithScaleæˆ–SetChildAlongAxisæ–¹æ³•</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">SetLayoutVertical</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    SetChildrenAlongAxis(<span class="number">1</span>, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ç»§æ‰¿è‡ªHorizontalOrVerticalLayoutGroupï¼ŒHorizontalOrVerticalLayoutGroupç»§æ‰¿è‡ªLayoutGroupï¼Œæ˜¯æ°´å¹³å¸ƒå±€ç»„ä»¶ã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”HorizontalOrVerticalLayoutGroup</title>
    <link href="https://azzurebubble.github.io/posts/50159f2d.html"/>
    <id>https://azzurebubble.github.io/posts/50159f2d.html</id>
    <published>2024-07-23T12:23:44.000Z</published>
    <updated>2024-07-23T13:06:17.395Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç»§æ‰¿è‡ªLayoutGroupï¼Œæ˜¯HorizontalLayoutGroupå’ŒVerticalLayoutGroupçš„çˆ¶ç±»ï¼Œæä¾›äº†ä¸€äº›HorizontalLayoutGroupå’ŒVerticalLayoutGroupé€šç”¨çš„æ–¹æ³•ã€‚</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>spacingï¼šå¸ƒå±€ç»„ä¸­å¸ƒå±€å…ƒç´ ä¹‹é—´ä½¿ç”¨çš„é—´è·ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> <span class="built_in">float</span> m_Spacing = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">float</span> spacing &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_Spacing; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_Spacing, <span class="keyword">value</span>); &#125; &#125;</span><br></pre></td></tr></table></figure><blockquote><p>childForceExpandWidthï¼šæ˜¯å¦å¼ºè¿«å­©å­ä»¬æ‰©å±•ä»¥å¡«å……é¢å¤–çš„å¯ç”¨æ°´å¹³ç©ºé—´ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> <span class="built_in">bool</span> m_ChildForceExpandWidth = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">bool</span> childForceExpandWidth &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_ChildForceExpandWidth; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_ChildForceExpandWidth, <span class="keyword">value</span>); &#125; &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>childForceExpandHeightï¼šæ˜¯å¦å¼ºè¿«å­©å­ä»¬æ‰©å±•ä»¥å¡«å……é¢å¤–çš„å¯ç”¨å‚ç›´ç©ºé—´ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> <span class="built_in">bool</span> m_ChildForceExpandHeight = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">bool</span> childForceExpandHeight &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_ChildForceExpandHeight; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_ChildForceExpandHeight, <span class="keyword">value</span>); &#125; &#125;</span><br></pre></td></tr></table></figure><blockquote><p>childControlWidthï¼šå¦‚æœå¸ƒå±€ç»„æ§åˆ¶å…¶å­å…ƒç´ çš„å®½åº¦åˆ™è¿”å›trueã€‚å¦‚æœå­èŠ‚ç‚¹æ§åˆ¶è‡ªå·±çš„å®½åº¦ï¼Œåˆ™è¿”å›falseã€‚</p><p>å¦‚æœè®¾ç½®ä¸ºfalseï¼Œå¸ƒå±€ç»„å°†åªå½±å“å­å…ƒç´ çš„ä½ç½®è€Œä¸å½±å“å®½åº¦ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå­å…ƒç´ çš„å®½åº¦å¯ä»¥é€šè¿‡å„è‡ªçš„RectTransformsæ¥è®¾ç½®ã€‚</p><p>å¦‚æœè®¾ç½®ä¸ºtrueï¼Œå­å…ƒç´ çš„å®½åº¦å°†ç”±å¸ƒå±€ç»„æ ¹æ®å®ƒä»¬å„è‡ªçš„æœ€å°å®½åº¦ã€é¦–é€‰å®½åº¦å’Œçµæ´»å®½åº¦è‡ªåŠ¨é©±åŠ¨ã€‚å¦‚æœå­èŠ‚ç‚¹çš„å®½åº¦åº”è¯¥æ ¹æ®å¯ç”¨ç©ºé—´çš„å¤§å°è€Œå˜åŒ–ï¼Œè¿™æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸èƒ½åœ¨RectTransformä¸­æ‰‹åŠ¨è®¾ç½®æ¯ä¸ªå­å…ƒç´ çš„å®½åº¦ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å‘å…¶æ·»åŠ LayoutElementç»„ä»¶æ¥æ§åˆ¶æ¯ä¸ªå­å…ƒç´ çš„æœ€å°ã€é¦–é€‰å’Œçµæ´»å®½åº¦ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> <span class="built_in">bool</span> m_ChildControlWidth = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">bool</span> childControlWidth &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_ChildControlWidth; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_ChildControlWidth, <span class="keyword">value</span>); &#125; &#125;</span><br></pre></td></tr></table></figure><blockquote><p>childControlHeightï¼šå¦‚æœLayout Groupæ§åˆ¶å…¶å­å…ƒç´ çš„é«˜åº¦ï¼Œåˆ™è¿”å›trueã€‚å¦‚æœå­©å­æ§åˆ¶è‡ªå·±çš„é«˜åº¦è¿”å›falseã€‚</p><p>å¦‚æœè®¾ç½®ä¸ºfalseï¼Œå¸ƒå±€ç»„å°†åªå½±å“å­å…ƒç´ çš„ä½ç½®è€Œä¸å½±å“é«˜åº¦ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå­å…ƒç´ çš„é«˜åº¦å¯ä»¥é€šè¿‡å„è‡ªçš„RectTransformsæ¥è®¾ç½®ã€‚</p><p>å¦‚æœè®¾ç½®ä¸ºtrueï¼Œå­å…ƒç´ çš„é«˜åº¦ç”±å¸ƒå±€ç»„æ ¹æ®å®ƒä»¬å„è‡ªçš„æœ€å°é«˜åº¦ã€é¦–é€‰é«˜åº¦å’Œçµæ´»é«˜åº¦è‡ªåŠ¨é©±åŠ¨ã€‚å¦‚æœå­©å­çš„é«˜åº¦åº”è¯¥æ ¹æ®å¯ç”¨ç©ºé—´çš„å¤§å°è€Œå˜åŒ–ï¼Œè¿™æ˜¯æœ‰ç”¨çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸èƒ½åœ¨RectTransformä¸­æ‰‹åŠ¨è®¾ç½®æ¯ä¸ªå­å…ƒç´ çš„é«˜åº¦ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å‘å…¶æ·»åŠ LayoutElementç»„ä»¶æ¥æ§åˆ¶æ¯ä¸ªå­å…ƒç´ çš„æœ€å°ã€é¦–é€‰å’Œçµæ´»é«˜åº¦ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> <span class="built_in">bool</span> m_ChildControlHeight = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">bool</span> childControlHeight &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_ChildControlHeight; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_ChildControlHeight, <span class="keyword">value</span>); &#125; &#125;</span><br></pre></td></tr></table></figure><blockquote><p>m_ChildScaleWidthï¼šå­©å­çš„å®½åº¦æ˜¯å¦æŒ‰xå°ºåº¦ç¼©æ”¾ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> <span class="built_in">bool</span> m_ChildScaleWidth = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">bool</span> childScaleWidth &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_ChildScaleWidth; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_ChildScaleWidth, <span class="keyword">value</span>); &#125; &#125;</span><br></pre></td></tr></table></figure><blockquote><p>childScaleHeightï¼šå­©å­çš„é«˜åº¦æ˜¯å¦æŒ‰yå°ºåº¦ç¼©æ”¾ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> <span class="built_in">bool</span> m_ChildScaleHeight = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">bool</span> childScaleHeight &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_ChildScaleHeight; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_ChildScaleHeight, <span class="keyword">value</span>); &#125; &#125;</span><br></pre></td></tr></table></figure><blockquote><p>CalcAlongAxisï¼šè®¡ç®—è¯¥å¸ƒå±€å…ƒç´ æ²¿ç»™å®šè½´çš„å¸ƒå±€å…ƒç´ å±æ€§ã€‚0è¡¨ç¤ºæ°´å¹³ï¼Œ1è¡¨ç¤ºå‚ç›´ã€‚è¿™ä¸ªç»„æ˜¯å¦æ˜¯å‚ç›´ç»„ã€‚è®¡ç®—minWidthã€preferredWidthã€flexibleWidthã€minHeightã€preferredHeightã€flexibleHeightå±æ€§å€¼ï¼Œå¹¶é€šè¿‡çˆ¶ç±»LayoutGroupä¸­çš„SetLayoutInputForAxisæ–¹æ³•è®¾ç½®å±æ€§å€¼</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—minWidthã€preferredWidthã€flexibleWidthã€minHeightã€preferredHeightã€flexibleHeightå±æ€§å€¼ï¼Œå¹¶é€šè¿‡çˆ¶ç±»LayoutGroupä¸­çš„SetLayoutInputForAxisæ–¹æ³•è®¾ç½®å±æ€§å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">CalcAlongAxis</span>(<span class="params"><span class="built_in">int</span> axis, <span class="built_in">bool</span> isVertical</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è®¡ç®—å­å…ƒç´ å¸ƒå±€æ—¶æ‰€è€ƒè™‘çš„è¾¹è·æ€»å’Œï¼Œå–å†³äºæ˜¯æ°´å¹³è¿˜æ˜¯å‚ç›´å¸ƒå±€</span></span><br><span class="line">    <span class="built_in">float</span> combinedPadding = (axis == <span class="number">0</span> ? padding.horizontal : padding.vertical);</span><br><span class="line">    <span class="comment">// æ˜¯å¦æ§åˆ¶å­å…ƒç´ çš„å°ºå¯¸</span></span><br><span class="line">    <span class="built_in">bool</span> controlSize = (axis == <span class="number">0</span> ? m_ChildControlWidth : m_ChildControlHeight);</span><br><span class="line">    <span class="comment">// æ˜¯å¦ä½¿ç”¨ç¼©æ”¾æ¥è°ƒæ•´å­å…ƒç´ çš„å°ºå¯¸</span></span><br><span class="line">    <span class="built_in">bool</span> useScale = (axis == <span class="number">0</span> ? m_ChildScaleWidth : m_ChildScaleHeight);</span><br><span class="line">    <span class="comment">// å­å…ƒç´ æ˜¯å¦å¼ºåˆ¶æ‰©å±•å°ºå¯¸</span></span><br><span class="line">    <span class="built_in">bool</span> childForceExpandSize = (axis == <span class="number">0</span> ? m_ChildForceExpandWidth : m_ChildForceExpandHeight);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸ºé›¶ï¼Œåˆ†åˆ«ç”¨äºç´¯ç§¯æœ€å°å°ºå¯¸ã€é¦–é€‰å°ºå¯¸å’Œçµæ´»å°ºå¯¸</span></span><br><span class="line">    <span class="built_in">float</span> totalMin = combinedPadding;</span><br><span class="line">    <span class="built_in">float</span> totalPreferred = combinedPadding;</span><br><span class="line">    <span class="built_in">float</span> totalFlexible = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ï¼ˆè¡¨ç¤ºæ˜¯å¦æ²¿å¦ä¸€è½´ï¼‰æ¥ç´¯ç§¯æ€»çš„æœ€å°å°ºå¯¸ã€é¦–é€‰å°ºå¯¸å’Œçµæ´»å°ºå¯¸ã€‚å¦‚æœä¸æ˜¯æ²¿å¦ä¸€è½´ï¼Œè¿˜ä¼šå¢åŠ é—´è· spacingã€‚</span></span><br><span class="line">    <span class="built_in">bool</span> alongOtherAxis = (isVertical ^ (axis == <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; rectChildren.Count; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        RectTransform child = rectChildren[i];</span><br><span class="line">        <span class="built_in">float</span> min, preferred, flexible;</span><br><span class="line">        GetChildSizes(child, axis, controlSize, childForceExpandSize, <span class="keyword">out</span> min, <span class="keyword">out</span> preferred, <span class="keyword">out</span> flexible);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ ¹æ®å­å…ƒç´ åœ¨è¯¥è½´ä¸Šçš„ç¼©æ”¾å› å­è°ƒæ•´å°ºå¯¸</span></span><br><span class="line">        <span class="keyword">if</span> (useScale)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">float</span> scaleFactor = child.localScale[axis];</span><br><span class="line">            min *= scaleFactor;</span><br><span class="line">            preferred *= scaleFactor;</span><br><span class="line">            flexible *= scaleFactor;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (alongOtherAxis)</span><br><span class="line">        &#123;</span><br><span class="line">            totalMin = Mathf.Max(min + combinedPadding, totalMin);</span><br><span class="line">            totalPreferred = Mathf.Max(preferred + combinedPadding, totalPreferred);</span><br><span class="line">            totalFlexible = Mathf.Max(flexible, totalFlexible);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            totalMin += min + spacing;</span><br><span class="line">            totalPreferred += preferred + spacing;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Increment flexible size with element&#x27;s flexible size.</span></span><br><span class="line">            totalFlexible += flexible;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!alongOtherAxis &amp;&amp; rectChildren.Count &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        totalMin -= spacing;</span><br><span class="line">        totalPreferred -= spacing;</span><br><span class="line">    &#125;</span><br><span class="line">    totalPreferred = Mathf.Max(totalMin, totalPreferred);</span><br><span class="line">    SetLayoutInputForAxis(totalMin, totalPreferred, totalFlexible, axis);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetChildSizesï¼šè®¡ç®—å­å¯¹è±¡åœ¨å¸ƒå±€ç»„ä»¶ä¸­çš„å°ºå¯¸å¤§å°ï¼Œä¸»è¦ç”¨äºUIå¸ƒå±€ç³»ç»Ÿï¼Œæ¯”å¦‚Unityä¸­çš„UIå¸ƒå±€ç»„ä»¶ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¡¨ç¤ºè¦è®¡ç®—å°ºå¯¸çš„å­å¯¹è±¡çš„RectTransformç»„ä»¶</span></span><br><span class="line"><span class="comment">// è¡¨ç¤ºè®¡ç®—å°ºå¯¸çš„è½´å‘ï¼ˆé€šå¸¸æ˜¯æ°´å¹³è½´æˆ–å‚ç›´è½´ï¼Œç”¨0å’Œ1è¡¨ç¤ºï¼‰</span></span><br><span class="line"><span class="comment">// ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦åº”è¯¥æ§åˆ¶å­å¯¹è±¡çš„å°ºå¯¸ã€‚å¦‚æœä¸ºfalseï¼Œå­å¯¹è±¡çš„æœ€å°å°ºå¯¸ã€é¦–é€‰å°ºå¯¸å’Œçµæ´»å°ºå¯¸å°†ç›´æ¥ä»å­å¯¹è±¡çš„sizeDeltaä¸­è·å–ï¼›å¦‚æœä¸ºtrueï¼Œå°†é€šè¿‡LayoutUtilityæ¥è·å–è¿™äº›å°ºå¯¸</span></span><br><span class="line"><span class="comment">// ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å¼ºåˆ¶æ‰©å±•å­å¯¹è±¡çš„çµæ´»å°ºå¯¸</span></span><br><span class="line"><span class="comment">// min: è¾“å‡ºå‚æ•°ï¼Œè¡¨ç¤ºå­å¯¹è±¡åœ¨æŒ‡å®šè½´å‘ä¸Šçš„æœ€å°å°ºå¯¸ã€‚</span></span><br><span class="line"><span class="comment">// preferred: è¾“å‡ºå‚æ•°ï¼Œè¡¨ç¤ºå­å¯¹è±¡åœ¨æŒ‡å®šè½´å‘ä¸Šçš„é¦–é€‰å°ºå¯¸ã€‚</span></span><br><span class="line"><span class="comment">// flexible: è¾“å‡ºå‚æ•°ï¼Œè¡¨ç¤ºå­å¯¹è±¡åœ¨æŒ‡å®šè½´å‘ä¸Šçš„çµæ´»å°ºå¯¸ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">GetChildSizes</span>(<span class="params">RectTransform child, <span class="built_in">int</span> axis, <span class="built_in">bool</span> controlSize, <span class="built_in">bool</span> childForceExpand,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">out</span> <span class="built_in">float</span> min, <span class="keyword">out</span> <span class="built_in">float</span> preferred, <span class="keyword">out</span> <span class="built_in">float</span> flexible</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!controlSize)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨å­å¯¹è±¡çš„ sizeDelta[axis] ä½œä¸ºæœ€å°å°ºå¯¸ï¼ˆminï¼‰ã€é¦–é€‰å°ºå¯¸ï¼ˆpreferredï¼‰ï¼Œå¹¶å°†çµæ´»å°ºå¯¸ï¼ˆflexibleï¼‰è®¾ä¸º 0</span></span><br><span class="line">        min = child.sizeDelta[axis];</span><br><span class="line">        preferred = min;</span><br><span class="line">        flexible = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ LayoutUtility ç±»çš„é™æ€æ–¹æ³•æ¥è·å–å­å¯¹è±¡åœ¨æŒ‡å®šè½´å‘ä¸Šçš„æœ€å°å°ºå¯¸ã€é¦–é€‰å°ºå¯¸å’Œçµæ´»å°ºå¯¸</span></span><br><span class="line">        min = LayoutUtility.GetMinSize(child, axis);</span><br><span class="line">        preferred = LayoutUtility.GetPreferredSize(child, axis);</span><br><span class="line">        flexible = LayoutUtility.GetFlexibleSize(child, axis);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (childForceExpand)</span><br><span class="line">        flexible = Mathf.Max(flexible, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetChildrenAlongAxisï¼šä¸ºç»™å®šè½´è®¾ç½®å­å¸ƒå±€å…ƒç´ çš„ä½ç½®å’Œå¤§å°ã€‚0è¡¨ç¤ºæ°´å¹³ï¼Œ1è¡¨ç¤ºå‚ç›´ã€‚æ˜¯å¦æ˜¯å‚ç›´ç»„ã€‚è®¡ç®—å­ç‰©ä½“çš„ä½ç½®å’Œå¤§å°ï¼Œå¹¶é€šè¿‡çˆ¶ç±»LayoutGroupä¸­çš„SetChildAlongAxisWithScaleæ–¹æ³•è®¾ç½®ä½ç½®å’Œå¤§å°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">SetChildrenAlongAxis</span>(<span class="params"><span class="built_in">int</span> axis, <span class="built_in">bool</span> isVertical</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è·å–å¸ƒå±€ç»„ä»¶åœ¨å½“å‰è½´å‘ä¸Šçš„å°ºå¯¸å¤§å°</span></span><br><span class="line">    <span class="built_in">float</span> size = rectTransform.rect.size[axis];</span><br><span class="line">    <span class="comment">//  æ§åˆ¶å­å¯¹è±¡å°ºå¯¸ã€ä½¿ç”¨ç¼©æ”¾å› å­ã€å­å¯¹è±¡æ˜¯å¦å¼ºåˆ¶æ‰©å±•å°ºå¯¸çš„å¸ƒå°”å‚æ•°</span></span><br><span class="line">    <span class="built_in">bool</span> controlSize = (axis == <span class="number">0</span> ? m_ChildControlWidth : m_ChildControlHeight);</span><br><span class="line">    <span class="built_in">bool</span> useScale = (axis == <span class="number">0</span> ? m_ChildScaleWidth : m_ChildScaleHeight);</span><br><span class="line">    <span class="built_in">bool</span> childForceExpandSize = (axis == <span class="number">0</span> ? m_ChildForceExpandWidth : m_ChildForceExpandHeight);</span><br><span class="line">    <span class="comment">// è·å–å­å¯¹è±¡åœ¨å½“å‰è½´å‘ä¸Šçš„å¯¹é½æ–¹å¼</span></span><br><span class="line">    <span class="built_in">float</span> alignmentOnAxis = GetAlignmentOnAxis(axis);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">bool</span> alongOtherAxis = (isVertical ^ (axis == <span class="number">1</span>));</span><br><span class="line">    <span class="comment">// æ ¹æ®å½“å‰æ˜¯å¦å‚ç›´å¸ƒå±€ä»¥åŠè½´å‘æ¥å†³å®šæ˜¯æ²¿å¦ä¸€è½´å‘æ’åˆ—è¿˜æ˜¯å½“å‰è½´å‘æ’åˆ—</span></span><br><span class="line">    <span class="keyword">if</span> (alongOtherAxis)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è®¡ç®—æ²¿ç€å‚ç›´è½´æˆ–æ°´å¹³è½´å¦ä¸€æ–¹å‘çš„æ’åˆ—</span></span><br><span class="line">        <span class="built_in">float</span> innerSize = size - (axis == <span class="number">0</span> ? padding.horizontal : padding.vertical);</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; rectChildren.Count; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// åœ¨å‚ç›´å¸ƒå±€æ—¶ï¼Œè®¡ç®—å­å¯¹è±¡åœ¨æ°´å¹³è½´ä¸Šçš„æ’åˆ—ï¼šæ ¹æ®å­å¯¹è±¡çš„å°ºå¯¸ã€ç¼©æ”¾å› å­å’Œå¯¹é½æ–¹å¼ï¼Œè®¾ç½®å…¶ä½ç½®</span></span><br><span class="line">            RectTransform child = rectChildren[i];</span><br><span class="line">            <span class="built_in">float</span> min, preferred, flexible;</span><br><span class="line">            GetChildSizes(child, axis, controlSize, childForceExpandSize, <span class="keyword">out</span> min, <span class="keyword">out</span> preferred, <span class="keyword">out</span> flexible);</span><br><span class="line">            <span class="built_in">float</span> scaleFactor = useScale ? child.localScale[axis] : <span class="number">1f</span>;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">float</span> requiredSpace = Mathf.Clamp(innerSize, min, flexible &gt; <span class="number">0</span> ? size : preferred);</span><br><span class="line">            <span class="built_in">float</span> startOffset = GetStartOffset(axis, requiredSpace * scaleFactor);</span><br><span class="line">            <span class="keyword">if</span> (controlSize)</span><br><span class="line">            &#123;</span><br><span class="line">                SetChildAlongAxisWithScale(child, axis, startOffset, requiredSpace, scaleFactor);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">float</span> offsetInCell = (requiredSpace - child.sizeDelta[axis]) * alignmentOnAxis;</span><br><span class="line">                SetChildAlongAxisWithScale(child, axis, startOffset + offsetInCell, scaleFactor);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è®¡ç®—æ²¿ç€å½“å‰è½´å‘çš„æ’åˆ—</span></span><br><span class="line">        <span class="comment">// è®¡ç®—å‰©ä½™ç©ºé—´å’Œçµæ´»å°ºå¯¸æ¥ç¡®å®šå­å¯¹è±¡çš„ä½ç½®å’Œå°ºå¯¸</span></span><br><span class="line">        <span class="built_in">float</span> pos = (axis == <span class="number">0</span> ? padding.left : padding.top);</span><br><span class="line">        <span class="built_in">float</span> itemFlexibleMultiplier = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">float</span> surplusSpace = size - GetTotalPreferredSize(axis);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (surplusSpace &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (GetTotalFlexibleSize(axis) == <span class="number">0</span>)</span><br><span class="line">                pos = GetStartOffset(axis, GetTotalPreferredSize(axis) - (axis == <span class="number">0</span> ? padding.horizontal : padding.vertical));</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (GetTotalFlexibleSize(axis) &gt; <span class="number">0</span>)</span><br><span class="line">                itemFlexibleMultiplier = surplusSpace / GetTotalFlexibleSize(axis);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">float</span> minMaxLerp = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (GetTotalMinSize(axis) != GetTotalPreferredSize(axis))</span><br><span class="line">            minMaxLerp = Mathf.Clamp01((size - GetTotalMinSize(axis)) / (GetTotalPreferredSize(axis) - GetTotalMinSize(axis)));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; rectChildren.Count; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            RectTransform child = rectChildren[i];</span><br><span class="line">            <span class="built_in">float</span> min, preferred, flexible;</span><br><span class="line">            GetChildSizes(child, axis, controlSize, childForceExpandSize, <span class="keyword">out</span> min, <span class="keyword">out</span> preferred, <span class="keyword">out</span> flexible);</span><br><span class="line">            <span class="built_in">float</span> scaleFactor = useScale ? child.localScale[axis] : <span class="number">1f</span>;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">float</span> childSize = Mathf.Lerp(min, preferred, minMaxLerp);</span><br><span class="line">            childSize += flexible * itemFlexibleMultiplier;</span><br><span class="line">            <span class="keyword">if</span> (controlSize)</span><br><span class="line">            &#123;</span><br><span class="line">                SetChildAlongAxisWithScale(child, axis, pos, childSize, scaleFactor);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">float</span> offsetInCell = (childSize - child.sizeDelta[axis]) * alignmentOnAxis;</span><br><span class="line">                SetChildAlongAxisWithScale(child, axis, pos + offsetInCell, scaleFactor);</span><br><span class="line">            &#125;</span><br><span class="line">            pos += childSize * scaleFactor + spacing;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">HorizontalOrVerticalLayoutGroupï¼šç»§æ‰¿è‡ªLayoutGroupï¼Œæ˜¯HorizontalLayoutGroupå’ŒVerticalLayoutGroupçš„çˆ¶ç±»ï¼Œæä¾›äº†ä¸€äº›HorizontalLayoutGroupå’ŒVerticalLayoutGroupé€šç”¨çš„æ–¹æ³•ã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”LayoutGroup</title>
    <link href="https://azzurebubble.github.io/posts/51e1a8f9.html"/>
    <id>https://azzurebubble.github.io/posts/51e1a8f9.html</id>
    <published>2024-07-20T07:32:34.000Z</published>
    <updated>2024-07-20T09:05:24.053Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>LayoutGroupï¼šLayoutGroupæ˜¯æ§åˆ¶å­å¸ƒå±€å¯¹è±¡ç»„ä»¶çš„åŸºç±»ï¼Œå®ç°äº†ILayoutElementå’ŒILayoutGroupæ¥å£ï¼Œç»§æ‰¿è‡ªUIBehaviourï¼Œè¯´æ˜å®ƒæ—¢æ˜¯ä¸€ä¸ªå¸ƒå±€å…ƒç´ ä¹Ÿæ˜¯ä¸€ä¸ªå¸ƒå±€æ§åˆ¶å™¨ï¼ŒHorizontalLayoutGroupã€VerticalLayoutGroupã€GridLayoutGroupéƒ½ç»§æ‰¿æˆ–é—´æ¥ç»§æ‰¿äº†æ­¤ç±»ã€‚</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><h5 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h5><blockquote><p>[DisallowMultipleComponent]ï¼šä¸å…è®¸ç»„ä»¶å¯¹è±¡æŒ‚è½½é‡å¤çš„è¿™ä¸ªè„šæœ¬ã€‚</p><p>[ExecuteAlways]ï¼šç¡®ä¿è„šæœ¬åœ¨ç¼–è¾‘å™¨å’Œæ¸¸æˆè¿è¡Œæ—¶éƒ½èƒ½è¢«æ‰§è¡Œã€‚</p><p>[RequireComponent(typeof(RectTransform))]ï¼šç¡®ä¿ç»„ä»¶å¯¹è±¡æŒ‚è½½äº†RectTransformç»„ä»¶ã€‚</p></blockquote><h5 id="å†…éƒ¨å®ç°"><a href="#å†…éƒ¨å®ç°" class="headerlink" title="å†…éƒ¨å®ç°"></a>å†…éƒ¨å®ç°</h5><blockquote><p>m_Paddingï¼šå¯ä»¥åœ¨Unityçš„Inspectorçª—å£ä¸­ç›´è§‚çš„è°ƒæ•´å’Œé…ç½®è¿™ä¸ªçŸ©å½¢åŒºåŸŸçš„è¾¹è·åç§»é‡ï¼Œè€Œæ— éœ€é€šè¿‡ä»£ç è¿›è¡Œç¡¬ç¼–ç ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RectOffset ç±»å‹ç”¨äºå®šä¹‰çŸ©å½¢åŒºåŸŸçš„åç§»é‡ã€‚å®ƒé€šå¸¸ç”¨äº UI å¸ƒå±€ä¸­ï¼Œä¾‹å¦‚åœ¨å®ç°è¾¹è·ï¼ˆpaddingï¼‰æˆ–è€…è¾¹æ¡†ï¼ˆborderï¼‰æ—¶éå¸¸æœ‰ç”¨ã€‚</span></span><br><span class="line"><span class="keyword">protected</span> RectOffset m_Padding = <span class="keyword">new</span> RectOffset();</span><br><span class="line"><span class="comment">// æ§åˆ¶å­å¸ƒå±€å…ƒç´ å‘¨å›´çš„è¾¹è·åç§»é‡ã€‚</span></span><br><span class="line"><span class="keyword">public</span> RectOffset padding &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_Padding; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_Padding, <span class="keyword">value</span>);</span><br></pre></td></tr></table></figure><blockquote><p>SetPropertyï¼šå¸®åŠ©å™¨æ–¹æ³•ï¼Œç”¨äºåœ¨ç»™å®šå±æ€§å‘ç”Ÿæ›´æ”¹æ—¶è®¾ç½®è¯¥å±æ€§ã€‚</p><p>è¿™æ˜¯ç±»ä¼¼MVVMæ¨¡å¼ä¸­çš„ä½¿ç”¨æ–¹æ³•</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">SetProperty</span>&lt;<span class="title">T</span>&gt;(<span class="params"><span class="keyword">ref</span> T currentValue, T newValue</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ((currentValue == <span class="literal">null</span> &amp;&amp; newValue == <span class="literal">null</span>) || (currentValue != <span class="literal">null</span> &amp;&amp; currentValue.Equals(newValue)))</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    currentValue = newValue;</span><br><span class="line">    SetDirty();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetDirtyï¼šæ ‡è®°LayoutGroupä¸ºDirtyï¼Œæ ‡è®°å½“å‰å¯¹è±¡çš„å¸ƒå±€æ˜¯å¦éœ€è¦é‡æ–°æ„å»ºï¼Œå¦‚æœæ˜¯å¤±æ´»çŠ¶æ€å°†ä¸ä¼šè¢«æ ‡è®°ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">SetDirty</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å¤±æ´»çŠ¶æ€åˆ™ä¸æ ‡è®°</span></span><br><span class="line">    <span class="keyword">if</span> (!IsActive())</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å½“å‰ä¸åœ¨è¿›è¡Œå¸ƒå±€é‡å»ºä¸­åˆ™é€šè¿‡LayoutRebuilder.MarkLayoutForRebuildæ¥æ ‡è®°å½“å‰å¯¹è±¡çš„å¸ƒå±€éœ€è¦é‡æ–°æ„å»º</span></span><br><span class="line">    <span class="keyword">if</span> (!CanvasUpdateRegistry.IsRebuildingLayout())</span><br><span class="line">        LayoutRebuilder.MarkLayoutForRebuild(rectTransform);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">// å¦åˆ™å¯åŠ¨ä¸€ä¸ªåç¨‹DelayedSetDirtyï¼Œå»¶è¿Ÿæ ‡è®°æ­¤å¯¹è±¡å¸ƒå±€éœ€è¦é‡æ–°æ„å»º</span></span><br><span class="line">        StartCoroutine(DelayedSetDirty(rectTransform));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åç¨‹DelayedSetDirty:ç­‰å¾…ä¸€å¸§ä¹‹åå†é€šè¿‡LayoutRebuilder.MarkLayoutForRebuildæ¥æ ‡è®°å½“å‰å¯¹è±¡çš„å¸ƒå±€éœ€è¦é‡æ–°æ„å»ºã€‚å¯ä»¥ä½¿ç”¨LayoutRebuilder.ForceRebuildLayoutImmediate(rectTransform)æ–¹æ³•å¼ºåˆ¶æ›´æ–°å¸ƒå±€ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">IEnumerator <span class="title">DelayedSetDirty</span>(<span class="params">RectTransform rectTransform</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    LayoutRebuilder.MarkLayoutForRebuild(rectTransform);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>å­å¸ƒå±€å…ƒç´ çš„å¯¹é½æ–¹å¼</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">SerializeField</span>] <span class="keyword">protected</span> TextAnchor m_ChildAlignment = TextAnchor.UpperLeft;</span><br><span class="line"><span class="comment">// å¸ƒå±€ç»„ä¸­å­å¸ƒå±€å…ƒç´ çš„å¯¹é½æ–¹å¼ã€‚é»˜è®¤æ˜¯å·¦ä¸Šè§’å¯¹é½ã€‚</span></span><br><span class="line"><span class="keyword">public</span> TextAnchor childAlignment &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_ChildAlignment; &#125; <span class="keyword">set</span> &#123; SetProperty(<span class="keyword">ref</span> m_ChildAlignment, <span class="keyword">value</span>); &#125; &#125;</span><br></pre></td></tr></table></figure><blockquote><p>è·å–æ­¤å¸ƒå±€å…ƒç´ çš„RectTransformç»„ä»¶</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">System.NonSerialized</span>] <span class="keyword">private</span> RectTransform m_Rect;</span><br><span class="line"><span class="keyword">protected</span> RectTransform rectTransform</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (m_Rect == <span class="literal">null</span>)</span><br><span class="line">            m_Rect = GetComponent&lt;RectTransform&gt;();</span><br><span class="line">        <span class="keyword">return</span> m_Rect;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å­˜å‚¨å¸ƒå±€ç»„ä¸­æ‰€æœ‰çš„å­å¸ƒå±€å…ƒç´ </p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">System.NonSerialized</span>] <span class="keyword">private</span> List&lt;RectTransform&gt; m_RectChildren = <span class="keyword">new</span> List&lt;RectTransform&gt;();</span><br><span class="line"><span class="keyword">protected</span> List&lt;RectTransform&gt; rectChildren &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_RectChildren; &#125; &#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸€äº›å…¶ä»–å±æ€§å’Œå­—æ®µ</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DrivenRectTransformTracker æ˜¯ Unity æä¾›çš„ä¸€ä¸ªç”¨äºè·Ÿè¸ª RectTransform å°ºå¯¸å’Œä½ç½®çš„å·¥å…·ç±»ã€‚ç¡®ä¿å¸ƒå±€å¯ä»¥åœ¨å°ºå¯¸æˆ–ä½ç½®å˜åŒ–æ—¶å¾—åˆ°æ›´æ–°ã€‚</span></span><br><span class="line"><span class="keyword">protected</span> DrivenRectTransformTracker m_Tracker;</span><br><span class="line"><span class="comment">// m_TotalMinSize ç”¨æ¥è®°å½•å½“å‰å¸ƒå±€æ‰€éœ€çš„æœ€å°å°ºå¯¸ã€‚åˆå§‹å€¼è®¾ä¸º Vector2.zeroï¼Œå³æ²¡æœ‰æœ€å°å°ºå¯¸è¦æ±‚ã€‚</span></span><br><span class="line"><span class="keyword">private</span> Vector2 m_TotalMinSize = Vector2.zero;</span><br><span class="line"><span class="comment">// m_TotalPreferredSize ç”¨æ¥è®°å½•å½“å‰å¸ƒå±€æ‰€éœ€çš„é¦–é€‰å°ºå¯¸ã€‚åˆå§‹ä¸º Vector2.zeroï¼Œå³æ²¡æœ‰é¦–é€‰å°ºå¯¸è¦æ±‚ã€‚</span></span><br><span class="line"><span class="keyword">private</span> Vector2 m_TotalPreferredSize = Vector2.zero;</span><br><span class="line"><span class="comment">// m_TotalFlexibleSize ç”¨æ¥è®°å½•å½“å‰å¸ƒå±€æ‰€éœ€çš„çµæ´»å°ºå¯¸ï¼ˆå³å¯å˜å°ºå¯¸ï¼‰ã€‚åˆå§‹å€¼è®¾ä¸º Vector2.zeroï¼Œè¡¨ç¤ºæ²¡æœ‰çµæ´»å°ºå¯¸çš„è¦æ±‚ã€‚</span></span><br><span class="line"><span class="keyword">private</span> Vector2 m_TotalFlexibleSize = Vector2.zero;</span><br></pre></td></tr></table></figure><blockquote><p>CalculateLayoutInputHorizontalï¼šå®ç°ILayoutElementä¸­çš„æ¥å£ï¼Œå­ç±»å¯é‡å†™</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">CalculateLayoutInputHorizontal</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ¸…ç©ºå½“å‰å­å¸ƒå±€å…ƒç´ å®¹å™¨</span></span><br><span class="line">    m_RectChildren.Clear();</span><br><span class="line">    <span class="comment">// ä½¿ç”¨å¯¹è±¡æ± è·å–ä¸€ä¸ªä¸´æ—¶çš„ListPool&lt;Component&gt;å®¹å™¨</span></span><br><span class="line">    <span class="keyword">var</span> toIgnoreList = ListPool&lt;Component&gt;.Get();</span><br><span class="line">    <span class="comment">// è¿‡æ»¤ä¸å‚ä¸å¸ƒå±€çš„å­å¸ƒå±€å…ƒç´ </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; rectTransform.childCount; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> rect = rectTransform.GetChild(i) <span class="keyword">as</span> RectTransform;</span><br><span class="line">        <span class="comment">// æ²¡æœ‰RectTransformç»„ä»¶å’Œåœ¨Hierarchyä¸­æ²¡æœ‰è¢«æ¿€æ´»åˆ™è·³è¿‡</span></span><br><span class="line">        <span class="keyword">if</span> (rect == <span class="literal">null</span> || !rect.gameObject.activeInHierarchy)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–é™„åŠ åœ¨å­å¸ƒå±€å…ƒç´ ç»„ä»¶çš„æ‰€æœ‰ILayoutIgnorerç»„ä»¶å¯¹è±¡</span></span><br><span class="line">        rect.GetComponents(<span class="keyword">typeof</span>(ILayoutIgnorer), toIgnoreList);</span><br><span class="line"><span class="comment">// å¦‚æœä¸ºç©ºï¼Œåˆ™ä»£è¡¨éœ€è¦å‚ä¸å¸ƒå±€</span></span><br><span class="line">        <span class="keyword">if</span> (toIgnoreList.Count == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            m_RectChildren.Add(rect);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åªè¦å­˜åœ¨ä¸€ä¸ªä¸ºfalseçš„ILayoutIgnorerç»„ä»¶ï¼Œåˆ™éœ€è¦å‚ä¸å¸ƒå±€</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; toIgnoreList.Count; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> ignorer = (ILayoutIgnorer)toIgnoreList[j];</span><br><span class="line">            <span class="keyword">if</span> (!ignorer.ignoreLayout)</span><br><span class="line">            &#123;</span><br><span class="line">                m_RectChildren.Add(rect);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é‡Šæ”¾toIgnoreListè¿”å›å¯¹è±¡æ± </span></span><br><span class="line">    ListPool&lt;Component&gt;.Release(toIgnoreList);</span><br><span class="line">    <span class="comment">// æ¸…ç©ºå¸ƒå±€è¿½è¸ªå™¨</span></span><br><span class="line">    m_Tracker.Clear();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æŠ½è±¡æ–¹æ³•CalculateLayoutInputVerticalè®¡ç®—å‚ç›´å¸ƒå±€è¾“å…¥ï¼Œå­ç±»å¿…é¡»å®ç°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">CalculateLayoutInputVertical</span>()</span>;</span><br></pre></td></tr></table></figure><blockquote><p>GetTotalMinSizeï¼šç”±å­ç±»è°ƒç”¨ç»™å®šè½´ä¸Šå¸ƒå±€ç»„çš„æœ€å°å¤§å°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è½´ç´¢å¼•ã€‚0è¡¨ç¤ºæ°´å¹³ï¼Œ1è¡¨ç¤ºå‚ç›´ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="built_in">float</span> <span class="title">GetTotalMinSize</span>(<span class="params"><span class="built_in">int</span> axis</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> m_TotalMinSize[axis];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetTotalPreferredSize</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// // è½´ç´¢å¼•ã€‚0è¡¨ç¤ºæ°´å¹³ï¼Œ1è¡¨ç¤ºå‚ç›´ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="built_in">float</span> <span class="title">GetTotalPreferredSize</span>(<span class="params"><span class="built_in">int</span> axis</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> m_TotalPreferredSize[axis];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetTotalFlexibleSizeï¼šç”±å­ç±»è°ƒç”¨ç»™å®šè½´ä¸Šå¸ƒå±€ç»„çš„çµæ´»å¤§å°ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// // è½´ç´¢å¼•ã€‚0è¡¨ç¤ºæ°´å¹³ï¼Œ1è¡¨ç¤ºå‚ç›´ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="built_in">float</span> <span class="title">GetTotalFlexibleSize</span>(<span class="params"><span class="built_in">int</span> axis</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> m_TotalFlexibleSize[axis];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ILayoutControllerä¸­çš„æ¥å£ï¼ŒæŠ½è±¡æ–¹æ³•ï¼Œå­ç±»å¿…é¡»å®ç°çš„å›è°ƒ</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">SetLayoutHorizontal</span>()</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">SetLayoutVertical</span>()</span>;</span><br></pre></td></tr></table></figure><blockquote><p>æ„é€ æ–¹æ³•</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="title">LayoutGroup</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_Padding == <span class="literal">null</span>)</span><br><span class="line">        m_Padding = <span class="keyword">new</span> RectOffset();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç”Ÿå‘½å‘¨æœŸOnEnableï¼šå¯ç”¨æ—¶ï¼Œæ ‡è®°ä¸ºéœ€è¦è¿›è¡Œå¸ƒå±€é‡å»º</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">base</span>.OnEnable();</span><br><span class="line">    SetDirty();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç”Ÿå‘½å‘¨æœŸOnDisableï¼šå¤±æ´»æ—¶ï¼Œæ¸…ç©ºå¸ƒå±€è¿½è¸ªå™¨ï¼Œå¼ºåˆ¶æ›´æ–°å¸ƒå±€</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnDisable</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    m_Tracker.Clear();</span><br><span class="line">    LayoutRebuilder.MarkLayoutForRebuild(rectTransform);</span><br><span class="line">    <span class="keyword">base</span>.OnDisable();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnDidApplyAnimationPropertiesï¼šå½“åŠ¨ç”»å±æ€§æ”¹å˜æ—¶ï¼Œæ ‡è®°ä¸ºéœ€è¦è¿›è¡Œå¸ƒå±€é‡å»º</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnDidApplyAnimationProperties</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">SetDirty();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnRectTransformDimensionsChangeï¼šå½“åŠ¨ç”»å±æ€§æ”¹å˜æ—¶ï¼Œæ ‡è®°ä¸ºéœ€è¦è¿›è¡Œå¸ƒå±€é‡å»º</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnDidApplyAnimationProperties</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">SetDirty();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetStartOffsetï¼šæ ¹æ®ç»™å®šè½´å’Œå¯¹é½æ–¹å¼è®¡ç®—ç¬¬ä¸€ä¸ªå­å¸ƒå±€å…ƒç´ èµ·å§‹åç§»åæ ‡ï¼Œç”±å­ç±»è°ƒç”¨ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è½´ç´¢å¼•ã€‚0è¡¨ç¤ºæ°´å¹³ï¼Œ1è¡¨ç¤ºå‚ç›´</span></span><br><span class="line"><span class="comment">// æ‰€æœ‰å¸ƒå±€å…ƒç´ åœ¨ç»™å®šè½´ä¸Šæ‰€éœ€çš„æ€»ç©ºé—´ï¼ŒåŒ…æ‹¬é—´è·å’Œä¸åŒ…æ‹¬å¡«å……ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="built_in">float</span> <span class="title">GetStartOffset</span>(<span class="params"><span class="built_in">int</span> axis, <span class="built_in">float</span> requiredSpaceWithoutPadding</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è®¡ç®—å®é™…éœ€è¦çš„ç©ºé—´å¤§å°ã€‚å®ƒç­‰äº requiredSpaceWithoutPadding åŠ ä¸Šè½´å‘ä¸Šçš„å¡«å……å€¼ï¼Œæ ¹æ® axis çš„å€¼æ¥å†³å®šä½¿ç”¨æ°´å¹³å¡«å……æˆ–å‚ç›´å¡«å……ã€‚</span></span><br><span class="line">    <span class="built_in">float</span> requiredSpace = requiredSpaceWithoutPadding + (axis == <span class="number">0</span> ? padding.horizontal : padding.vertical);</span><br><span class="line">    <span class="comment">// è·å–å½“å‰è½´ä¸Šå¯ç”¨çš„ç©ºé—´å¤§å°ï¼Œé€šè¿‡æŸ¥è¯¢ rectTransform.rect.size[axis] å¾—åˆ°ã€‚</span></span><br><span class="line">    <span class="built_in">float</span> availableSpace = rectTransform.rect.size[axis];</span><br><span class="line">    <span class="comment">// è®¡ç®—å‰©ä½™çš„ç©ºé—´å¤§å°ï¼Œå³ availableSpace å‡å» requiredSpaceã€‚</span></span><br><span class="line">    <span class="built_in">float</span> surplusSpace = availableSpace - requiredSpace;</span><br><span class="line">    <span class="comment">// è°ƒç”¨ GetAlignmentOnAxis(axis) æ–¹æ³•ï¼Œè·å–åœ¨å½“å‰è½´ä¸Šçš„å¯¹é½æ–¹å¼æˆ–æ¯”ä¾‹å› å­ã€‚</span></span><br><span class="line">    <span class="built_in">float</span> alignmentOnAxis = GetAlignmentOnAxis(axis);</span><br><span class="line">    <span class="comment">// å¦‚æœ axis æ˜¯ 0ï¼ˆæ°´å¹³è½´ï¼‰ï¼Œåˆ™è¿”å›æ°´å¹³å¡«å……çš„å·¦è¾¹è· padding.left åŠ ä¸Šå‰©ä½™ç©ºé—´ä¹˜ä»¥è½´å‘çš„å¯¹é½æ–¹å¼ã€‚</span></span><br><span class="line"><span class="comment">// å¦‚æœ axis æ˜¯ 1ï¼ˆå‚ç›´è½´ï¼‰ï¼Œåˆ™è¿”å›å‚ç›´å¡«å……çš„é¡¶è¾¹è· padding.top åŠ ä¸Šå‰©ä½™ç©ºé—´ä¹˜ä»¥è½´å‘çš„å¯¹é½æ–¹å¼ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> (axis == <span class="number">0</span> ? padding.left : padding.top) + surplusSpace * alignmentOnAxis;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GetAlignmentOnAxisï¼šä»¥åˆ†æ•°å½¢å¼è¿”å›æŒ‡å®šè½´ä¸Šçš„å¯¹é½æ–¹å¼ï¼Œå…¶ä¸­0ä¸ºå·¦/ä¸Šï¼Œ0.5ä¸ºä¸­ï¼Œ1ä¸ºå³/ä¸‹ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 0è¡¨ç¤ºæ°´å¹³ï¼Œ1è¡¨ç¤ºå‚ç›´</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="built_in">float</span> <span class="title">GetAlignmentOnAxis</span>(<span class="params"><span class="built_in">int</span> axis</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (axis == <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// æ°´å¹³è½´ï¼šå­å¸ƒå±€å…ƒç´ çš„å¯¹é½æ–¹å¼è¿›è¡Œæ¨¡3è¿ç®—ï¼Œå¾—åˆ°ä¸€ä¸ªèŒƒå›´åœ¨0~2ä¹‹é—´çš„æ•´æ•°ï¼Œè¿™ä¸ªå€¼ä¹˜ä»¥0.5f,å¾—åˆ°ä¸€ä¸ªåœ¨0.0f~1.0fä¹‹é—´çš„æµ®ç‚¹æ•°ä½œä¸ºæ°´å¹³å¯¹é½çš„æ¯”ä¾‹å› å­</span></span><br><span class="line">        <span class="keyword">return</span> ((<span class="built_in">int</span>)childAlignment % <span class="number">3</span>) * <span class="number">0.5f</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">// å‚ç›´è½´ï¼šå­å¸ƒå±€å…ƒç´ çš„å¯¹é½æ–¹å¼è¿›è¡Œé™¤3è¿ç®—ï¼Œå¾—åˆ°ä¸€ä¸ªèŒƒå›´åœ¨0~2ä¹‹é—´çš„æ•´æ•°ï¼Œè¿™ä¸ªå€¼ä¹˜ä»¥0.5f,å¾—åˆ°ä¸€ä¸ªåœ¨0.0f~1.0fä¹‹é—´çš„æµ®ç‚¹æ•°ä½œä¸ºå‚ç›´å¯¹é½çš„æ¯”ä¾‹å› å­</span></span><br><span class="line">        <span class="keyword">return</span> ((<span class="built_in">int</span>)childAlignment / <span class="number">3</span>) * <span class="number">0.5f</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetLayoutInputForAxisï¼šç”¨äºè®¾ç½®ç»™å®šè½´çš„è®¡ç®—å¸ƒå±€å±æ€§ã€‚ç”±å­ç±»è°ƒç”¨ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 0è¡¨ç¤ºæ°´å¹³ï¼Œ1è¡¨ç¤ºå‚ç›´ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">SetLayoutInputForAxis</span>(<span class="params"><span class="built_in">float</span> totalMin, <span class="built_in">float</span> totalPreferred, <span class="built_in">float</span> totalFlexible, <span class="built_in">int</span> axis</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    m_TotalMinSize[axis] = totalMin;</span><br><span class="line">    m_TotalPreferredSize[axis] = totalPreferred;</span><br><span class="line">    m_TotalFlexibleSize[axis] = totalFlexible;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetChildAlongAxisï¼šè®¾ç½®å­å¸ƒå±€å…ƒç´ æ²¿ç»™å®šè½´çš„ä½ç½®å’Œå¤§å°ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 0è¡¨ç¤ºæ°´å¹³ï¼Œ1è¡¨ç¤ºå‚ç›´ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">SetChildAlongAxis</span>(<span class="params">RectTransform rect, <span class="built_in">int</span> axis, <span class="built_in">float</span> pos</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (rect == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    SetChildAlongAxisWithScale(rect, axis, pos, <span class="number">1.0f</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetChildAlongAxisWithScaleï¼šè®¾ç½®å­å¸ƒå±€å…ƒç´ æ²¿ç»™å®šè½´çš„ä½ç½®å’Œå¤§å°ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 0è¡¨ç¤ºæ°´å¹³ï¼Œ1è¡¨ç¤ºå‚ç›´ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">SetChildAlongAxisWithScale</span>(<span class="params">RectTransform rect, <span class="built_in">int</span> axis, <span class="built_in">float</span> pos, <span class="built_in">float</span> scaleFactor</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (rect == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"><span class="comment">// è·Ÿè¸ªé”šç‚¹å’Œé”šå®šä½ç½®ï¼ˆAnchors å’Œ AnchoredPositionX æˆ– AnchoredPositionYï¼‰çš„å˜åŒ–</span></span><br><span class="line">    m_Tracker.Add(<span class="keyword">this</span>, rect,</span><br><span class="line">        DrivenTransformProperties.Anchors |</span><br><span class="line">        (axis == <span class="number">0</span> ? DrivenTransformProperties.AnchoredPositionX : DrivenTransformProperties.AnchoredPositionY));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å†…è”rect.SetInsetAndSizeFromParentEdge(â€¦)å’Œé‡æ„ä»£ç ï¼Œä»¥ä¹˜ä»¥æ‰€éœ€çš„å¤§å°scaleFactorã€‚</span></span><br><span class="line"><span class="comment">// sizeDeltaå¿…é¡»ä¿æŒä¸å˜ï¼Œä½†ä½ç½®è®¡ç®—ä¸­ä½¿ç”¨çš„å¤§å°å¿…é¡»é€šè¿‡scaleFactorè¿›è¡Œç¼©æ”¾ã€‚</span></span><br><span class="line"><span class="comment">// è®¾ç½®å­å…ƒç´ çš„ anchorMin å’Œ anchorMax ä¸º Vector2.upï¼Œå³å®Œå…¨æ²¿çˆ¶å…ƒç´ çš„é¡¶éƒ¨è¾¹ç¼˜å¯¹é½ã€‚</span></span><br><span class="line">    rect.anchorMin = Vector2.up;</span><br><span class="line">    rect.anchorMax = Vector2.up;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹äºæ°´å¹³è½´ï¼ˆaxis == 0ï¼‰ï¼šè®¡ç®—å…¬å¼ä¸º pos + rect.sizeDelta[axis] * rect.pivot[axis] * scaleFactorã€‚è¿™å°†æ ¹æ®ä½ç½® posã€å­å…ƒç´ çš„å°ºå¯¸ rect.sizeDelta[axis]ã€å­å…ƒç´ çš„ä¸­å¿ƒç‚¹ rect.pivot[axis] å’Œç¼©æ”¾å› å­ scaleFactor è®¾ç½®å­å…ƒç´ çš„ä½ç½®ã€‚</span></span><br><span class="line">    <span class="comment">// å¯¹äºå‚ç›´è½´ï¼ˆaxis == 1ï¼‰ï¼šè®¡ç®—å…¬å¼ä¸º -pos - rect.sizeDelta[axis] * (1f - rect.pivot[axis]) * scaleFactorã€‚è¿™åŒæ ·æ ¹æ®ä½ç½® posã€å­å…ƒç´ çš„å°ºå¯¸ rect.sizeDelta[axis]ã€å­å…ƒç´ çš„ä¸­å¿ƒç‚¹ rect.pivot[axis] å’Œç¼©æ”¾å› å­ scaleFactor è®¾ç½®å­å…ƒç´ çš„ä½ç½®ã€‚</span></span><br><span class="line">    Vector2 anchoredPosition = rect.anchoredPosition;</span><br><span class="line">    anchoredPosition[axis] = (axis == <span class="number">0</span>) ? (pos + rect.sizeDelta[axis] * rect.pivot[axis] * scaleFactor) : (-pos - rect.sizeDelta[axis] * (<span class="number">1f</span> - rect.pivot[axis]) * scaleFactor);</span><br><span class="line">    <span class="comment">// å°†è®¡ç®—å¾—åˆ°çš„ä½ç½®åº”ç”¨åˆ°å­å…ƒç´ çš„ anchoredPosition ä¸Šï¼Œç¡®ä¿å­å…ƒç´ æŒ‰é¢„æœŸä½ç½®æ”¾ç½®</span></span><br><span class="line">    rect.anchoredPosition = anchoredPosition;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetChildAlongAxisï¼šä¸Šé¢æ–¹æ³•çš„é‡è½½ï¼Œå¤šäº†ä¸€ä¸ªå‚æ•°sizeï¼Œå­å¸ƒå±€å…ƒç´ çš„å°ºå¯¸å¤§å°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">SetChildAlongAxis</span>(<span class="params">RectTransform rect, <span class="built_in">int</span> axis, <span class="built_in">float</span> pos, <span class="built_in">float</span> size</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (rect == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    SetChildAlongAxisWithScale(rect, axis, pos, size, <span class="number">1.0f</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SetChildAlongAxisWithScaleï¼šä¸Šé¢æ–¹æ³•çš„é‡è½½ï¼Œå¤šäº†ä¸€ä¸ªå‚æ•°sizeï¼Œå­å¸ƒå±€å…ƒç´ çš„å°ºå¯¸å¤§å°</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">SetChildAlongAxisWithScale</span>(<span class="params">RectTransform rect, <span class="built_in">int</span> axis, <span class="built_in">float</span> pos, <span class="built_in">float</span> size, <span class="built_in">float</span> scaleFactor</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (rect == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·Ÿè¸ªé”šç‚¹å’Œé”šå®šä½ç½®çš„å˜åŒ–ï¼Œä»¥åŠæ ¹æ®è½´çš„ä¸åŒè¿½è¸ª AnchoredPositionX æˆ– AnchoredPositionY å’Œå¯¹åº”çš„ SizeDeltaX æˆ– SizeDeltaYã€‚</span></span><br><span class="line">    m_Tracker.Add(<span class="keyword">this</span>, rect,</span><br><span class="line">        DrivenTransformProperties.Anchors |</span><br><span class="line">        (axis == <span class="number">0</span> ?</span><br><span class="line">            (DrivenTransformProperties.AnchoredPositionX | DrivenTransformProperties.SizeDeltaX) :</span><br><span class="line">            (DrivenTransformProperties.AnchoredPositionY | DrivenTransformProperties.SizeDeltaY)</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®å­å…ƒç´ çš„ anchorMin å’Œ anchorMax ä¸º Vector2.upï¼Œå³å®Œå…¨æ²¿çˆ¶å…ƒç´ çš„é¡¶éƒ¨è¾¹ç¼˜å¯¹é½</span></span><br><span class="line">    rect.anchorMin = Vector2.up;</span><br><span class="line">    rect.anchorMax = Vector2.up;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ›´æ–°å­å…ƒç´ çš„ sizeDeltaï¼Œå°†æŒ‡å®šè½´ä¸Šçš„å°ºå¯¸è®¾ç½®ä¸ºä¼ å…¥çš„ size å€¼ï¼Œç¡®ä¿å­å…ƒç´ åœ¨è¯¥è½´ä¸Šå…·æœ‰æ­£ç¡®çš„å¤§å°</span></span><br><span class="line">    Vector2 sizeDelta = rect.sizeDelta;</span><br><span class="line">    sizeDelta[axis] = size;</span><br><span class="line">    rect.sizeDelta = sizeDelta;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹äºæ°´å¹³è½´ï¼ˆaxis == 0ï¼‰ï¼šè®¡ç®—å…¬å¼ä¸º pos + size * rect.pivot[axis] * scaleFactorã€‚è¿™å°†æ ¹æ®ä½ç½® posã€å­å…ƒç´ çš„å°ºå¯¸ sizeã€å­å…ƒç´ çš„ä¸­å¿ƒç‚¹ rect.pivot[axis] å’Œç¼©æ”¾å› å­ scaleFactor è®¾ç½®å­å…ƒç´ çš„ä½ç½®ã€‚</span></span><br><span class="line">    <span class="comment">// å¯¹äºå‚ç›´è½´ï¼ˆaxis == 1ï¼‰ï¼šè®¡ç®—å…¬å¼ä¸º -pos - size * (1f - rect.pivot[axis]) * scaleFactorã€‚è¿™åŒæ ·æ ¹æ®ä½ç½® posã€å­å…ƒç´ çš„å°ºå¯¸ sizeã€å­å…ƒç´ çš„ä¸­å¿ƒç‚¹ rect.pivot[axis] å’Œç¼©æ”¾å› å­ scaleFactor è®¾ç½®å­å…ƒç´ çš„ä½ç½®ã€‚</span></span><br><span class="line">    Vector2 anchoredPosition = rect.anchoredPosition;</span><br><span class="line">    anchoredPosition[axis] = (axis == <span class="number">0</span>) ? (pos + size * rect.pivot[axis] * scaleFactor) : (-pos - size * (<span class="number">1f</span> - rect.pivot[axis]) * scaleFactor);</span><br><span class="line">    <span class="comment">// å°†è®¡ç®—å¾—åˆ°çš„ä½ç½®åº”ç”¨åˆ°å­å…ƒç´ çš„ anchoredPosition ä¸Šï¼Œç¡®ä¿å­å…ƒç´ æŒ‰é¢„æœŸä½ç½®æ”¾ç½®</span></span><br><span class="line">    rect.anchoredPosition = anchoredPosition;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>isRootLayoutGroupï¼šåˆ¤æ–­å½“å‰å¯¹è±¡æ˜¯å¦æ˜¯å¸ƒå±€ç»„çš„æ ¹å¸ƒå±€å¯¹è±¡ç»„ä»¶ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">bool</span> isRootLayoutGroup</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        Transform parent = transform.parent;</span><br><span class="line">        <span class="keyword">if</span> (parent == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> transform.parent.GetComponent(<span class="keyword">typeof</span>(ILayoutGroup)) == <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnRectTransformDimensionsChangeï¼šå¦‚æœå½“å‰å¯¹è±¡æ˜¯æ ¹å¸ƒå±€å¯¹è±¡ï¼Œä¸”RectTransformå‘ç”Ÿäº†å˜åŒ–ï¼Œåˆ™æ ‡è®°ä¸ºéœ€è¦è¿›è¡Œå¸ƒå±€é‡å»º</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnRectTransformDimensionsChange</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">base</span>.OnRectTransformDimensionsChange();</span><br><span class="line">    <span class="keyword">if</span> (isRootLayoutGroup)</span><br><span class="line">        SetDirty();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>OnTransformChildrenChangedï¼šå­å¸ƒå±€å…ƒç´ å¦‚æœçš„Transformå¦‚æœå‘ç”Ÿæ”¹å˜åˆ™æ ‡è®°ä¸ºéœ€è¦è¿›è¡Œå¸ƒå±€é‡å»º</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">OnTransformChildrenChanged</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    SetDirty();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ç¼–è¾‘å™¨æ¨¡å¼ä¸‹ï¼Œæ¯æ¬¡å¯¹è¯¥ç»„ä»¶çš„å±æ€§è¿›è¡Œä¿®æ”¹å¹¶ä¿å­˜æ—¶è‡ªåŠ¨è°ƒç”¨OnValidateæ–¹æ³•ï¼Œæ ‡è®°ä¸ºéœ€è¦è¿›è¡Œå¸ƒå±€é‡å»º</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> UNITY_EDITOR</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnValidate</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        SetDirty();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">LayoutGroupæ˜¯æ§åˆ¶å­å¸ƒå±€å¯¹è±¡ç»„ä»¶çš„åŸºç±»ï¼Œå®ç°äº†ILayoutElementå’ŒILayoutGroupæ¥å£ï¼Œè¯´æ˜å®ƒæ—¢æ˜¯ä¸€ä¸ªå¸ƒå±€å…ƒç´ ä¹Ÿæ˜¯ä¸€ä¸ªå¸ƒå±€æ§åˆ¶å™¨ï¼ŒHorizontalLayoutGroupã€VerticalLayoutGroupã€GridLayoutGroupéƒ½ç»§æ‰¿æˆ–é—´æ¥ç»§æ‰¿äº†æ­¤ç±»ã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”ILayoutIgnorer</title>
    <link href="https://azzurebubble.github.io/posts/4c1d55d0.html"/>
    <id>https://azzurebubble.github.io/posts/4c1d55d0.html</id>
    <published>2024-07-20T07:09:24.000Z</published>
    <updated>2024-07-20T09:05:24.054Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ILayoutIgnorerï¼šæŒ‚è½½äº†å®ç°ILayoutIgnoreræ¥å£çš„ç»„ä»¶çš„å¯¹è±¡å¯ä»¥è®¾ç½®ä¸å—å¸ƒå±€ç³»ç»Ÿæ§åˆ¶ï¼Œä¾‹å¦‚LayoutElementã€‚</p><font color=red>å®ç°ILayoutIgnoreræ¥å£çš„ç»„ä»¶çš„ä½œç”¨æ˜¯é’ˆå¯¹äºå¸ƒå±€ç»„ä¸‹çš„å­å¯¹è±¡ï¼Œè€Œä¸æ˜¯é’ˆå¯¹äºè‡ªèº«ï¼Œä¾‹å¦‚ç»™æŒ‚è½½äº†ContentSizeFitterç»„ä»¶çš„å¯¹è±¡èº«ä¸ŠæŒ‚è½½LayoutElementç»„ä»¶å¹¶å°†ignoreLayoutè®¾ç½®ä¸ºtrueæ˜¯æ²¡æœ‰ä½œç”¨çš„</font></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>ignoreLayoutï¼šè¿”å›è¿™ä¸ªå¸ƒå±€å…ƒç´ çš„RecTransformæ˜¯å¦åº”è¯¥è¢«å¸ƒå±€ç³»ç»Ÿå¿½ç•¥ã€‚</p><font color=red>æ³¨æ„ï¼šéœ€è¦å¯¹è±¡èº«ä¸Šæ‰€æœ‰æŒ‚è½½äº†ILayoutIgnorerç»„ä»¶ä¸­çš„ignoreLayoutéƒ½ä¸ºtrueçš„æ—¶å€™æ‰ä¼šä¸å—åˆ°å¸ƒå±€ç³»ç»Ÿæ§åˆ¶</font></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> ignoreLayout &#123; <span class="keyword">get</span>; &#125;</span><br></pre></td></tr></table></figure><blockquote><font color=red>å› ä¸ºåªæœ‰åœ¨LayoutGroupç±»ä¸­å¼•ç”¨äº†ILayoutIngnoreræ¥å£ï¼ŒLayoutGroupç±»æ˜¯åªä½œç”¨ä¸å­å¸ƒå±€å…ƒç´ çš„ï¼Œæ‰€ä»¥å®ç°äº†ILayoutIgnoreræ¥å£çš„ç»„ä»¶çš„ä½œç”¨æ˜¯é’ˆå¯¹äºå¸ƒå±€ç»„ä¸‹çš„å­å¯¹è±¡ï¼Œè€Œä¸æ˜¯è‡ªèº«ã€‚</font></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">CalculateLayoutInputHorizontal</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    m_RectChildren.Clear();</span><br><span class="line">    <span class="keyword">var</span> toIgnoreList = ListPool&lt;Component&gt;.Get();</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; rectTransform.childCount; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> rect = rectTransform.GetChild(i) <span class="keyword">as</span> RectTransform;</span><br><span class="line">        <span class="keyword">if</span> (rect == <span class="literal">null</span> || !rect.gameObject.activeInHierarchy)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        rect.GetComponents(<span class="keyword">typeof</span>(ILayoutIgnorer), toIgnoreList);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (toIgnoreList.Count == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            m_RectChildren.Add(rect);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; toIgnoreList.Count; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> ignorer = (ILayoutIgnorer)toIgnoreList[j];</span><br><span class="line">            <span class="keyword">if</span> (!ignorer.ignoreLayout)</span><br><span class="line">            &#123;</span><br><span class="line">                m_RectChildren.Add(rect);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ListPool&lt;Component&gt;.Release(toIgnoreList);</span><br><span class="line">    m_Tracker.Clear();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">æŒ‚è½½äº†å®ç°ILayoutIgnoreræ¥å£çš„ç»„ä»¶å¯¹è±¡å¯ä»¥è®¾ç½®ä¸å—å¸ƒå±€ç³»ç»Ÿæ§åˆ¶ï¼Œä¾‹å¦‚ï¼šLayoutElement</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”ILayoutSelfController</title>
    <link href="https://azzurebubble.github.io/posts/8ae908f0.html"/>
    <id>https://azzurebubble.github.io/posts/8ae908f0.html</id>
    <published>2024-07-20T07:09:15.000Z</published>
    <updated>2024-07-20T09:05:24.052Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ILayoutSelfControllerï¼šç»§æ‰¿è‡ªILayoutController(å¸ƒå±€æ§åˆ¶å™¨)ï¼ŒæŒ‚è½½äº†å®ç°ILayoutSelfControllerçš„ç»„ä»¶çš„å¯¹è±¡è¢«è§†ä¸ºä¸€ä¸ªå¸ƒå±€æ§åˆ¶å™¨ï¼Œç”¨äºæ§åˆ¶è‡ªèº«å¸ƒå±€å¯¹è±¡ï¼Œä¾‹å¦‚ï¼šContentSizeFitterã€AspectRatioFitterã€‚</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>ç»§æ‰¿è‡ªILayoutControllerï¼Œç”¨äºé©±åŠ¨è‡ªèº«çš„RectTransformï¼Œè°ƒç”¨ <code>ILayoutController.SetLayoutHorizontal</code> å¤„ç†æ°´å¹³å¸ƒå±€éƒ¨åˆ†ï¼Œè°ƒç”¨ <code>ILayoutController.SetLayoutVertical</code> å¤„ç†å‚ç›´å¸ƒå±€éƒ¨åˆ†ã€‚å¯ä»¥æ”¹å˜ RectTransform çš„é«˜åº¦ã€å®½åº¦ã€ä½ç½®å’Œæ—‹è½¬ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ILayoutSelfController</span> : <span class="title">ILayoutController</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ç»§æ‰¿è‡ªILayoutController(å¸ƒå±€æ§åˆ¶å™¨)ï¼ŒæŒ‚è½½äº†å®ç°ILayoutSelfControllerçš„ç»„ä»¶çš„å¯¹è±¡è¢«è§†ä¸ºä¸€ä¸ªå¸ƒå±€æ§åˆ¶å™¨ï¼Œç”¨äºæ§åˆ¶è‡ªèº«å¸ƒå±€å¯¹è±¡ï¼Œä¾‹å¦‚ï¼šContentSizeFitterã€AspectRatioFitterã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”ILayoutGroup</title>
    <link href="https://azzurebubble.github.io/posts/16a94385.html"/>
    <id>https://azzurebubble.github.io/posts/16a94385.html</id>
    <published>2024-07-20T07:09:05.000Z</published>
    <updated>2024-07-20T09:05:24.051Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ILayoutGroupï¼šç»§æ‰¿è‡ªILayoutControllerï¼ŒæŒ‚è½½äº†å®ç°ILayoutGroupçš„ç»„ä»¶çš„å¯¹è±¡è¢«è§†ä¸ºä¸€ä¸ªå¸ƒå±€æ§åˆ¶å™¨ï¼Œç”¨äºæ§åˆ¶å­å¸ƒå±€å¯¹è±¡ï¼Œé©±åŠ¨å®ƒçš„å­å…ƒç´ çš„RectTransformsï¼Œä¾‹å¦‚ï¼šHorizontalLayoutGroupã€VerticalLayoutGroupã€GridLayoutGroupã€‚</p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>ç»§æ‰¿è‡ªILayoutController</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ILayoutGroup</span> : <span class="title">ILayoutController</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ç»§æ‰¿è‡ªILayoutControllerï¼ŒæŒ‚è½½äº†å®ç°ILayoutGroupçš„ç»„ä»¶çš„å¯¹è±¡è¢«è§†ä¸ºä¸€ä¸ªå¸ƒå±€æ§åˆ¶å™¨ï¼Œç”¨äºæ§åˆ¶å­å¸ƒå±€å¯¹è±¡ï¼Œä¾‹å¦‚ï¼šHorizontalLayoutGroupã€VerticalLayoutGroupã€GridLayoutGroupã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>UGUIæºç è§£æâ€”â€”ILayoutController</title>
    <link href="https://azzurebubble.github.io/posts/21b56f8.html"/>
    <id>https://azzurebubble.github.io/posts/21b56f8.html</id>
    <published>2024-07-20T07:08:25.000Z</published>
    <updated>2024-07-20T09:05:24.048Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ILayoutControllerï¼šæŒ‚è½½äº†å®ç°ILayoutControllerçš„ç»„ä»¶çš„å¯¹è±¡è¢«è§†ä¸ºä¸€ä¸ªå¸ƒå±€æ§åˆ¶å™¨ï¼Œå¸ƒå±€æ§åˆ¶å™¨ç”¨äºè®¾ç½®å¸ƒå±€ã€‚å¸ƒå±€æ§åˆ¶å™¨å¯åˆ†ä¸ºä¸¤ç§ï¼šæ§åˆ¶è‡ªèº«å’Œæ§åˆ¶å­å¸ƒå±€å…ƒç´ </p></blockquote><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><blockquote><p>SetLayoutHorizontalï¼šç”±è‡ªåŠ¨å¸ƒå±€ç³»ç»Ÿè°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…ˆå¤„ç†å¸ƒå±€çš„æ°´å¹³æ–¹é¢</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SetLayoutHorizontal</span>()</span>;</span><br></pre></td></tr></table></figure><blockquote><p>SetLayoutVerticalï¼šç”±è‡ªåŠ¨å¸ƒå±€ç³»ç»Ÿè°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…ˆå¤„ç†å¸ƒå±€çš„å‚ç›´æ–¹é¢</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SetLayoutVertical</span>()</span>;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">æŒ‚è½½äº†å®ç°ILayoutControllerçš„ç»„ä»¶çš„å¯¹è±¡è¢«è§†ä¸ºä¸€ä¸ªå¸ƒå±€æ§åˆ¶å™¨ï¼Œå¸ƒå±€æ§åˆ¶å™¨ç”¨äºè®¾ç½®å¸ƒå±€ã€‚å¸ƒå±€æ§åˆ¶å™¨å¯åˆ†ä¸ºä¸¤ç§ï¼šæ§åˆ¶è‡ªèº«å’Œæ§åˆ¶å­å¸ƒå±€å…ƒç´ ã€‚</summary>
    
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/categories/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
    <category term="UGUIæºç è§£æ" scheme="https://azzurebubble.github.io/tags/UGUI%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
</feed>
